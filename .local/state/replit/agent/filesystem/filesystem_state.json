{"file_contents":{"client/src/components/achievement-gallery.tsx":{"content":"import { useState, useMemo } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport AchievementBadge from \"@/components/achievement-badge\";\nimport { Trophy, Search, Filter, Crown, Target, Zap, Star, CheckCircle, Lock } from \"lucide-react\";\nimport { cn } from \"@/lib/utils\";\nimport type { AchievementWithProgress, GamificationStats } from \"@shared/schema\";\n\ntype FilterCategory = \"all\" | \"milestone\" | \"streak\" | \"mastery\" | \"speed\" | \"test\";\ntype FilterStatus = \"all\" | \"earned\" | \"unearned\" | \"in-progress\";\ntype SortOption = \"name\" | \"points\" | \"progress\" | \"category\" | \"earnedDate\";\n\nexport default function AchievementGallery() {\n  const [filterCategory, setFilterCategory] = useState<FilterCategory>(\"all\");\n  const [filterStatus, setFilterStatus] = useState<FilterStatus>(\"all\");\n  const [sortBy, setSortBy] = useState<SortOption>(\"category\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n\n  const { data: achievements = [] } = useQuery<AchievementWithProgress[]>({\n    queryKey: [\"/api/achievements/progress\"],\n  });\n\n  const { data: gamificationStats } = useQuery<GamificationStats>({\n    queryKey: [\"/api/gamification-stats\"],\n  });\n\n  // Filter and sort achievements\n  const filteredAndSortedAchievements = useMemo(() => {\n    let filtered = achievements.filter(achievement => {\n      // Category filter\n      if (filterCategory !== \"all\" && achievement.category !== filterCategory) {\n        return false;\n      }\n\n      // Status filter  \n      if (filterStatus === \"earned\" && !achievement.isEarned) return false;\n      if (filterStatus === \"unearned\" && achievement.isEarned) return false;\n      if (filterStatus === \"in-progress\" && (achievement.isEarned || achievement.progress === 0)) return false;\n\n      // Search filter\n      if (searchQuery && !achievement.name.toLowerCase().includes(searchQuery.toLowerCase()) && \n          !achievement.description.toLowerCase().includes(searchQuery.toLowerCase())) {\n        return false;\n      }\n\n      return true;\n    });\n\n    // Sort\n    filtered.sort((a, b) => {\n      switch (sortBy) {\n        case \"name\":\n          return a.name.localeCompare(b.name);\n        case \"points\":\n          return b.points - a.points;\n        case \"progress\":\n          return b.progressPercent - a.progressPercent;\n        case \"category\":\n          return a.category.localeCompare(b.category);\n        case \"earnedDate\":\n          if (!a.earnedAt && !b.earnedAt) return 0;\n          if (!a.earnedAt) return 1;\n          if (!b.earnedAt) return -1;\n          return new Date(b.earnedAt).getTime() - new Date(a.earnedAt).getTime();\n        default:\n          return 0;\n      }\n    });\n\n    return filtered;\n  }, [achievements, filterCategory, filterStatus, sortBy, searchQuery]);\n\n  const categoryStats = useMemo(() => {\n    const stats = {\n      all: { total: 0, earned: 0 },\n      milestone: { total: 0, earned: 0 },\n      streak: { total: 0, earned: 0 },\n      mastery: { total: 0, earned: 0 },\n      speed: { total: 0, earned: 0 },\n      test: { total: 0, earned: 0 },\n    };\n\n    achievements.forEach(achievement => {\n      stats.all.total++;\n      if (achievement.isEarned) stats.all.earned++;\n\n      const category = achievement.category as keyof typeof stats;\n      if (stats[category]) {\n        stats[category].total++;\n        if (achievement.isEarned) stats[category].earned++;\n      }\n    });\n\n    return stats;\n  }, [achievements]);\n\n  const getCategoryIcon = (category: FilterCategory) => {\n    switch (category) {\n      case \"milestone\": return <Target className=\"w-4 h-4\" />;\n      case \"streak\": return <Zap className=\"w-4 h-4\" />;\n      case \"mastery\": return <Crown className=\"w-4 h-4\" />;\n      case \"speed\": return <Star className=\"w-4 h-4\" />;\n      case \"test\": return <Trophy className=\"w-4 h-4\" />;\n      default: return <CheckCircle className=\"w-4 h-4\" />;\n    }\n  };\n\n  const getCategoryColor = (category: FilterCategory) => {\n    switch (category) {\n      case \"milestone\": return \"from-blue-500 to-cyan-500\";\n      case \"streak\": return \"from-red-500 to-orange-500\";\n      case \"mastery\": return \"from-purple-500 to-pink-500\";\n      case \"speed\": return \"from-green-500 to-teal-500\";\n      case \"test\": return \"from-indigo-500 to-blue-500\";\n      default: return \"from-gray-500 to-gray-600\";\n    }\n  };\n\n  return (\n    <div className=\"p-4 space-y-6\" data-testid=\"achievement-gallery\">\n      {/* Header */}\n      <div className=\"text-center\">\n        <div className=\"flex items-center justify-center gap-2 mb-2\">\n          <Trophy className=\"w-8 h-8 text-yellow-500\" />\n          <h1 className=\"text-2xl font-bold text-gray-900 dark:text-white\">\n            Achievement Gallery\n          </h1>\n        </div>\n        <p className=\"text-gray-600 dark:text-gray-400\">\n          Unlock exciting badges as you master Jeopardy!\n        </p>\n      </div>\n\n      {/* Stats Overview */}\n      {gamificationStats && (\n        <Card className=\"p-4 bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 border-yellow-200 dark:border-yellow-800\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n                Your Progress\n              </h3>\n              <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n                {gamificationStats.achievementsEarned} of {gamificationStats.totalAchievements} achievements earned\n              </p>\n            </div>\n            <div className=\"flex items-center gap-4\">\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-yellow-600 dark:text-yellow-400\">\n                  {gamificationStats.totalPoints}\n                </div>\n                <div className=\"text-xs text-gray-500\">Points</div>\n              </div>\n              <div className=\"text-center\">\n                <div className={cn(\n                  \"text-2xl font-bold px-3 py-1 rounded-full text-white bg-gradient-to-r\",\n                  gamificationStats.currentTier === \"Platinum\" ? \"from-gray-300 to-gray-500\" :\n                  gamificationStats.currentTier === \"Gold\" ? \"from-yellow-400 to-yellow-600\" :\n                  gamificationStats.currentTier === \"Silver\" ? \"from-gray-400 to-gray-600\" :\n                  \"from-orange-400 to-orange-600\"\n                )}>\n                  {gamificationStats.currentTier}\n                </div>\n                <div className=\"text-xs text-gray-500 mt-1\">Tier</div>\n              </div>\n            </div>\n          </div>\n        </Card>\n      )}\n\n      {/* Filters and Search */}\n      <Card className=\"p-4\">\n        <div className=\"space-y-4\">\n          {/* Search */}\n          <div className=\"relative\">\n            <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4\" />\n            <Input\n              placeholder=\"Search achievements...\"\n              value={searchQuery}\n              onChange={(e) => setSearchQuery(e.target.value)}\n              className=\"pl-10\"\n              data-testid=\"achievement-search\"\n            />\n          </div>\n\n          {/* Category Filters */}\n          <div>\n            <div className=\"flex items-center gap-2 mb-3\">\n              <Filter className=\"w-4 h-4 text-gray-500\" />\n              <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Categories\n              </span>\n            </div>\n            <div className=\"flex flex-wrap gap-2\">\n              {([\"all\", \"milestone\", \"streak\", \"mastery\", \"speed\", \"test\"] as FilterCategory[]).map((category) => (\n                <Button\n                  key={category}\n                  variant={filterCategory === category ? \"default\" : \"outline\"}\n                  size=\"sm\"\n                  onClick={() => setFilterCategory(category)}\n                  className={cn(\n                    \"flex items-center gap-2\",\n                    filterCategory === category && category !== \"all\" && \n                    `bg-gradient-to-r text-white ${getCategoryColor(category)}`\n                  )}\n                  data-testid={`filter-${category}`}\n                >\n                  {getCategoryIcon(category)}\n                  <span className=\"capitalize\">{category}</span>\n                  <Badge variant=\"secondary\" className=\"text-xs\">\n                    {categoryStats[category].earned}/{categoryStats[category].total}\n                  </Badge>\n                </Button>\n              ))}\n            </div>\n          </div>\n\n          {/* Status and Sort */}\n          <div className=\"flex flex-wrap gap-4\">\n            <div className=\"flex items-center gap-2\">\n              <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Status:\n              </span>\n              {([\"all\", \"earned\", \"unearned\", \"in-progress\"] as FilterStatus[]).map((status) => (\n                <Button\n                  key={status}\n                  variant={filterStatus === status ? \"default\" : \"outline\"}\n                  size=\"sm\"\n                  onClick={() => setFilterStatus(status)}\n                  data-testid={`status-${status}`}\n                >\n                  {status === \"earned\" && <CheckCircle className=\"w-3 h-3 mr-1\" />}\n                  {status === \"unearned\" && <Lock className=\"w-3 h-3 mr-1\" />}\n                  <span className=\"capitalize\">{status.replace(\"-\", \" \")}</span>\n                </Button>\n              ))}\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Sort by:\n              </span>\n              <select\n                value={sortBy}\n                onChange={(e) => setSortBy(e.target.value as SortOption)}\n                className=\"px-3 py-1 text-sm border rounded-md bg-white dark:bg-gray-800 text-gray-900 dark:text-white\"\n                data-testid=\"sort-select\"\n              >\n                <option value=\"category\">Category</option>\n                <option value=\"name\">Name</option>\n                <option value=\"points\">Points</option>\n                <option value=\"progress\">Progress</option>\n                <option value=\"earnedDate\">Earned Date</option>\n              </select>\n            </div>\n          </div>\n        </div>\n      </Card>\n\n      {/* Achievement Grid */}\n      <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4\">\n        {filteredAndSortedAchievements.map((achievement) => (\n          <AchievementBadge\n            key={achievement.id}\n            achievement={achievement}\n            size=\"medium\"\n            showProgress={true}\n            data-testid={`badge-${achievement.key}`}\n          />\n        ))}\n      </div>\n\n      {/* Empty State */}\n      {filteredAndSortedAchievements.length === 0 && (\n        <Card className=\"p-8 text-center\">\n          <Trophy className=\"w-16 h-16 mx-auto mb-4 text-gray-300 dark:text-gray-600\" />\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white mb-2\">\n            No achievements found\n          </h3>\n          <p className=\"text-gray-600 dark:text-gray-400\">\n            {searchQuery ? \"Try a different search term\" : \"Start practicing to unlock your first achievement!\"}\n          </p>\n        </Card>\n      )}\n    </div>\n  );\n}","size_bytes":11599},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"returnNull\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","size_bytes":1388},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","size_bytes":329},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","size_bytes":791},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","size_bytes":2154},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","size_bytes":1280},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  \"inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground hover:bg-primary/80\",\n        secondary:\n          \"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80\",\n        outline: \"text-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  )\n}\n\nexport { Badge, badgeVariants }\n","size_bytes":1128},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","size_bytes":1419},"client/src/components/stats-dashboard.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card } from \"@/components/ui/card\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { CheckCircle, AlertCircle, Target, Trophy, Clock, Brain } from \"lucide-react\";\nimport StreakIndicator, { StreakCard } from \"@/components/streak-indicator\";\nimport DailyGoals from \"@/components/daily-goals\";\nimport type { CategoryStats, DailyStats, ReadinessScore, GamificationStats } from \"@shared/schema\";\n\nexport default function StatsDashboard() {\n  const { data: overallStats } = useQuery<{\n    totalQuestions: number;\n    overallAccuracy: number;\n    currentStreak: number;\n    totalStudyTime: number;\n  }>({\n    queryKey: [\"/api/stats/overall\"],\n  });\n\n  const { data: categoryStats } = useQuery<CategoryStats[]>({\n    queryKey: [\"/api/stats/categories\"],\n  });\n\n  const { data: dailyStats } = useQuery<DailyStats[]>({\n    queryKey: [\"/api/stats/daily\"],\n  });\n\n  const { data: readinessData } = useQuery<ReadinessScore>({\n    queryKey: [\"/api/readiness\"],\n  });\n\n  const { data: gamificationStats } = useQuery<GamificationStats>({\n    queryKey: [\"/api/gamification-stats\"],\n  });\n\n  return (\n    <section className=\"p-4\" data-testid=\"stats-dashboard\">\n      <h2 className=\"text-xl font-bold mb-4\">Jeopardy Anytime! Test Readiness</h2>\n      \n      {/* Overall Readiness Score */}\n      <Card className=\"p-6 mb-6 bg-gradient-to-r from-primary/10 to-accent/10 border-2\">\n        <div className=\"text-center\">\n          <div className=\"flex items-center justify-center mb-2\">\n            <Target className=\"text-primary mr-2\" size={24} />\n            <span className=\"text-lg font-semibold\">Test Readiness Score</span>\n          </div>\n          <div className=\"text-4xl font-bold text-primary mb-2\" data-testid=\"readiness-overall-score\">\n            {readinessData ? `${readinessData.overallScore.toFixed(1)}%` : \"0.0%\"}\n          </div>\n          <div className=\"text-lg font-medium mb-3\" data-testid=\"readiness-letter-grade\">\n            Grade: {readinessData?.letterGrade || \"F\"}\n          </div>\n          <div className={`px-4 py-2 rounded-full text-sm font-medium ${\n            (readinessData?.overallScore || 0) >= 80 \n              ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200' \n              : (readinessData?.overallScore || 0) >= 70\n              ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200'\n              : 'bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200'\n          }`} data-testid=\"readiness-status\">\n            {(readinessData?.overallScore || 0) >= 80 ? \"Ready for Anytime! Test\" : \n             (readinessData?.overallScore || 0) >= 70 ? \"Nearly Ready - Keep Practicing\" : \n             \"More Practice Needed\"}\n          </div>\n        </div>\n      </Card>\n\n      {/* Component Breakdown */}\n      <Card className=\"p-4 mb-6\">\n        <h3 className=\"font-bold mb-4 flex items-center\">\n          <Brain className=\"mr-2\" size={20} />\n          Readiness Component Breakdown\n        </h3>\n        <div className=\"space-y-4\">\n          {readinessData?.components.map((component, index) => {\n            const getIcon = (name: string) => {\n              if (name.toLowerCase().includes('mastery')) {\n                return <Trophy className=\"mr-2 text-purple-500\" size={16} />;\n              } else if (name.toLowerCase().includes('breadth')) {\n                return <Target className=\"mr-2 text-blue-500\" size={16} />;\n              } else if (name.toLowerCase().includes('anytime') || name.toLowerCase().includes('test')) {\n                return <Brain className=\"mr-2 text-yellow-500\" size={16} />;\n              }\n              return <Brain className=\"mr-2 text-gray-500\" size={16} />;\n            };\n\n            return (\n              <div key={index} data-testid={`component-${component.name.toLowerCase().replace(/\\s+/g, '-')}`}>\n                <div className=\"flex items-center justify-between mb-2\">\n                  <span className=\"font-medium flex items-center\">\n                    {getIcon(component.name)}\n                    {component.name} ({Math.round(component.weight * 100)}%)\n                  </span>\n                  <span className=\"text-sm font-medium\" data-testid={`score-${component.name.toLowerCase().replace(/\\s+/g, '-')}`}>\n                    {component.score.toFixed(1)}%\n                  </span>\n                </div>\n                <Progress value={component.score} className=\"h-2\" />\n                <div className=\"text-xs text-muted-foreground mt-1\">\n                  {component.description}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      </Card>\n\n      {/* Category Coverage */}\n      <Card className=\"p-4 mb-6\">\n        <h3 className=\"font-bold mb-4 flex items-center\">\n          <CheckCircle className=\"mr-2\" size={20} />\n          Category Coverage for Test Readiness\n        </h3>\n        <div className=\"text-sm text-muted-foreground mb-4\">\n          Minimum {readinessData?.categoryBreadth.requiredCategories || 12} categories needed for full breadth score. Practicing diverse categories improves your overall readiness.\n        </div>\n        <div className=\"space-y-3\">\n          {categoryStats?.map((category) => {\n            const isCovered = category.totalQuestions >= 5; // Minimum threshold for coverage\n            const isStrong = category.accuracy >= 75;\n            \n            return (\n              <div key={category.categoryId} data-testid={`category-coverage-${category.categoryId}`}>\n                <div className=\"flex items-center justify-between mb-2\">\n                  <div className=\"flex items-center\">\n                    {isCovered ? (\n                      <CheckCircle className=\"mr-2 text-green-500\" size={16} />\n                    ) : (\n                      <AlertCircle className=\"mr-2 text-red-500\" size={16} />\n                    )}\n                    <span className=\"font-medium\" data-testid={`text-category-${category.categoryId}`}>\n                      {category.categoryName}\n                    </span>\n                  </div>\n                  <div className=\"flex items-center space-x-2\">\n                    <span className={`text-sm font-medium ${\n                      isStrong ? 'text-green-600' : category.accuracy >= 60 ? 'text-yellow-600' : 'text-red-600'\n                    }`} data-testid={`text-accuracy-${category.categoryId}`}>\n                      {Math.round(category.accuracy)}%\n                    </span>\n                    <span className=\"text-xs text-muted-foreground\">\n                      ({category.totalQuestions})\n                    </span>\n                  </div>\n                </div>\n                <Progress \n                  value={category.accuracy} \n                  className=\"h-1.5\"\n                />\n                <div className=\"text-xs text-muted-foreground mt-1\" data-testid={`text-status-${category.categoryId}`}>\n                  {!isCovered ? \"‚ö†Ô∏è Needs more practice (5+ questions required)\" :\n                   isStrong ? \"‚úÖ Strong performance\" :\n                   category.accuracy >= 60 ? \"‚è≥ Room for improvement\" :\n                   \"‚ùå Requires focused study\"}\n                </div>\n              </div>\n            );\n          })}\n        </div>\n        \n        {/* Coverage Summary */}\n        <div className=\"mt-4 p-3 bg-muted/50 rounded-lg\">\n          <div className=\"text-sm font-medium mb-1\">Coverage Summary</div>\n          <div className=\"text-xs text-muted-foreground\">\n            Categories covered: {categoryStats?.filter(c => c.totalQuestions >= 5).length || 0} / {categoryStats?.length || 0}\n            {(categoryStats?.filter(c => c.totalQuestions >= 5).length || 0) < 6 && (\n              <span className=\"text-yellow-600 ml-2\">\n                ‚ö†Ô∏è Need {6 - (categoryStats?.filter(c => c.totalQuestions >= 5).length || 0)} more for full readiness\n              </span>\n            )}\n          </div>\n        </div>\n      </Card>\n\n      {/* Test Readiness Recommendations */}\n      <Card className=\"p-4 mb-6\">\n        <h3 className=\"font-bold mb-4 flex items-center\">\n          <AlertCircle className=\"mr-2\" size={20} />\n          Readiness Recommendations\n        </h3>\n        <div className=\"space-y-3\">\n          {/* Dynamic recommendations based on readiness score */}\n          {readinessData && (readinessData.overallScore || 0) < 80 && (\n            <div className=\"space-y-2\">\n              {/* Check for low Anytime Test component */}\n              {readinessData?.components.find(c => c.name.toLowerCase().includes('anytime') || c.name.toLowerCase().includes('test'))?.score < 60 && (\n                <div className=\"flex items-start space-x-2 p-3 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg\">\n                  <Trophy className=\"text-yellow-500 mt-0.5\" size={16} />\n                  <div>\n                    <div className=\"text-sm font-medium\">Practice Anytime! Test Mode</div>\n                    <div className=\"text-xs text-muted-foreground\">\n                      Take more 50-question, 15-second practice tests to improve speed and accuracy\n                    </div>\n                  </div>\n                </div>\n              )}\n              \n              {/* Category coverage check */}\n              {(readinessData?.categoryBreadth.coveredCategories || 0) < (readinessData?.categoryBreadth.requiredCategories || 6) && (\n                <div className=\"flex items-start space-x-2 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg\">\n                  <CheckCircle className=\"text-red-500 mt-0.5\" size={16} />\n                  <div>\n                    <div className=\"text-sm font-medium\">Expand Category Coverage</div>\n                    <div className=\"text-xs text-muted-foreground\">\n                      Practice in {(readinessData?.categoryBreadth.requiredCategories || 6) - (readinessData?.categoryBreadth.coveredCategories || 0)} more categories for full readiness\n                    </div>\n                  </div>\n                </div>\n              )}\n              \n              {/* Check for low Category Mastery component */}\n              {readinessData && readinessData.components.find(c => c.name.toLowerCase().includes('mastery'))?.score < 50 && (\n                <div className=\"flex items-start space-x-2 p-3 bg-purple-50 dark:bg-purple-900/20 rounded-lg\">\n                  <Trophy className=\"text-purple-500 mt-0.5\" size={16} />\n                  <div>\n                    <div className=\"text-sm font-medium\">Improve Category Mastery</div>\n                    <div className=\"text-xs text-muted-foreground\">\n                      Answer more questions correctly in each category to build long-term mastery\n                    </div>\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n          \n          {(readinessData?.overallScore || 0) >= 80 && (\n            <div className=\"flex items-start space-x-2 p-3 bg-green-50 dark:bg-green-900/20 rounded-lg\">\n              <CheckCircle className=\"text-green-500 mt-0.5\" size={16} />\n              <div>\n                <div className=\"text-sm font-medium\">Ready for Anytime! Test</div>\n                <div className=\"text-xs text-muted-foreground\">\n                  You're well-prepared! Consider taking the official test or maintaining practice to stay sharp.\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </Card>\n\n      {/* Streak Overview */}\n      {gamificationStats && (\n        <StreakCard\n          dailyStreak={gamificationStats.streakInfo.dailyStreak}\n          weeklyStreak={gamificationStats.streakInfo.weeklyStreak}\n          monthlyStreak={gamificationStats.streakInfo.monthlyStreak}\n          longestStreak={gamificationStats.streakInfo.longestDailyStreak}\n          goalProgress={gamificationStats.streakInfo.goalProgress}\n          questionsToday={gamificationStats.streakInfo.questionsToday}\n          todayComplete={gamificationStats.streakInfo.todayComplete}\n        />\n      )}\n\n      {/* Daily Goals */}\n      <DailyGoals />\n\n      {/* Performance Summary */}\n      <Card className=\"p-4\">\n        <h3 className=\"font-bold mb-4 flex items-center\">\n          <Clock className=\"mr-2\" size={20} />\n          Performance Summary\n        </h3>\n        <div className=\"grid grid-cols-2 gap-4\">\n          <div className=\"text-center\">\n            <div className=\"text-2xl font-bold text-primary\" data-testid=\"stat-total-questions\">\n              {overallStats?.totalQuestions || 0}\n            </div>\n            <div className=\"text-sm text-muted-foreground\">Total Questions</div>\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-2xl font-bold text-accent\" data-testid=\"stat-overall-accuracy\">\n              {Math.round(overallStats?.overallAccuracy || 0)}%\n            </div>\n            <div className=\"text-sm text-muted-foreground\">Overall Accuracy</div>\n          </div>\n          <div className=\"flex justify-center\" data-testid=\"stat-current-streak\">\n            <StreakIndicator\n              streakValue={overallStats?.currentStreak || 0}\n              streakType=\"daily\"\n              goalProgress={gamificationStats?.streakInfo.goalProgress || 0}\n              size=\"large\"\n              animated={true}\n              showProgress={true}\n              showLabel={true}\n            />\n          </div>\n          <div className=\"text-center\">\n            <div className=\"text-2xl font-bold text-primary\" data-testid=\"stat-study-time\">\n              {overallStats?.totalStudyTime || 0}h\n            </div>\n            <div className=\"text-sm text-muted-foreground\">Study Time</div>\n          </div>\n        </div>\n      </Card>\n    </section>\n  );\n}\n","size_bytes":13798},"client/src/components/rapid-fire-mode.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Clock, ChevronLeft, RotateCcw } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { QuestionWithCategory } from \"@shared/schema\";\n\ninterface RapidFireModeProps {\n  settings?: { selectedCategories: string[]; questionCount: number };\n  onBack: () => void;\n  isAnytimeTest?: boolean;\n}\n\nexport default function RapidFireMode({ settings, onBack, isAnytimeTest = false }: RapidFireModeProps) {\n  const [hasStarted, setHasStarted] = useState(!isAnytimeTest); // Anytime Test requires explicit start\n  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);\n  const [showAnswer, setShowAnswer] = useState(false);\n  const [sessionStats, setSessionStats] = useState({\n    correct: 0,\n    incorrect: 0,\n    unsure: 0,\n  });\n  const [timeRemaining, setTimeRemaining] = useState(15); // 15 seconds for Anytime! Test\n  const [questionStartTime, setQuestionStartTime] = useState<Date | null>(null);\n  const [testAttemptId, setTestAttemptId] = useState<string | null>(null);\n\n  const restartSession = () => {\n    setCurrentQuestionIndex(0);\n    setShowAnswer(false);\n    setSessionStats({ correct: 0, incorrect: 0, unsure: 0 });\n    setTimeRemaining(15);\n    setQuestionStartTime(null);\n    setTestAttemptId(null);\n    if (isAnytimeTest) {\n      setHasStarted(false);\n    }\n    const queryKey = isAnytimeTest ? [\"/api/anytime-test-questions\"] : [\"/api/questions/rapid-fire\", settings];\n    queryClient.invalidateQueries({ queryKey });\n  };\n\n  const { data: questions, isLoading } = useQuery<QuestionWithCategory[]>({\n    queryKey: isAnytimeTest ? [\"/api/anytime-test-questions\"] : [\"/api/questions/rapid-fire\", settings],\n    queryFn: async () => {\n      if (isAnytimeTest) {\n        const response = await fetch('/api/anytime-test-questions');\n        if (!response.ok) throw new Error('Failed to fetch anytime test questions');\n        return response.json();\n      } else {\n        const params = new URLSearchParams();\n        if (settings?.questionCount) {\n          params.append('limit', settings.questionCount.toString());\n        }\n        if (settings?.selectedCategories && settings.selectedCategories.length > 0) {\n          params.append('categories', settings.selectedCategories.join(','));\n        }\n        \n        const response = await fetch(`/api/questions/rapid-fire?${params}`);\n        if (!response.ok) throw new Error('Failed to fetch questions');\n        return response.json();\n      }\n    },\n    enabled: hasStarted, // Only fetch when test has been started\n  });\n\n  // Countdown timer effect\n  useEffect(() => {\n    if (!isAnytimeTest || showAnswer || !questionStartTime) return;\n\n    const timer = setInterval(() => {\n      setTimeRemaining(prev => {\n        if (prev <= 1) {\n          // Time expired - auto-advance with \"unsure\" assessment\n          handleSelfAssessment(\"unsure\", true);\n          return 15;\n        }\n        return prev - 1;\n      });\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, [isAnytimeTest, showAnswer, questionStartTime, currentQuestionIndex]);\n\n  // Start timer when question loads\n  useEffect(() => {\n    if (isAnytimeTest && questions && currentQuestionIndex < questions.length) {\n      setTimeRemaining(15);\n      setQuestionStartTime(new Date());\n    }\n  }, [isAnytimeTest, questions, currentQuestionIndex]);\n\n  const submitAnswerMutation = useMutation({\n    mutationFn: async (data: {\n      questionId: string;\n      correct: boolean;\n      userAnswer: string;\n      timeSpent: number;\n      selfAssessment: \"correct\" | \"incorrect\" | \"unsure\";\n      mode?: \"game\" | \"rapid_fire\" | \"anytime_test\";\n      sessionId?: string;\n    }) => {\n      return apiRequest(\"POST\", \"/api/progress\", data);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/stats\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/answered-questions\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/readiness\"] });\n    },\n  });\n\n  const currentQuestion = questions?.[currentQuestionIndex];\n  const totalQuestions = questions?.length || 0;\n  const displayTotal = isAnytimeTest ? 50 : totalQuestions;\n  const progress = displayTotal > 0 ? ((currentQuestionIndex + 1) / displayTotal) * 100 : 0;\n\n  const handleSelfAssessment = async (assessment: \"correct\" | \"incorrect\" | \"unsure\", isAutoAdvance = false) => {\n    if (!currentQuestion) return;\n\n    // Calculate time spent\n    const timeSpent = questionStartTime \n      ? Math.round((new Date().getTime() - questionStartTime.getTime()) / 1000)\n      : (isAnytimeTest ? 15 : 30);\n\n    // Update session stats\n    setSessionStats(prev => ({\n      ...prev,\n      [assessment]: prev[assessment] + 1,\n    }));\n\n    // Submit to backend\n    await submitAnswerMutation.mutateAsync({\n      questionId: currentQuestion.id,\n      correct: assessment === \"correct\",\n      userAnswer: \"\",\n      timeSpent,\n      selfAssessment: assessment,\n      mode: isAnytimeTest ? \"anytime_test\" : \"rapid_fire\",\n      sessionId: testAttemptId || undefined,\n    });\n\n    // Move to next question or finish\n    if (currentQuestionIndex < totalQuestions - 1) {\n      setCurrentQuestionIndex(prev => prev + 1);\n      setShowAnswer(false);\n      if (isAnytimeTest) {\n        setTimeRemaining(15);\n        setQuestionStartTime(new Date());\n      }\n    } else {\n      // Session complete - increment to trigger completion UI\n      setCurrentQuestionIndex(prev => prev + 1);\n    }\n  };\n\n  // Show start screen for Anytime Test BEFORE loading or checking questions\n  if (isAnytimeTest && !hasStarted) {\n    return (\n      <div className=\"p-4 flex items-center justify-center min-h-[600px]\">\n        <Card className=\"max-w-2xl w-full p-8\">\n          <div className=\"text-center space-y-6\">\n            <div>\n              <h1 className=\"text-3xl font-bold mb-2\" data-testid=\"heading-anytime-test\">Jeopardy! Anytime Test</h1>\n              <p className=\"text-muted-foreground\">Test your trivia knowledge with a realistic 50-question challenge</p>\n            </div>\n\n            <Separator />\n\n            <div className=\"text-left space-y-4\">\n              <div>\n                <h3 className=\"font-semibold mb-2\">Test Format:</h3>\n                <ul className=\"list-disc list-inside space-y-1 text-muted-foreground\">\n                  <li>50 questions total</li>\n                  <li>15 seconds per question</li>\n                  <li>Questions from all categories and difficulty levels</li>\n                  <li>Self-assessment after each answer</li>\n                </ul>\n              </div>\n\n              <div>\n                <h3 className=\"font-semibold mb-2\">Instructions:</h3>\n                <ul className=\"list-disc list-inside space-y-1 text-muted-foreground\">\n                  <li>Read each question carefully</li>\n                  <li>Think of your answer before revealing</li>\n                  <li>Click \"Reveal Answer\" to see the correct response</li>\n                  <li>Honestly assess whether you got it right</li>\n                  <li>If time expires, the question will automatically advance</li>\n                </ul>\n              </div>\n            </div>\n\n            <Separator />\n\n            <div className=\"flex gap-3\">\n              <Button \n                onClick={() => setHasStarted(true)} \n                className=\"flex-1 text-lg py-6\"\n                data-testid=\"button-start-test\"\n              >\n                Start Test\n              </Button>\n              <Button \n                onClick={onBack} \n                variant=\"outline\" \n                className=\"flex-1 text-lg py-6\"\n                data-testid=\"button-back-to-board\"\n              >\n                Back to Board\n              </Button>\n            </div>\n          </div>\n        </Card>\n      </div>\n    );\n  }\n\n  // After start screen, check loading and questions\n  if (isLoading) {\n    return (\n      <div className=\"p-4 flex items-center justify-center min-h-[400px]\">\n        <div className=\"text-center\">Loading questions...</div>\n      </div>\n    );\n  }\n\n  if (!questions || questions.length === 0) {\n    return (\n      <div className=\"p-4 flex items-center justify-center min-h-[400px]\">\n        <div className=\"text-center\">\n          <p className=\"mb-4\">No questions available for {isAnytimeTest ? \"anytime test\" : \"rapid-fire mode\"}.</p>\n          <Button onClick={onBack}>Back to Game Board</Button>\n        </div>\n      </div>\n    );\n  }\n\n  // Check if session is complete\n  if (currentQuestionIndex >= totalQuestions) {\n    const accuracy = totalQuestions > 0 ? (sessionStats.correct / totalQuestions) * 100 : 0;\n    \n    return (\n      <div className=\"p-4 flex items-center justify-center min-h-[400px]\">\n        <div className=\"text-center max-w-md\">\n          <h2 className=\"text-2xl font-bold mb-4\">Session Complete! üéâ</h2>\n          <div className=\"mb-6\">\n            <p className=\"text-lg mb-2\">Final Score:</p>\n            <div className=\"text-3xl font-bold mb-4\">\n              {accuracy.toFixed(0)}% Accuracy\n            </div>\n            <div className=\"grid grid-cols-3 gap-4 mb-6\">\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-green-600\">{sessionStats.correct}</div>\n                <div className=\"text-sm text-muted-foreground\">Correct</div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-red-600\">{sessionStats.incorrect}</div>\n                <div className=\"text-sm text-muted-foreground\">Incorrect</div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-orange-500\">{sessionStats.unsure}</div>\n                <div className=\"text-sm text-muted-foreground\">Unsure</div>\n              </div>\n            </div>\n          </div>\n          <div className=\"flex gap-3\">\n            <Button onClick={restartSession} className=\"flex-1\" data-testid=\"button-restart-session\">\n              <RotateCcw className=\"mr-2\" size={16} />\n              Play Again\n            </Button>\n            <Button onClick={onBack} variant=\"outline\" className=\"flex-1\">\n              Back to Board\n            </Button>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <section className=\"p-4\" data-testid=\"rapid-fire-mode\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-4\">\n        <Button\n          variant=\"ghost\"\n          onClick={onBack}\n          className=\"flex items-center\"\n          data-testid=\"button-back\"\n        >\n          <ChevronLeft className=\"mr-1\" size={20} />\n          Back\n        </Button>\n        <div className=\"text-right\">\n          <div className=\"text-sm text-muted-foreground\">\n            {isAnytimeTest ? \"Anytime! Test\" : \"Rapid Fire Mode\"}\n          </div>\n          <div className=\"font-bold\" data-testid=\"text-question-counter\">\n            Question {currentQuestionIndex + 1} of {displayTotal}\n          </div>\n          {isAnytimeTest && !showAnswer && (\n            <div className=\"flex items-center justify-end mt-1\">\n              <Clock className=\"w-4 h-4 mr-1\" />\n              <span className={`font-bold ${timeRemaining <= 5 ? 'text-red-500' : 'text-primary'}`} data-testid=\"timer-countdown\">\n                {timeRemaining}s\n              </span>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Progress */}\n      <div className=\"mb-6\">\n        <div className=\"w-full bg-muted rounded-full h-2\">\n          <div \n            className=\"bg-primary h-2 rounded-full transition-all duration-500\" \n            style={{ width: `${progress}%` }}\n            data-testid=\"progress-bar\"\n          />\n        </div>\n      </div>\n\n      {/* Session Stats */}\n      <div className={`grid ${isAnytimeTest ? 'grid-cols-2' : 'grid-cols-3'} gap-4 mb-6`}>\n        <Card className=\"p-3 text-center\">\n          <div className=\"text-lg font-bold text-accent\" data-testid=\"stat-correct\">\n            {sessionStats.correct}\n          </div>\n          <div className=\"text-xs text-muted-foreground\">Correct</div>\n        </Card>\n        <Card className=\"p-3 text-center\">\n          <div className=\"text-lg font-bold text-destructive\" data-testid=\"stat-incorrect\">\n            {sessionStats.incorrect}\n          </div>\n          <div className=\"text-xs text-muted-foreground\">Incorrect</div>\n        </Card>\n        {!isAnytimeTest && (\n          <Card className=\"p-3 text-center\">\n            <div className=\"text-lg font-bold text-secondary\" data-testid=\"stat-unsure\">\n              {sessionStats.unsure}\n            </div>\n            <div className=\"text-xs text-muted-foreground\">Unsure</div>\n          </Card>\n        )}\n      </div>\n\n      {/* Question Card */}\n      <Card className=\"question-card p-6 mb-6\">\n        <div className=\"text-center\">\n          <div className=\"text-sm text-primary-foreground/80 mb-2\" data-testid=\"text-category\">\n            {currentQuestion?.category.name} ‚Ä¢ ${currentQuestion?.value}\n            {currentQuestion?.airDate && (\n              <span className=\"block text-xs opacity-75 mt-1\">\n                Aired: {new Date(currentQuestion.airDate).toLocaleDateString()}\n              </span>\n            )}\n          </div>\n          <p className=\"text-lg leading-relaxed mb-4 text-primary-foreground\" data-testid=\"text-question\">\n            {currentQuestion?.text}\n          </p>\n          \n          {!showAnswer ? (\n            <Button\n              onClick={() => setShowAnswer(true)}\n              className=\"bg-primary text-primary-foreground hover:bg-primary/90\"\n              data-testid=\"button-reveal-answer\"\n            >\n              Reveal Answer\n            </Button>\n          ) : (\n            <div className=\"space-y-4\">\n              <div className=\"p-4 bg-primary-foreground/20 rounded-lg\">\n                <p className=\"text-lg font-medium text-primary-foreground\" data-testid=\"text-answer\">\n                  {currentQuestion?.answer}\n                </p>\n              </div>\n              \n              <div className=\"space-y-2\">\n                <p className=\"text-sm text-muted-foreground\">How did you do?</p>\n                <div className={`grid ${isAnytimeTest ? 'grid-cols-2' : 'grid-cols-3'} gap-3`}>\n                  <Button\n                    onClick={() => handleSelfAssessment(\"correct\")}\n                    className=\"bg-accent text-accent-foreground hover:bg-accent/90\"\n                    data-testid=\"button-self-correct\"\n                  >\n                    ‚úì Correct\n                  </Button>\n                  <Button\n                    onClick={() => handleSelfAssessment(\"incorrect\")}\n                    className=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n                    data-testid=\"button-self-incorrect\"\n                  >\n                    ‚úó Incorrect\n                  </Button>\n                  {!isAnytimeTest && (\n                    <Button\n                      onClick={() => handleSelfAssessment(\"unsure\")}\n                      variant=\"secondary\"\n                      data-testid=\"button-self-unsure\"\n                    >\n                      ? Unsure\n                    </Button>\n                  )}\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </Card>\n    </section>\n  );\n}","size_bytes":15643},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \"var(--radius)\",\n        md: \"calc(var(--radius) - 2px)\",\n        sm: \"calc(var(--radius) - 4px)\",\n      },\n      colors: {\n        background: \"var(--background)\",\n        foreground: \"var(--foreground)\",\n        card: {\n          DEFAULT: \"var(--card)\",\n          foreground: \"var(--card-foreground)\",\n        },\n        popover: {\n          DEFAULT: \"var(--popover)\",\n          foreground: \"var(--popover-foreground)\",\n        },\n        primary: {\n          DEFAULT: \"var(--primary)\",\n          foreground: \"var(--primary-foreground)\",\n        },\n        secondary: {\n          DEFAULT: \"var(--secondary)\",\n          foreground: \"var(--secondary-foreground)\",\n        },\n        muted: {\n          DEFAULT: \"var(--muted)\",\n          foreground: \"var(--muted-foreground)\",\n        },\n        accent: {\n          DEFAULT: \"var(--accent)\",\n          foreground: \"var(--accent-foreground)\",\n        },\n        destructive: {\n          DEFAULT: \"var(--destructive)\",\n          foreground: \"var(--destructive-foreground)\",\n        },\n        border: \"var(--border)\",\n        input: \"var(--input)\",\n        ring: \"var(--ring)\",\n        chart: {\n          \"1\": \"var(--chart-1)\",\n          \"2\": \"var(--chart-2)\",\n          \"3\": \"var(--chart-3)\",\n          \"4\": \"var(--chart-4)\",\n          \"5\": \"var(--chart-5)\",\n        },\n        sidebar: {\n          DEFAULT: \"var(--sidebar)\",\n          foreground: \"var(--sidebar-foreground)\",\n          primary: \"var(--sidebar-primary)\",\n          \"primary-foreground\": \"var(--sidebar-primary-foreground)\",\n          accent: \"var(--sidebar-accent)\",\n          \"accent-foreground\": \"var(--sidebar-accent-foreground)\",\n          border: \"var(--sidebar-border)\",\n          ring: \"var(--sidebar-ring)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: {\n            height: \"0\",\n          },\n          to: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n        },\n        \"accordion-up\": {\n          from: {\n            height: \"var(--radix-accordion-content-height)\",\n          },\n          to: {\n            height: \"0\",\n          },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","size_bytes":2755},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","size_bytes":1901},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","size_bytes":7428},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","size_bytes":2751},"server/replitAuth.ts":{"content":"import * as client from \"openid-client\";\nimport { Strategy, type VerifyFunction } from \"openid-client/passport\";\n\nimport passport from \"passport\";\nimport session from \"express-session\";\nimport type { Express, RequestHandler } from \"express\";\nimport memoize from \"memoizee\";\nimport connectPg from \"connect-pg-simple\";\nimport { storage } from \"./storage\";\n\nif (!process.env.REPLIT_DOMAINS) {\n  throw new Error(\"Environment variable REPLIT_DOMAINS not provided\");\n}\n\nconst getOidcConfig = memoize(\n  async () => {\n    return await client.discovery(\n      new URL(process.env.ISSUER_URL ?? \"https://replit.com/oidc\"),\n      process.env.REPL_ID!\n    );\n  },\n  { maxAge: 3600 * 1000 }\n);\n\nexport function getSession() {\n  const sessionTtl = 7 * 24 * 60 * 60 * 1000; // 1 week\n  const pgStore = connectPg(session);\n  const sessionStore = new pgStore({\n    conString: process.env.DATABASE_URL,\n    createTableIfMissing: true, // Auto-create sessions table if missing\n    ttl: sessionTtl,\n    tableName: \"sessions\",\n  });\n  return session({\n    secret: process.env.SESSION_SECRET!,\n    store: sessionStore,\n    resave: false,\n    saveUninitialized: false,\n    cookie: {\n      httpOnly: true,\n      secure: true,\n      maxAge: sessionTtl,\n    },\n  });\n}\n\nfunction updateUserSession(\n  user: any,\n  tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers\n) {\n  user.claims = tokens.claims();\n  user.access_token = tokens.access_token;\n  user.refresh_token = tokens.refresh_token;\n  user.expires_at = user.claims?.exp;\n}\n\nasync function upsertUser(\n  claims: any,\n) {\n  await storage.upsertUser({\n    id: claims[\"sub\"],\n    email: claims[\"email\"],\n    firstName: claims[\"first_name\"],\n    lastName: claims[\"last_name\"],\n    profileImageUrl: claims[\"profile_image_url\"],\n  });\n}\n\nexport async function setupAuth(app: Express) {\n  app.set(\"trust proxy\", 1);\n  app.use(getSession());\n  app.use(passport.initialize());\n  app.use(passport.session());\n\n  const config = await getOidcConfig();\n\n  const verify: VerifyFunction = async (\n    tokens: client.TokenEndpointResponse & client.TokenEndpointResponseHelpers,\n    verified: passport.AuthenticateCallback\n  ) => {\n    const user = {};\n    updateUserSession(user, tokens);\n    await upsertUser(tokens.claims());\n    verified(null, user);\n  };\n\n  // Keep track of registered strategies\n  const registeredStrategies = new Set<string>();\n\n  // Helper function to ensure strategy exists for a domain\n  const ensureStrategy = (domain: string) => {\n    const strategyName = `replitauth:${domain}`;\n    if (!registeredStrategies.has(strategyName)) {\n      const strategy = new Strategy(\n        {\n          name: strategyName,\n          config,\n          scope: \"openid email profile offline_access\",\n          callbackURL: `https://${domain}/api/callback`,\n        },\n        verify,\n      );\n      passport.use(strategy);\n      registeredStrategies.add(strategyName);\n    }\n  };\n\n  passport.serializeUser((user: Express.User, cb) => cb(null, user));\n  passport.deserializeUser((user: Express.User, cb) => cb(null, user));\n\n  app.get(\"/api/login\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      prompt: \"login consent\",\n      scope: [\"openid\", \"email\", \"profile\", \"offline_access\"],\n    })(req, res, next);\n  });\n\n  app.get(\"/api/callback\", (req, res, next) => {\n    ensureStrategy(req.hostname);\n    passport.authenticate(`replitauth:${req.hostname}`, {\n      successReturnToOrRedirect: \"/\",\n      failureRedirect: \"/api/login\",\n    })(req, res, next);\n  });\n\n  app.get(\"/api/logout\", (req, res) => {\n    req.logout(() => {\n      res.redirect(\n        client.buildEndSessionUrl(config, {\n          client_id: process.env.REPL_ID!,\n          post_logout_redirect_uri: `${req.protocol}://${req.hostname}`,\n        }).href\n      );\n    });\n  });\n}\n\nexport const isAuthenticated: RequestHandler = async (req, res, next) => {\n  const user = req.user as any;\n\n  if (!req.isAuthenticated() || !user.expires_at) {\n    return res.status(401).json({ message: \"Unauthorized\" });\n  }\n\n  const now = Math.floor(Date.now() / 1000);\n  if (now <= user.expires_at) {\n    return next();\n  }\n\n  const refreshToken = user.refresh_token;\n  if (!refreshToken) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n\n  try {\n    const config = await getOidcConfig();\n    const tokenResponse = await client.refreshTokenGrant(config, refreshToken);\n    updateUserSession(user, tokenResponse);\n    return next();\n  } catch (error) {\n    res.status(401).json({ message: \"Unauthorized\" });\n    return;\n  }\n};\n\nexport const optionalAuth: RequestHandler = async (req, res, next) => {\n  const user = req.user as any;\n\n  if (!req.isAuthenticated() || !user || !user.expires_at) {\n    return next();\n  }\n\n  const now = Math.floor(Date.now() / 1000);\n  if (now <= user.expires_at) {\n    return next();\n  }\n\n  const refreshToken = user.refresh_token;\n  if (!refreshToken) {\n    return next();\n  }\n\n  try {\n    const config = await getOidcConfig();\n    const tokenResponse = await client.refreshTokenGrant(config, refreshToken);\n    updateUserSession(user, tokenResponse);\n    return next();\n  } catch (error) {\n    return next();\n  }\n};","size_bytes":5241},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","size_bytes":772},"client/src/components/daily-goals.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Target, TrendingUp, Calendar, CheckCircle, Edit2, Save, X, Flame } from \"lucide-react\";\nimport { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { cn } from \"@/lib/utils\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport type { UserGoals, GamificationStats } from \"@shared/schema\";\n\nexport default function DailyGoals() {\n  const [isEditingDaily, setIsEditingDaily] = useState(false);\n  const [isEditingStreak, setIsEditingStreak] = useState(false);\n  const [dailyTarget, setDailyTarget] = useState(\"\");\n  const [streakTarget, setStreakTarget] = useState(\"\");\n  const { toast } = useToast();\n\n  const { data: userGoals } = useQuery<UserGoals>({\n    queryKey: [\"/api/user-goals\"],\n    refetchInterval: 60000, // Reduced from 30s to 60s for cost optimization\n  });\n\n  const { data: gamificationStats } = useQuery<GamificationStats>({\n    queryKey: [\"/api/gamification-stats\"],\n    // No separate refetch - will be updated by celebration system\n  });\n\n  const updateGoalsMutation = useMutation({\n    mutationFn: (goalData: Partial<UserGoals>) =>\n      apiRequest(\"PATCH\", \"/api/user-goals\", goalData),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/user-goals\"] });\n      setIsEditingDaily(false);\n      setIsEditingStreak(false);\n      toast({\n        title: \"Goals Updated! üéØ\",\n        description: \"Your daily targets have been successfully updated.\",\n      });\n    },\n    onError: () => {\n      toast({\n        title: \"Error\",\n        description: \"Failed to update goals. Please try again.\",\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  // Generate smart suggestions based on current performance\n  const generateSuggestions = () => {\n    if (!gamificationStats || !userGoals) return null;\n\n    const { streakInfo } = gamificationStats;\n    const currentDaily = streakInfo.questionsToday;\n    const currentStreak = streakInfo.dailyStreak;\n    const currentGoal = userGoals.dailyQuestionGoal;\n\n    const suggestions = [];\n\n    // Daily questions suggestion\n    if (currentDaily >= currentGoal && currentGoal < 20) {\n      suggestions.push({\n        type: \"increase_daily\",\n        message: `You're crushing your ${currentGoal} question goal! Consider increasing to ${Math.min(currentGoal + 3, 20)} questions.`,\n        newValue: Math.min(currentGoal + 3, 20),\n        color: \"from-green-500 to-teal-500\"\n      });\n    } else if (currentDaily < currentGoal * 0.7 && currentGoal > 5) {\n      suggestions.push({\n        type: \"decrease_daily\",\n        message: `Struggling with ${currentGoal} questions? Try ${Math.max(currentGoal - 2, 5)} for more consistent success.`,\n        newValue: Math.max(currentGoal - 2, 5),\n        color: \"from-blue-500 to-cyan-500\"\n      });\n    }\n\n    // Streak suggestion\n    if (currentStreak >= userGoals.weeklyStreakGoal && userGoals.weeklyStreakGoal < 14) {\n      suggestions.push({\n        type: \"increase_streak\",\n        message: `Amazing ${currentStreak}-day streak! Challenge yourself with a ${userGoals.weeklyStreakGoal + 3}-day target.`,\n        newValue: userGoals.weeklyStreakGoal + 3,\n        color: \"from-red-500 to-orange-500\"\n      });\n    }\n\n    return suggestions;\n  };\n\n  const suggestions = generateSuggestions();\n\n  const getDailyProgress = () => {\n    if (!gamificationStats || !userGoals) return { current: 0, percentage: 0 };\n    \n    const current = gamificationStats.streakInfo.questionsToday;\n    const target = userGoals.dailyQuestionGoal;\n    \n    return {\n      current,\n      target,\n      percentage: Math.min((current / target) * 100, 100),\n      isComplete: current >= target\n    };\n  };\n\n  const getStreakProgress = () => {\n    if (!gamificationStats || !userGoals) return { current: 0, percentage: 0 };\n    \n    const current = gamificationStats.streakInfo.dailyStreak;\n    const target = userGoals.weeklyStreakGoal;\n    \n    return {\n      current,\n      target,\n      percentage: Math.min((current / target) * 100, 100),\n      isComplete: current >= target\n    };\n  };\n\n  const dailyProgress = getDailyProgress();\n  const streakProgress = getStreakProgress();\n\n  const handleUpdateDaily = () => {\n    const value = parseInt(dailyTarget);\n    if (isNaN(value) || value < 1 || value > 50) {\n      toast({\n        title: \"Invalid Goal\",\n        description: \"Please enter a value between 1 and 50.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    updateGoalsMutation.mutate({ dailyQuestionGoal: value });\n  };\n\n  const handleUpdateStreak = () => {\n    const value = parseInt(streakTarget);\n    if (isNaN(value) || value < 1 || value > 365) {\n      toast({\n        title: \"Invalid Goal\",\n        description: \"Please enter a value between 1 and 365.\",\n        variant: \"destructive\",\n      });\n      return;\n    }\n    updateGoalsMutation.mutate({ weeklyStreakGoal: value });\n  };\n\n  const applySuggestion = (suggestion: any) => {\n    if (suggestion.type.includes(\"daily\")) {\n      updateGoalsMutation.mutate({ dailyQuestionGoal: suggestion.newValue });\n    } else if (suggestion.type.includes(\"streak\")) {\n      updateGoalsMutation.mutate({ weeklyStreakGoal: suggestion.newValue });\n    }\n  };\n\n  if (!userGoals || !gamificationStats) {\n    return (\n      <Card className=\"p-6\">\n        <div className=\"animate-pulse\">\n          <div className=\"h-4 bg-gray-200 rounded w-1/4 mb-4\"></div>\n          <div className=\"space-y-3\">\n            <div className=\"h-16 bg-gray-200 rounded\"></div>\n            <div className=\"h-16 bg-gray-200 rounded\"></div>\n          </div>\n        </div>\n      </Card>\n    );\n  }\n\n  return (\n    <div className=\"space-y-6\" data-testid=\"daily-goals\">\n      {/* Header */}\n      <div className=\"text-center\">\n        <div className=\"flex items-center justify-center gap-2 mb-2\">\n          <Target className=\"w-6 h-6 text-blue-500\" />\n          <h2 className=\"text-xl font-bold text-gray-900 dark:text-white\">\n            Daily Goals\n          </h2>\n        </div>\n        <p className=\"text-sm text-gray-600 dark:text-gray-400\">\n          Track your daily practice and streak targets\n        </p>\n      </div>\n\n      {/* Current Goals */}\n      <div className=\"grid gap-4\">\n        {/* Daily Questions Goal */}\n        <Card className={cn(\n          \"p-4 transition-all\",\n          dailyProgress.isComplete \n            ? \"bg-green-50 border-green-200 dark:bg-green-900/20 dark:border-green-800\"\n            : \"bg-white dark:bg-gray-800\"\n        )}>\n          <div className=\"flex items-center justify-between mb-3\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-2 rounded-full bg-gradient-to-r from-blue-500 to-cyan-500 text-white\">\n                <Target className=\"w-4 h-4\" />\n              </div>\n              <div>\n                <h3 className=\"font-medium text-gray-900 dark:text-white\">\n                  Daily Questions\n                </h3>\n                <p className=\"text-sm text-gray-500\">\n                  Target: {userGoals.dailyQuestionGoal} questions per day\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              {dailyProgress.isComplete && (\n                <Badge className=\"bg-green-500 text-white\">\n                  Complete! üéâ\n                </Badge>\n              )}\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => {\n                  setDailyTarget(userGoals.dailyQuestionGoal.toString());\n                  setIsEditingDaily(!isEditingDaily);\n                }}\n                data-testid=\"edit-daily-goal\"\n              >\n                <Edit2 className=\"w-4 h-4\" />\n              </Button>\n            </div>\n          </div>\n\n          {/* Progress */}\n          <div className=\"mb-3\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Today's Progress\n              </span>\n              <span className=\"text-sm text-gray-500\">\n                {dailyProgress.current} / {dailyProgress.target}\n              </span>\n            </div>\n            <Progress value={dailyProgress.percentage} className=\"h-3\" />\n            <div className=\"text-center mt-1\">\n              <span className=\"text-xs text-gray-500\">\n                {Math.round(dailyProgress.percentage)}% complete\n              </span>\n            </div>\n          </div>\n\n          {/* Edit Mode */}\n          {isEditingDaily && (\n            <div className=\"flex items-center gap-2 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg\">\n              <Input\n                type=\"number\"\n                min=\"1\"\n                max=\"50\"\n                value={dailyTarget}\n                onChange={(e) => setDailyTarget(e.target.value)}\n                placeholder=\"New target\"\n                className=\"flex-1\"\n                onKeyDown={(e) => {\n                  if (e.key === 'Enter') handleUpdateDaily();\n                }}\n                data-testid=\"daily-goal-input\"\n              />\n              <Button\n                size=\"sm\"\n                onClick={handleUpdateDaily}\n                disabled={updateGoalsMutation.isPending}\n                data-testid=\"save-daily-goal\"\n              >\n                <Save className=\"w-4 h-4\" />\n              </Button>\n              <Button\n                size=\"sm\"\n                variant=\"ghost\"\n                onClick={() => setIsEditingDaily(false)}\n              >\n                <X className=\"w-4 h-4\" />\n              </Button>\n            </div>\n          )}\n        </Card>\n\n        {/* Streak Goal */}\n        <Card className={cn(\n          \"p-4 transition-all\",\n          streakProgress.isComplete \n            ? \"bg-orange-50 border-orange-200 dark:bg-orange-900/20 dark:border-orange-800\"\n            : \"bg-white dark:bg-gray-800\"\n        )}>\n          <div className=\"flex items-center justify-between mb-3\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-2 rounded-full bg-gradient-to-r from-red-500 to-orange-500 text-white\">\n                <Flame className=\"w-4 h-4\" />\n              </div>\n              <div>\n                <h3 className=\"font-medium text-gray-900 dark:text-white\">\n                  Streak Goal\n                </h3>\n                <p className=\"text-sm text-gray-500\">\n                  Target: {userGoals.weeklyStreakGoal} day streak\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex items-center gap-2\">\n              {streakProgress.isComplete && (\n                <Badge className=\"bg-orange-500 text-white\">\n                  Achieved! üî•\n                </Badge>\n              )}\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => {\n                  setStreakTarget(userGoals.weeklyStreakGoal.toString());\n                  setIsEditingStreak(!isEditingStreak);\n                }}\n                data-testid=\"edit-streak-goal\"\n              >\n                <Edit2 className=\"w-4 h-4\" />\n              </Button>\n            </div>\n          </div>\n\n          {/* Progress */}\n          <div className=\"mb-3\">\n            <div className=\"flex items-center justify-between mb-2\">\n              <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n                Current Streak\n              </span>\n              <span className=\"text-sm text-gray-500\">\n                {streakProgress.current} / {streakProgress.target} days\n              </span>\n            </div>\n            <Progress value={streakProgress.percentage} className=\"h-3\" />\n            <div className=\"text-center mt-1\">\n              <span className=\"text-xs text-gray-500\">\n                {Math.round(streakProgress.percentage)}% complete\n              </span>\n            </div>\n          </div>\n\n          {/* Edit Mode */}\n          {isEditingStreak && (\n            <div className=\"flex items-center gap-2 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg\">\n              <Input\n                type=\"number\"\n                min=\"1\"\n                max=\"365\"\n                value={streakTarget}\n                onChange={(e) => setStreakTarget(e.target.value)}\n                placeholder=\"New target\"\n                className=\"flex-1\"\n                onKeyDown={(e) => {\n                  if (e.key === 'Enter') handleUpdateStreak();\n                }}\n                data-testid=\"streak-goal-input\"\n              />\n              <Button\n                size=\"sm\"\n                onClick={handleUpdateStreak}\n                disabled={updateGoalsMutation.isPending}\n                data-testid=\"save-streak-goal\"\n              >\n                <Save className=\"w-4 h-4\" />\n              </Button>\n              <Button\n                size=\"sm\"\n                variant=\"ghost\"\n                onClick={() => setIsEditingStreak(false)}\n              >\n                <X className=\"w-4 h-4\" />\n              </Button>\n            </div>\n          )}\n        </Card>\n      </div>\n\n      {/* Smart Suggestions */}\n      {suggestions && suggestions.length > 0 && (\n        <Card className=\"p-4 bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 border-purple-200 dark:border-purple-800\">\n          <h3 className=\"text-lg font-semibold mb-3 flex items-center gap-2 text-purple-700 dark:text-purple-300\">\n            <TrendingUp className=\"w-5 h-5\" />\n            Smart Suggestions\n          </h3>\n          <div className=\"space-y-3\">\n            {suggestions.map((suggestion, index) => (\n              <div\n                key={index}\n                className=\"p-3 bg-white dark:bg-gray-800 rounded-lg border\"\n                data-testid={`suggestion-${suggestion.type}`}\n              >\n                <p className=\"text-sm text-gray-600 dark:text-gray-400 mb-2\">\n                  üí° {suggestion.message}\n                </p>\n                <Button\n                  size=\"sm\"\n                  onClick={() => applySuggestion(suggestion)}\n                  disabled={updateGoalsMutation.isPending}\n                  className={cn(\n                    \"bg-gradient-to-r text-white\",\n                    suggestion.color\n                  )}\n                  data-testid={`apply-suggestion-${suggestion.type}`}\n                >\n                  Apply Suggestion\n                </Button>\n              </div>\n            ))}\n          </div>\n        </Card>\n      )}\n    </div>\n  );\n}","size_bytes":14882},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","size_bytes":756},"client/src/components/rapid-fire-settings.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport { Label } from \"@/components/ui/label\";\nimport { ChevronLeft, Zap } from \"lucide-react\";\nimport type { Category } from \"@shared/schema\";\n\ninterface RapidFireSettingsProps {\n  onStart: (settings: { selectedCategories: string[]; questionCount: number }) => void;\n  onBack: () => void;\n}\n\nexport default function RapidFireSettings({ onStart, onBack }: RapidFireSettingsProps) {\n  const [selectedCategories, setSelectedCategories] = useState<string[]>([]);\n  const [questionCount, setQuestionCount] = useState(10);\n\n  const { data: categories = [] } = useQuery<Category[]>({\n    queryKey: [\"/api/categories\"],\n  });\n\n  const handleCategoryToggle = (categoryId: string) => {\n    setSelectedCategories(prev => \n      prev.includes(categoryId) \n        ? prev.filter(id => id !== categoryId)\n        : [...prev, categoryId]\n    );\n  };\n\n  const handleSelectAll = () => {\n    if (selectedCategories.length === categories.length) {\n      setSelectedCategories([]);\n    } else {\n      setSelectedCategories(categories.map(cat => cat.id));\n    }\n  };\n\n  const handleStart = () => {\n    onStart({\n      selectedCategories: selectedCategories.length > 0 ? selectedCategories : categories.map(cat => cat.id),\n      questionCount,\n    });\n  };\n\n  return (\n    <section className=\"p-4\" data-testid=\"rapid-fire-settings\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-4\">\n        <Button\n          variant=\"ghost\"\n          onClick={onBack}\n          className=\"flex items-center\"\n          data-testid=\"button-back\"\n        >\n          <ChevronLeft className=\"mr-1\" size={20} />\n          Back\n        </Button>\n        <div className=\"text-right\">\n          <div className=\"text-sm text-muted-foreground\">Rapid Fire</div>\n          <div className=\"font-bold\">Settings</div>\n        </div>\n      </div>\n\n      {/* Settings */}\n      <div className=\"space-y-6\">\n        {/* Question Count */}\n        <Card className=\"p-4\">\n          <h3 className=\"font-bold mb-3\">Number of Questions</h3>\n          <div className=\"grid grid-cols-4 gap-2\">\n            {[5, 10, 15, 20].map((count) => (\n              <Button\n                key={count}\n                variant={questionCount === count ? \"default\" : \"outline\"}\n                onClick={() => setQuestionCount(count)}\n                data-testid={`button-count-${count}`}\n              >\n                {count}\n              </Button>\n            ))}\n          </div>\n        </Card>\n\n        {/* Category Selection */}\n        <Card className=\"p-4\">\n          <div className=\"flex items-center justify-between mb-3\">\n            <h3 className=\"font-bold\">Categories</h3>\n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={handleSelectAll}\n              data-testid=\"button-select-all\"\n            >\n              {selectedCategories.length === categories.length ? \"Deselect All\" : \"Select All\"}\n            </Button>\n          </div>\n          \n          <div className=\"space-y-3\">\n            {categories.map((category) => (\n              <div key={category.id} className=\"flex items-center space-x-2\">\n                <Checkbox\n                  id={`category-${category.id}`}\n                  checked={selectedCategories.includes(category.id)}\n                  onCheckedChange={() => handleCategoryToggle(category.id)}\n                  data-testid={`checkbox-${category.id}`}\n                />\n                <Label\n                  htmlFor={`category-${category.id}`}\n                  className=\"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n                >\n                  {category.name}\n                </Label>\n              </div>\n            ))}\n          </div>\n\n          {selectedCategories.length === 0 && (\n            <p className=\"text-sm text-muted-foreground mt-3\">\n              No categories selected. All categories will be included.\n            </p>\n          )}\n        </Card>\n\n        {/* Start Button */}\n        <Button\n          onClick={handleStart}\n          size=\"lg\"\n          className=\"w-full bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n          data-testid=\"button-start-rapid-fire\"\n        >\n          <Zap className=\"mr-2\" size={20} />\n          Start Rapid Fire ({questionCount} questions)\n        </Button>\n      </div>\n    </section>\n  );\n}","size_bytes":4616},"client/src/pages/study.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Input } from \"@/components/ui/input\";\nimport { BookOpen, Brain, ExternalLink, Plus, Loader2, CheckCircle, XCircle, HelpCircle, ChevronLeft, Star, TrendingUp, Zap, Gem } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { StudyReview, StudyMaterial, Category, QuestionWithLearning } from \"@shared/schema\";\n\nexport default function StudyPage() {\n  const [selectedCategory, setSelectedCategory] = useState<string>(\"\");\n  const [studyTopic, setStudyTopic] = useState(\"\");\n  const [, setLocation] = useLocation();\n\n  const processContent = (content: string) => {\n    // First, fix only the most problematic concatenated bullet points\n    let processedContent = content\n      // Split bullet points that are concatenated with period-dash pattern\n      .replace(/\\.-\\s*/g, '.\\n- ')\n      // Split bullet points that are directly concatenated without proper spacing\n      .replace(/([.!?])\\s*-\\s*([A-Z])/g, '$1\\n- $2');\n    \n    return processedContent.split('\\n').map((line, index) => {\n      const trimmed = line.trim();\n      \n      // Enhanced filtering for unwanted sections\n      if (\n        // Empty or very short lines\n        trimmed.length < 8 || \n        // Incomplete words or fragments\n        trimmed.match(/^[A-Z][a-z]{1,4}$/) ||\n        // Cut-off sentences\n        trimmed.endsWith('...') ||\n        // \"Why this is correct\" sections\n        trimmed.toLowerCase().includes('why this is correct') ||\n        trimmed.toLowerCase().includes('why it\\'s correct') ||\n        // Very short sentences with few words\n        (trimmed.length < 40 && trimmed.split(' ').length < 4) ||\n        // Common incomplete fragments\n        trimmed.match(/^(The|This|These|That|A|An)\\.?$/i) ||\n        // Lines that are just punctuation or single words\n        trimmed.match(/^[.,;:!?-]+$/) ||\n        // Incomplete question variations\n        trimmed.toLowerCase().includes('question variation') && trimmed.length < 30\n      ) {\n        return null;\n      }\n      \n      // Handle bold headers (full line wrapped in **)\n      if (trimmed.startsWith('**') && trimmed.endsWith('**') && trimmed.length > 4) {\n        return <h4 key={index} className=\"font-semibold mt-3 mb-1 text-primary text-sm\">{trimmed.slice(2, -2)}</h4>;\n      } \n      // Handle bullet points with indentation\n      else if (trimmed.startsWith('‚Ä¢') || trimmed.startsWith('-') || trimmed.match(/^\\\\d+\\\\./)) {\n        const cleanText = trimmed.replace(/^[\\u2022\\\\-\\\\d+\\\\.\\\\s]+/, '').trim();\n        if (cleanText.length < 8) return null; // Skip if cleaned text is too short\n        return <li key={index} className=\"ml-6 mb-1 text-sm list-disc\">{cleanText}</li>;\n      } \n      // Handle inline bold text\n      else if (trimmed.includes('**')) {\n        const parts = trimmed.split('**');\n        return (\n          <p key={index} className=\"mb-1 text-sm leading-snug\">\n            {parts.map((part, partIndex) => \n              partIndex % 2 === 1 ? \n                <strong key={partIndex} className=\"font-semibold\">{part}</strong> : \n                part\n            )}\n          </p>\n        );\n      } \n      // Regular text (must be substantial enough)\n      else if (trimmed.length > 0) {\n        return <p key={index} className=\"mb-1 text-sm leading-snug\">{trimmed}</p>;\n      }\n      return null;\n    }).filter(Boolean);\n  };\n\n  // Fetch categories for study material generation\n  const { data: categories = [] } = useQuery<Category[]>({\n    queryKey: [\"/api/categories\"],\n  });\n\n  // Fetch study review (questions with learning materials by assessment)\n  const { data: studyReview, isLoading: isLoadingReview } = useQuery<StudyReview>({\n    queryKey: [\"/api/study-review\"],\n  });\n\n  // Fetch general study materials\n  const { data: studyMaterials = [], isLoading: isLoadingMaterials, refetch: refetchMaterials } = useQuery<StudyMaterial[]>({\n    queryKey: [\"/api/study-materials\"],\n  });\n\n  // Generate new study material\n  const generateStudyMutation = useMutation<StudyMaterial, Error, { category: string; topic?: string }>({\n    mutationFn: async (data) => {\n      return apiRequest(\"POST\", \"/api/study-materials\", data);\n    },\n    onSuccess: () => {\n      refetchMaterials();\n      setStudyTopic(\"\");\n    },\n  });\n\n  const handleGenerateStudyMaterial = () => {\n    if (!selectedCategory) return;\n    generateStudyMutation.mutate({\n      category: selectedCategory,\n      topic: studyTopic || undefined,\n    });\n  };\n\n  const renderQuestionCard = (question: QuestionWithLearning, index: number) => (\n    <Card key={`${question.id}-${index}`} className=\"p-4 mb-4\">\n      <div className=\"space-y-3\">\n        <div className=\"flex items-center justify-between\">\n          <Badge variant=\"outline\">{question.category.name}</Badge>\n          <span className=\"text-sm font-semibold\">${question.value}</span>\n        </div>\n        \n        <div className=\"space-y-2\">\n          <p className=\"font-medium text-sm\">{question.text}</p>\n          <p className=\"text-sm text-muted-foreground\">\n            <strong>Answer:</strong> {question.answer}\n          </p>\n        </div>\n\n        {question.learningMaterial && (\n          <div className=\"bg-muted/50 p-3 rounded space-y-2\">\n            <h5 className=\"font-medium text-sm flex items-center\">\n              <BookOpen size={14} className=\"mr-1\" />\n              Learning Material\n            </h5>\n            <div className=\"text-xs\">\n              {processContent(question.learningMaterial.explanation)}\n            </div>\n            \n            {question.learningMaterial.relatedFacts.length > 0 && (\n              <div className=\"space-y-1\">\n                <h6 className=\"font-medium text-xs\">Related Facts:</h6>\n                {question.learningMaterial.relatedFacts\n                  .filter(fact => {\n                    const trimmed = fact.trim();\n                    return trimmed.length >= 10 && \n                           !trimmed.toLowerCase().includes('why this is correct') &&\n                           !trimmed.endsWith('...') &&\n                           !(trimmed.length < 50 && trimmed.split(' ').length < 5);\n                  })\n                  .slice(0, 2)\n                  .map((fact, factIndex) => (\n                  <div key={factIndex} className=\"text-xs text-muted-foreground\">\n                    <span className=\"inline-block w-1 h-1 bg-muted-foreground rounded-full mr-2\"></span>\n                    <span className=\"inline\">\n                      {fact.includes('**') ? (\n                        fact.split('**').map((part, partIndex) => \n                          partIndex % 2 === 1 ? \n                            <strong key={partIndex} className=\"font-semibold\">{part}</strong> : \n                            part\n                        )\n                      ) : fact}\n                    </span>\n                  </div>\n                ))}\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    </Card>\n  );\n\n  return (\n    <div className=\"container mx-auto p-4 max-w-4xl pb-20\" data-testid=\"study-page\">\n      {/* Header with navigation */}\n      <div className=\"flex items-center mb-6\">\n        <Button\n          variant=\"ghost\"\n          onClick={() => setLocation(\"/\")}\n          className=\"flex items-center mr-4\"\n          data-testid=\"button-back-to-game\"\n        >\n          <ChevronLeft className=\"mr-1\" size={20} />\n          Back to Game\n        </Button>\n        <div className=\"flex-1\">\n          <h1 className=\"text-2xl font-bold mb-2\">Study Center</h1>\n          <p className=\"text-muted-foreground\">\n            Review your practice questions and explore study materials to improve your Jeopardy knowledge.\n          </p>\n        </div>\n      </div>\n\n      <Tabs defaultValue=\"review\" className=\"space-y-6\">\n        <TabsList className=\"grid w-full grid-cols-2\">\n          <TabsTrigger value=\"review\" data-testid=\"tab-review\">\n            <Brain className=\"mr-2\" size={16} />\n            Question Review\n          </TabsTrigger>\n          <TabsTrigger value=\"materials\" data-testid=\"tab-materials\">\n            <BookOpen className=\"mr-2\" size={16} />\n            Study Materials\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"review\" className=\"space-y-6\" data-testid=\"tab-content-review\">\n          {isLoadingReview ? (\n            <div className=\"flex items-center justify-center py-12\">\n              <Loader2 className=\"mr-2 animate-spin\" size={20} />\n              <span>Loading your study review...</span>\n            </div>\n          ) : !studyReview || (studyReview.correct.length === 0 && studyReview.incorrect.length === 0 && studyReview.unsure.length === 0) ? (\n            <Card className=\"p-8 text-center\">\n              <Brain className=\"mx-auto mb-4 text-muted-foreground\" size={48} />\n              <h3 className=\"text-lg font-semibold mb-2\">No Practice Questions Yet</h3>\n              <p className=\"text-muted-foreground mb-4\">\n                Start practicing with the game board or rapid-fire mode to build your study review.\n              </p>\n            </Card>\n          ) : (\n            <div className=\"space-y-6\">\n              {/* Incorrect Questions */}\n              {studyReview.incorrect.length > 0 && (\n                <div>\n                  <div className=\"flex items-center mb-4\">\n                    <XCircle className=\"mr-2 text-red-500\" size={20} />\n                    <h2 className=\"text-lg font-semibold\">Questions to Review ({studyReview.incorrect.length})</h2>\n                  </div>\n                  <div className=\"space-y-4\">\n                    {studyReview.incorrect.map(renderQuestionCard)}\n                  </div>\n                </div>\n              )}\n\n              {/* Unsure Questions */}\n              {studyReview.unsure.length > 0 && (\n                <div>\n                  <div className=\"flex items-center mb-4\">\n                    <HelpCircle className=\"mr-2 text-orange-500\" size={20} />\n                    <h2 className=\"text-lg font-semibold\">Questions You Were Unsure About ({studyReview.unsure.length})</h2>\n                  </div>\n                  <div className=\"space-y-4\">\n                    {studyReview.unsure.map(renderQuestionCard)}\n                  </div>\n                </div>\n              )}\n\n              {/* Correct Questions */}\n              {studyReview.correct.length > 0 && (\n                <div>\n                  <div className=\"flex items-center mb-4\">\n                    <CheckCircle className=\"mr-2 text-green-500\" size={20} />\n                    <h2 className=\"text-lg font-semibold\">Questions You Got Right ({studyReview.correct.length})</h2>\n                  </div>\n                  <div className=\"space-y-4\">\n                    {studyReview.correct.map(renderQuestionCard)}\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n        </TabsContent>\n\n        <TabsContent value=\"materials\" className=\"space-y-6\" data-testid=\"tab-content-materials\">\n          {/* Generate New Study Material */}\n          <Card className=\"p-6\">\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center mb-4\">\n                <Plus className=\"mr-2 text-primary\" size={20} />\n                <h3 className=\"text-lg font-semibold\">Generate Study Material</h3>\n              </div>\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">Category</label>\n                  <Select value={selectedCategory} onValueChange={setSelectedCategory} data-testid=\"select-category\">\n                    <SelectTrigger>\n                      <SelectValue placeholder=\"Select a category\" />\n                    </SelectTrigger>\n                    <SelectContent>\n                      {categories.map((category) => (\n                        <SelectItem key={category.id} value={category.name}>\n                          {category.name}\n                        </SelectItem>\n                      ))}\n                    </SelectContent>\n                  </Select>\n                </div>\n                \n                <div>\n                  <label className=\"text-sm font-medium mb-2 block\">Specific Topic (Optional)</label>\n                  <Input\n                    value={studyTopic}\n                    onChange={(e) => setStudyTopic(e.target.value)}\n                    placeholder=\"e.g., Napoleon Bonaparte, DNA structure\"\n                    data-testid=\"input-topic\"\n                  />\n                </div>\n              </div>\n              \n              <Button\n                onClick={handleGenerateStudyMaterial}\n                disabled={!selectedCategory || generateStudyMutation.isPending}\n                data-testid=\"button-generate-material\"\n              >\n                {generateStudyMutation.isPending ? (\n                  <>\n                    <Loader2 className=\"mr-2 animate-spin\" size={16} />\n                    Generating...\n                  </>\n                ) : (\n                  <>\n                    <Plus className=\"mr-2\" size={16} />\n                    Generate Study Material\n                  </>\n                )}\n              </Button>\n            </div>\n          </Card>\n\n          {/* Study Materials List */}\n          {isLoadingMaterials ? (\n            <div className=\"flex items-center justify-center py-12\">\n              <Loader2 className=\"mr-2 animate-spin\" size={20} />\n              <span>Loading study materials...</span>\n            </div>\n          ) : studyMaterials.length === 0 ? (\n            <Card className=\"p-8 text-center\">\n              <BookOpen className=\"mx-auto mb-4 text-muted-foreground\" size={48} />\n              <h3 className=\"text-lg font-semibold mb-2\">No Study Materials Yet</h3>\n              <p className=\"text-muted-foreground\">\n                Generate your first study material by selecting a category above.\n              </p>\n            </Card>\n          ) : (\n            <div className=\"space-y-4\">\n              <h3 className=\"text-lg font-semibold\">Your Study Materials</h3>\n              {studyMaterials.map((material) => (\n                <Card key={material.id} className=\"p-6\">\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center space-x-2\">\n                        <Badge variant=\"secondary\">{material.category}</Badge>\n                      </div>\n                      <span className=\"text-xs text-muted-foreground\">\n                        {new Date(material.generatedAt).toLocaleDateString()}\n                      </span>\n                    </div>\n                    \n                    <h4 className=\"font-semibold text-lg\">{material.title}</h4>\n                    \n                    <div className=\"prose prose-sm max-w-none\">\n                      {processContent(material.content)}\n                    </div>\n                    \n                    {material.relatedTopics.length > 0 && (\n                      <div>\n                        <h5 className=\"font-medium mb-2\">Related Topics:</h5>\n                        <div className=\"flex flex-wrap gap-1\">\n                          {material.relatedTopics.map((topic, index) => (\n                            <Badge key={index} variant=\"outline\" className=\"text-xs\">\n                              {topic}\n                            </Badge>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n                    \n                    {material.sources.length > 0 && (\n                      <div>\n                        <h5 className=\"font-medium mb-2\">Sources:</h5>\n                        <div className=\"flex flex-wrap gap-2\">\n                          {material.sources.map((source, index) => (\n                            <a\n                              key={index}\n                              href={source}\n                              target=\"_blank\"\n                              rel=\"noopener noreferrer\"\n                              className=\"text-xs text-primary hover:underline flex items-center\"\n                            >\n                              <ExternalLink size={12} className=\"mr-1\" />\n                              Source {index + 1}\n                            </a>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                </Card>\n              ))}\n            </div>\n          )}\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}","size_bytes":17222},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","size_bytes":1527},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","size_bytes":971},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  out: \"./migrations\",\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","size_bytes":325},"client/src/components/achievement-toast.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { X, Trophy, Star, Crown, Zap } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { cn } from \"@/lib/utils\";\nimport type { AchievementWithProgress } from \"@shared/schema\";\n\ninterface AchievementToastProps {\n  achievement: AchievementWithProgress | null;\n  isVisible: boolean;\n  onClose: () => void;\n  onViewAll?: () => void;\n}\n\nexport default function AchievementToast({ \n  achievement, \n  isVisible, \n  onClose, \n  onViewAll \n}: AchievementToastProps) {\n  const [isAnimating, setIsAnimating] = useState(false);\n  const [shouldRender, setShouldRender] = useState(false);\n\n  useEffect(() => {\n    if (isVisible && achievement) {\n      setShouldRender(true);\n      // Small delay to ensure DOM is ready\n      setTimeout(() => setIsAnimating(true), 10);\n      \n      // Auto-dismiss after 8 seconds\n      const timer = setTimeout(() => {\n        handleClose();\n      }, 8000);\n\n      return () => clearTimeout(timer);\n    } else {\n      handleClose();\n    }\n  }, [isVisible, achievement]);\n\n  const handleClose = () => {\n    setIsAnimating(false);\n    setTimeout(() => {\n      setShouldRender(false);\n      onClose();\n    }, 300); // Match animation duration\n  };\n\n  const getTierGradient = (tier: string) => {\n    switch (tier.toLowerCase()) {\n      case \"platinum\":\n        return \"from-gray-300 via-white to-gray-400\";\n      case \"gold\":\n        return \"from-yellow-300 via-yellow-200 to-yellow-400\";\n      case \"silver\":\n        return \"from-gray-400 via-gray-300 to-gray-500\";\n      case \"bronze\":\n        return \"from-orange-400 via-orange-300 to-orange-500\";\n      default:\n        return \"from-gray-400 via-gray-300 to-gray-500\";\n    }\n  };\n\n  const getTierIcon = (tier: string) => {\n    switch (tier.toLowerCase()) {\n      case \"platinum\":\n        return <Crown className=\"w-6 h-6 text-white\" />;\n      case \"gold\":\n        return <Trophy className=\"w-6 h-6 text-white\" />;\n      case \"silver\":\n        return <Star className=\"w-6 h-6 text-white\" />;\n      case \"bronze\":\n        return <Zap className=\"w-6 h-6 text-white\" />;\n      default:\n        return <Trophy className=\"w-6 h-6 text-white\" />;\n    }\n  };\n\n  const getTierGlow = (tier: string) => {\n    switch (tier.toLowerCase()) {\n      case \"platinum\":\n        return \"shadow-2xl shadow-gray-300/50\";\n      case \"gold\":\n        return \"shadow-2xl shadow-yellow-400/50\";\n      case \"silver\":\n        return \"shadow-2xl shadow-gray-400/50\";\n      case \"bronze\":\n        return \"shadow-2xl shadow-orange-400/50\";\n      default:\n        return \"shadow-2xl shadow-gray-400/50\";\n    }\n  };\n\n  if (!shouldRender || !achievement) return null;\n\n  const toastContent = (\n    <div\n      className={cn(\n        \"fixed top-4 left-1/2 transform -translate-x-1/2 z-[9998] w-full max-w-sm mx-4\",\n        \"transition-all duration-300 ease-out\",\n        isAnimating \n          ? \"translate-y-0 opacity-100 scale-100\" \n          : \"-translate-y-full opacity-0 scale-95\"\n      )}\n      data-testid=\"achievement-toast\"\n    >\n      <div className={cn(\n        \"relative p-6 rounded-2xl border-2 backdrop-blur-sm bg-white/95 dark:bg-gray-900/95\",\n        `bg-gradient-to-br ${getTierGradient(achievement.tier)}`,\n        getTierGlow(achievement.tier)\n      )}>\n        {/* Animated Border */}\n        <div className={cn(\n          \"absolute inset-0 rounded-2xl bg-gradient-to-r p-[2px]\",\n          getTierGradient(achievement.tier)\n        )}>\n          <div className=\"w-full h-full bg-white dark:bg-gray-900 rounded-2xl\" />\n        </div>\n\n        {/* Content */}\n        <div className=\"relative z-10\">\n          {/* Header */}\n          <div className=\"flex items-center justify-between mb-4\">\n            <div className=\"flex items-center gap-2\">\n              <div className={cn(\n                \"p-2 rounded-full bg-gradient-to-r\",\n                getTierGradient(achievement.tier)\n              )}>\n                {getTierIcon(achievement.tier)}\n              </div>\n              <div>\n                <h3 className=\"text-lg font-bold text-gray-900 dark:text-white\">\n                  Achievement Unlocked!\n                </h3>\n                <Badge className={cn(\n                  \"text-xs font-medium text-white bg-gradient-to-r\",\n                  getTierGradient(achievement.tier)\n                )}>\n                  {achievement.tier} ‚Ä¢ {achievement.points} pts\n                </Badge>\n              </div>\n            </div>\n            \n            <Button\n              variant=\"ghost\"\n              size=\"sm\"\n              onClick={handleClose}\n              className=\"text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200\"\n              data-testid=\"close-achievement-toast\"\n            >\n              <X className=\"w-4 h-4\" />\n            </Button>\n          </div>\n\n          {/* Achievement Details */}\n          <div className=\"text-center mb-4\">\n            <div className=\"text-4xl mb-2 animate-bounce\">\n              {achievement.icon}\n            </div>\n            <h4 className=\"text-xl font-bold text-gray-900 dark:text-white mb-2\">\n              {achievement.name}\n            </h4>\n            <p className=\"text-sm text-gray-600 dark:text-gray-300 leading-relaxed\">\n              {achievement.description}\n            </p>\n          </div>\n\n          {/* Action Buttons */}\n          <div className=\"flex gap-2\">\n            <Button\n              variant=\"outline\"\n              size=\"sm\"\n              onClick={handleClose}\n              className=\"flex-1\"\n              data-testid=\"dismiss-toast\"\n            >\n              Awesome!\n            </Button>\n            {onViewAll && (\n              <Button\n                size=\"sm\"\n                onClick={() => {\n                  onViewAll();\n                  handleClose();\n                }}\n                className={cn(\n                  \"flex-1 text-white bg-gradient-to-r\",\n                  getTierGradient(achievement.tier)\n                )}\n                data-testid=\"view-all-achievements\"\n              >\n                View All\n              </Button>\n            )}\n          </div>\n        </div>\n\n        {/* Pulse Animation */}\n        <div className={cn(\n          \"absolute inset-0 rounded-2xl animate-ping opacity-20 bg-gradient-to-r\",\n          getTierGradient(achievement.tier)\n        )} />\n        \n        {/* Sparkle Effects */}\n        <div className=\"absolute top-2 right-2 text-yellow-400 animate-pulse text-xs\">‚ú®</div>\n        <div className=\"absolute top-4 left-2 text-yellow-400 animate-pulse text-xs delay-500\">‚ú®</div>\n        <div className=\"absolute bottom-2 right-4 text-yellow-400 animate-pulse text-xs delay-1000\">‚ú®</div>\n        <div className=\"absolute bottom-4 left-4 text-yellow-400 animate-pulse text-xs delay-700\">‚≠ê</div>\n      </div>\n    </div>\n  );\n\n  return createPortal(toastContent, document.body);\n}\n\n// Achievement celebration manager\ninterface CelebrationManagerProps {\n  children: React.ReactNode;\n}\n\nexport function CelebrationManager({ children }: CelebrationManagerProps) {\n  const [celebrationQueue, setCelebrationQueue] = useState<AchievementWithProgress[]>([]);\n  const [currentCelebration, setCurrentCelebration] = useState<AchievementWithProgress | null>(null);\n  const [isToastVisible, setIsToastVisible] = useState(false);\n\n  // Process celebration queue\n  useEffect(() => {\n    if (!currentCelebration && celebrationQueue.length > 0) {\n      const nextCelebration = celebrationQueue[0];\n      setCelebrationQueue(prev => prev.slice(1));\n      setCurrentCelebration(nextCelebration);\n      setIsToastVisible(true);\n    }\n  }, [currentCelebration, celebrationQueue]);\n\n  const handleToastClose = () => {\n    setIsToastVisible(false);\n    setCurrentCelebration(null);\n  };\n\n  // Expose celebration trigger function\n  useEffect(() => {\n    const triggerCelebration = (achievement: AchievementWithProgress) => {\n      setCelebrationQueue(prev => [...prev, achievement]);\n    };\n\n    // Add to window for global access\n    (window as any).triggerAchievementCelebration = triggerCelebration;\n\n    return () => {\n      delete (window as any).triggerAchievementCelebration;\n    };\n  }, []);\n\n  return (\n    <>\n      {children}\n      <AchievementToast\n        achievement={currentCelebration}\n        isVisible={isToastVisible}\n        onClose={handleToastClose}\n        onViewAll={() => {\n          // Navigate to achievements gallery\n          const event = new CustomEvent('navigate-to-achievements');\n          window.dispatchEvent(event);\n        }}\n      />\n    </>\n  );\n}","size_bytes":8678},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n","size_bytes":1858},"client/src/components/question-view.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { ChevronLeft, Clock } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { QuestionWithCategory } from \"@shared/schema\";\nimport EnhancedFeedbackModal from \"./enhanced-feedback-modal\";\nimport { useAnsweredQuestions } from \"@/hooks/useAnsweredQuestions\";\n\ninterface QuestionViewProps {\n  questionId: string;\n  onAnswerSubmit: (correct: boolean, answer: string, value: number) => void;\n  onBack: () => void;\n}\n\nexport default function QuestionView({ questionId, onAnswerSubmit, onBack }: QuestionViewProps) {\n  const [timeSpent, setTimeSpent] = useState(0);\n  const [startTime] = useState(Date.now());\n  const [showAnswer, setShowAnswer] = useState(false);\n  const [showFeedback, setShowFeedback] = useState(false);\n  const [userAssessment, setUserAssessment] = useState<\"correct\" | \"incorrect\" | \"unsure\">(\"unsure\");\n  const { addAnsweredQuestion } = useAnsweredQuestions();\n\n  useEffect(() => {\n    const timer = setInterval(() => {\n      setTimeSpent(Math.floor((Date.now() - startTime) / 1000));\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, [startTime]);\n\n  const { data: question, isLoading } = useQuery<QuestionWithCategory>({\n    queryKey: [`/api/questions/${questionId}`],\n    enabled: !!questionId,\n  });\n\n  const submitAnswerMutation = useMutation({\n    mutationFn: async (data: {\n      questionId: string;\n      correct: boolean;\n      userAnswer: string;\n      timeSpent: number;\n      selfAssessment: \"correct\" | \"incorrect\" | \"unsure\";\n    }) => {\n      return apiRequest(\"POST\", \"/api/progress\", data);\n    },\n    onSuccess: () => {\n      // Invalidate all data that depends on user progress\n      queryClient.invalidateQueries({ queryKey: [\"/api/stats\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/answered-questions\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/readiness\"] });\n      \n      // COST OPTIMIZATION: Trigger fresh achievement and gamification data\n      queryClient.invalidateQueries({ queryKey: [\"/api/achievements/progress\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/gamification-stats\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications/unread-count\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/user-goals\"] });\n    },\n  });\n\n  const handleSelfAssessment = async (assessment: \"correct\" | \"incorrect\" | \"unsure\") => {\n    if (!question) return;\n\n    setUserAssessment(assessment);\n\n    // Track answered question locally for anonymous users\n    addAnsweredQuestion(question.id, assessment);\n\n    await submitAnswerMutation.mutateAsync({\n      questionId: question.id,\n      correct: assessment === \"correct\",\n      userAnswer: \"\",\n      timeSpent,\n      selfAssessment: assessment,\n    });\n\n    setShowFeedback(true);\n  };\n\n  const handleFeedbackNext = () => {\n    if (!question) return;\n    setShowFeedback(false);\n    onAnswerSubmit(userAssessment === \"correct\", question.answer, question.value);\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"p-4 flex items-center justify-center min-h-[400px]\">\n        <div className=\"text-center\">Loading question...</div>\n      </div>\n    );\n  }\n\n  if (!question) {\n    return (\n      <div className=\"p-4 flex items-center justify-center min-h-[400px]\">\n        <div className=\"text-center\">\n          <p className=\"mb-4\">Question not found.</p>\n          <Button onClick={onBack}>Back to Game Board</Button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <section className=\"p-4\" data-testid=\"question-view\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-4\">\n        <Button\n          variant=\"ghost\"\n          onClick={onBack}\n          className=\"flex items-center\"\n          data-testid=\"button-back\"\n        >\n          <ChevronLeft className=\"mr-1\" size={20} />\n          Back\n        </Button>\n        <div className=\"text-right\">\n          <div className=\"text-sm text-muted-foreground\">Time Spent</div>\n          <div className=\"font-bold flex items-center\" data-testid=\"text-time-spent\">\n            <Clock className=\"mr-1\" size={16} />\n            {timeSpent}s\n          </div>\n        </div>\n      </div>\n\n      {/* Category and Value */}\n      <div className=\"mb-6 text-center\">\n        <div className=\"text-sm text-muted-foreground mb-1\" data-testid=\"text-category\">\n          {question.category.name}\n        </div>\n        <div className=\"text-2xl font-bold text-primary\" data-testid=\"text-value\">\n          ${question.value}\n        </div>\n        {question.airDate && (\n          <div className=\"text-xs text-muted-foreground mt-1\" data-testid=\"text-air-date\">\n            Originally aired: {new Date(question.airDate).toLocaleDateString()}\n          </div>\n        )}\n      </div>\n\n      {/* Question Card */}\n      <Card className=\"question-card p-8 mb-6\">\n        <div className=\"text-center\">\n          <p className=\"text-xl leading-relaxed mb-6 text-primary-foreground\" data-testid=\"text-question\">\n            {question.text}\n          </p>\n          \n          {!showAnswer ? (\n            <Button\n              onClick={() => setShowAnswer(true)}\n              size=\"lg\"\n              className=\"bg-primary-foreground text-primary hover:bg-primary-foreground/90\"\n              data-testid=\"button-reveal-answer\"\n            >\n              Reveal Answer\n            </Button>\n          ) : (\n            <div className=\"space-y-6\">\n              <div className=\"p-6 bg-primary-foreground/20 rounded-lg\">\n                <p className=\"text-xl font-medium text-primary-foreground\" data-testid=\"text-answer\">\n                  {question.answer}\n                </p>\n              </div>\n              \n              <div className=\"space-y-3\">\n                <p className=\"text-primary-foreground/80\">How did you do?</p>\n                <div className=\"grid grid-cols-3 gap-4\">\n                  <Button\n                    onClick={() => handleSelfAssessment(\"correct\")}\n                    className=\"bg-green-600 text-white hover:bg-green-700 py-3\"\n                    data-testid=\"button-self-correct\"\n                    disabled={submitAnswerMutation.isPending}\n                  >\n                    ‚úì Correct\n                  </Button>\n                  <Button\n                    onClick={() => handleSelfAssessment(\"incorrect\")}\n                    className=\"bg-red-600 text-white hover:bg-red-700 py-3\"\n                    data-testid=\"button-self-incorrect\"\n                    disabled={submitAnswerMutation.isPending}\n                  >\n                    ‚úó Incorrect\n                  </Button>\n                  <Button\n                    onClick={() => handleSelfAssessment(\"unsure\")}\n                    variant=\"secondary\"\n                    className=\"py-3\"\n                    data-testid=\"button-self-unsure\"\n                    disabled={submitAnswerMutation.isPending}\n                  >\n                    ? Unsure\n                  </Button>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </Card>\n\n      {/* Enhanced Feedback Modal */}\n      <EnhancedFeedbackModal\n        isVisible={showFeedback}\n        correct={userAssessment === \"correct\"}\n        question={question.text}\n        answer={question.answer}\n        value={question.value}\n        questionId={question.id}\n        userAssessment={userAssessment}\n        onNext={handleFeedbackNext}\n      />\n    </section>\n  );\n}","size_bytes":7747},"client/src/components/achievement-badge.tsx":{"content":"import { useState } from \"react\";\nimport { Crown, Lock, Star, Target, Trophy, Zap, CheckCircle } from \"lucide-react\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Card } from \"@/components/ui/card\";\nimport { cn } from \"@/lib/utils\";\nimport type { AchievementWithProgress } from \"@shared/schema\";\n\ninterface AchievementBadgeProps {\n  achievement: AchievementWithProgress;\n  size?: \"small\" | \"medium\" | \"large\";\n  showProgress?: boolean;\n  onClick?: () => void;\n}\n\nexport default function AchievementBadge({ \n  achievement, \n  size = \"medium\", \n  showProgress = true, \n  onClick \n}: AchievementBadgeProps) {\n  const [isHovered, setIsHovered] = useState(false);\n\n  const getTierColor = (tier: string) => {\n    switch (tier.toLowerCase()) {\n      case \"platinum\":\n        return \"from-gray-300 via-gray-200 to-gray-400\";\n      case \"gold\": \n        return \"from-yellow-300 via-yellow-200 to-yellow-400\";\n      case \"silver\":\n        return \"from-gray-400 via-gray-300 to-gray-500\";\n      case \"bronze\":\n        return \"from-orange-400 via-orange-300 to-orange-500\";\n      default:\n        return \"from-gray-400 via-gray-300 to-gray-500\";\n    }\n  };\n\n  const getCategoryColor = (category: string) => {\n    switch (category.toLowerCase()) {\n      case \"milestone\":\n        return \"from-blue-500 to-cyan-500\";\n      case \"streak\":\n        return \"from-red-500 to-orange-500\";\n      case \"mastery\":\n        return \"from-purple-500 to-pink-500\";\n      case \"speed\":\n        return \"from-green-500 to-teal-500\";\n      case \"test\":\n        return \"from-indigo-500 to-blue-500\";\n      default:\n        return \"from-gray-500 to-gray-600\";\n    }\n  };\n\n  const getCategoryIcon = (category: string) => {\n    switch (category.toLowerCase()) {\n      case \"milestone\":\n        return <Target className=\"w-4 h-4\" />;\n      case \"streak\":\n        return <Zap className=\"w-4 h-4\" />;\n      case \"mastery\":\n        return <Crown className=\"w-4 h-4\" />;\n      case \"speed\":\n        return <Star className=\"w-4 h-4\" />;\n      case \"test\":\n        return <Trophy className=\"w-4 h-4\" />;\n      default:\n        return <CheckCircle className=\"w-4 h-4\" />;\n    }\n  };\n\n  const getSizeClasses = () => {\n    switch (size) {\n      case \"small\":\n        return {\n          card: \"p-3 min-h-[120px]\",\n          icon: \"text-3xl\",\n          title: \"text-sm font-semibold\",\n          description: \"text-xs\",\n          progress: \"h-2\",\n          badge: \"text-xs px-2 py-1\"\n        };\n      case \"large\":\n        return {\n          card: \"p-6 min-h-[200px]\",\n          icon: \"text-6xl\",\n          title: \"text-lg font-bold\",\n          description: \"text-sm\",\n          progress: \"h-3\",\n          badge: \"text-sm px-3 py-1\"\n        };\n      default: // medium\n        return {\n          card: \"p-4 min-h-[160px]\",\n          icon: \"text-4xl\",\n          title: \"text-base font-semibold\",\n          description: \"text-sm\",\n          progress: \"h-2.5\",\n          badge: \"text-xs px-2 py-1\"\n        };\n    }\n  };\n\n  const sizeClasses = getSizeClasses();\n\n  return (\n    <Card\n      className={cn(\n        \"relative cursor-pointer transition-all duration-300 overflow-hidden\",\n        sizeClasses.card,\n        achievement.isEarned \n          ? \"bg-gradient-to-br from-white to-gray-50 dark:from-gray-800 dark:to-gray-900 border-2\"\n          : \"bg-gradient-to-br from-gray-100 to-gray-200 dark:from-gray-700 dark:to-gray-800 border border-dashed opacity-75\",\n        isHovered && \"scale-105 shadow-lg\",\n        onClick && \"hover:shadow-lg\"\n      )}\n      onClick={onClick}\n      onMouseEnter={() => setIsHovered(true)}\n      onMouseLeave={() => setIsHovered(false)}\n      data-testid={`achievement-${achievement.key}`}\n    >\n      {/* Tier Gradient Border */}\n      {achievement.isEarned && (\n        <div className={cn(\n          \"absolute inset-0 p-[2px] bg-gradient-to-r rounded-lg\",\n          getTierColor(achievement.tier)\n        )}>\n          <div className=\"w-full h-full bg-white dark:bg-gray-900 rounded-lg\" />\n        </div>\n      )}\n\n      {/* Content */}\n      <div className=\"relative z-10 flex flex-col h-full\">\n        {/* Header with Category Badge */}\n        <div className=\"flex items-center justify-between mb-2\">\n          <Badge \n            className={cn(\n              \"text-white font-medium bg-gradient-to-r\",\n              getCategoryColor(achievement.category),\n              sizeClasses.badge\n            )}\n          >\n            <span className=\"mr-1\">{getCategoryIcon(achievement.category)}</span>\n            {achievement.category}\n          </Badge>\n          \n          {achievement.isEarned && (\n            <div className=\"flex items-center gap-1\">\n              <CheckCircle className=\"w-4 h-4 text-green-500\" />\n              <span className=\"text-xs font-medium text-green-600 dark:text-green-400\">\n                Earned!\n              </span>\n            </div>\n          )}\n        </div>\n\n        {/* Icon */}\n        <div className=\"flex justify-center mb-3\">\n          <div className={cn(\n            \"relative\",\n            achievement.isEarned ? \"grayscale-0\" : \"grayscale opacity-50\"\n          )}>\n            <span className={sizeClasses.icon}>\n              {achievement.icon}\n            </span>\n            {!achievement.isEarned && (\n              <Lock className=\"absolute top-0 right-0 w-3 h-3 text-gray-400\" />\n            )}\n          </div>\n        </div>\n\n        {/* Title & Description */}\n        <div className=\"text-center mb-3 flex-grow\">\n          <h3 className={cn(\n            sizeClasses.title,\n            achievement.isEarned \n              ? \"text-gray-900 dark:text-white\" \n              : \"text-gray-500 dark:text-gray-400\"\n          )}>\n            {achievement.name}\n          </h3>\n          <p className={cn(\n            sizeClasses.description,\n            \"text-gray-600 dark:text-gray-300 mt-1 leading-relaxed\"\n          )}>\n            {achievement.description}\n          </p>\n        </div>\n\n        {/* Progress Section */}\n        {showProgress && !achievement.isEarned && (\n          <div className=\"mt-auto\">\n            <div className=\"flex items-center justify-between mb-1\">\n              <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n                Progress\n              </span>\n              <span className=\"text-xs font-medium text-gray-700 dark:text-gray-300\">\n                {achievement.progress}/{achievement.maxProgress}\n              </span>\n            </div>\n            <Progress \n              value={achievement.progressPercent} \n              className={cn(\"bg-gray-200 dark:bg-gray-700\", sizeClasses.progress)}\n            />\n            <div className=\"text-center mt-1\">\n              <span className=\"text-xs text-gray-500 dark:text-gray-400\">\n                {Math.round(achievement.progressPercent)}% complete\n              </span>\n            </div>\n          </div>\n        )}\n\n        {/* Points Badge */}\n        <div className=\"flex justify-center mt-3\">\n          <Badge variant=\"outline\" className=\"text-xs\">\n            <Trophy className=\"w-3 h-3 mr-1 text-yellow-500\" />\n            {achievement.points} pts\n          </Badge>\n        </div>\n\n        {/* Earned Date */}\n        {achievement.isEarned && achievement.earnedAt && (\n          <div className=\"text-center mt-2\">\n            <span className=\"text-xs text-gray-400\">\n              Earned {new Date(achievement.earnedAt).toLocaleDateString()}\n            </span>\n          </div>\n        )}\n      </div>\n\n      {/* Hover Effect Overlay */}\n      {isHovered && achievement.isEarned && (\n        <div className=\"absolute inset-0 bg-gradient-to-t from-transparent via-transparent to-white/10 dark:to-black/10 pointer-events-none\" />\n      )}\n    </Card>\n  );\n}","size_bytes":7776},"client/src/components/enhanced-feedback-modal.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Check, X, ExternalLink, BookOpen, Lightbulb, Loader2, Star, TrendingUp, Zap, Gem } from \"lucide-react\";\nimport { apiRequest } from \"@/lib/queryClient\";\nimport type { LearningMaterial } from \"@shared/schema\";\n\ninterface EnhancedFeedbackModalProps {\n  isVisible: boolean;\n  correct: boolean;\n  question: string;\n  answer: string;\n  value: number;\n  questionId: string;\n  userAssessment: \"correct\" | \"incorrect\" | \"unsure\";\n  onNext: () => void;\n}\n\nexport default function EnhancedFeedbackModal({ \n  isVisible, \n  correct, \n  question,\n  answer, \n  value, \n  questionId,\n  userAssessment,\n  onNext \n}: EnhancedFeedbackModalProps) {\n  const [showLearningMaterial, setShowLearningMaterial] = useState(false);\n\n  const processContent = (content: string) => {\n    return content.split('\\n').map((line, index) => {\n      const trimmed = line.trim();\n      \n      // Filter out unwanted sections\n      if (trimmed.toLowerCase().includes('why this is correct') || \n          trimmed.length < 10 || \n          trimmed.match(/^[A-Z][a-z]{1,4}$/) ||\n          trimmed.endsWith('...') ||\n          (trimmed.length < 50 && trimmed.split(' ').length < 5)) {\n        return null;\n      }\n      \n      // Handle bold headers\n      if (trimmed.startsWith('**') && trimmed.endsWith('**')) {\n        return <h4 key={index} className=\"font-semibold mt-3 mb-1 text-primary text-sm\">{trimmed.slice(2, -2)}</h4>;\n      } \n      // Handle bullet points with indentation\n      else if (trimmed.startsWith('‚Ä¢') || trimmed.startsWith('-')) {\n        return <li key={index} className=\"ml-6 mb-1 text-sm list-disc\">{trimmed.slice(1).trim()}</li>;\n      } \n      // Handle inline bold text\n      else if (trimmed.includes('**')) {\n        const parts = trimmed.split('**');\n        return (\n          <p key={index} className=\"mb-1 text-sm leading-snug\">\n            {parts.map((part, partIndex) => \n              partIndex % 2 === 1 ? \n                <strong key={partIndex} className=\"font-semibold\">{part}</strong> : \n                part\n            )}\n          </p>\n        );\n      } \n      // Regular text\n      else if (trimmed.length > 0) {\n        return <p key={index} className=\"mb-1 text-sm leading-snug\">{trimmed}</p>;\n      }\n      return null;\n    }).filter(Boolean);\n  };\n\n  const renderCommonnessIcon = (commonness: string | undefined) => {\n    switch (commonness) {\n      case 'very_common':\n        return <Star className=\"text-green-500\" size={14} />;\n      case 'common':\n        return <TrendingUp className=\"text-blue-500\" size={14} />;\n      case 'uncommon':\n        return <Zap className=\"text-orange-500\" size={14} />;\n      case 'rare':\n        return <Gem className=\"text-purple-500\" size={14} />;\n      default:\n        return <TrendingUp className=\"text-blue-500\" size={14} />;\n    }\n  };\n\n  // Generate learning material for incorrect/unsure answers\n  const generateLearningMutation = useMutation<LearningMaterial>({\n    mutationFn: async () => {\n      return apiRequest(\"POST\", \"/api/learning-materials\", {\n        questionId,\n        userWasCorrect: userAssessment === \"correct\"\n      });\n    },\n    onSuccess: () => {\n      // Invalidate and refetch the existing material query after successful generation\n      refetchExisting();\n    },\n  });\n\n  // Fetch existing learning material\n  const { data: existingMaterial, refetch: refetchExisting } = useQuery<LearningMaterial>({\n    queryKey: [`/api/learning-materials/${questionId}`],\n    enabled: false, // Don't auto-fetch, only when needed\n  });\n\n  const handleShowLearningMaterial = async () => {\n    setShowLearningMaterial(true);\n    \n    // Try to get existing material first\n    try {\n      const existing = await refetchExisting();\n      if (existing.data) {\n        return;\n      }\n    } catch (error) {\n      console.log('No existing material found, generating new one');\n    }\n    \n    // Generate new material if none exists\n    try {\n      await generateLearningMutation.mutateAsync();\n    } catch (error) {\n      console.error('Error generating learning material:', error);\n    }\n  };\n\n  const learningMaterial = existingMaterial || generateLearningMutation.data;\n  const isGenerating = generateLearningMutation.isPending;\n\n  if (!isVisible) return null;\n\n  return (\n    <div \n      className=\"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50\"\n      data-testid=\"enhanced-feedback-modal\"\n    >\n      <div className=\"max-h-[90vh] overflow-y-auto w-full max-w-2xl\">\n        <Card className=\"p-4 w-full shadow-xl\">\n        <div className=\"text-center mb-6\">\n          <div className={`w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 ${\n            correct ? 'bg-accent' : 'bg-destructive'\n          }`}>\n            {correct ? (\n              <Check className=\"text-2xl text-accent-foreground\" data-testid=\"icon-correct\" />\n            ) : (\n              <X className=\"text-2xl text-destructive-foreground\" data-testid=\"icon-incorrect\" />\n            )}\n          </div>\n          <h3 className=\"text-lg font-bold mb-2\" data-testid=\"text-feedback-title\">\n            {correct ? 'Correct!' : userAssessment === \"incorrect\" ? 'Incorrect' : 'Learning Opportunity'}\n          </h3>\n          {correct && (\n            <p className=\"text-muted-foreground mb-4\" data-testid=\"text-points-earned\">\n              You earned ${value}\n            </p>\n          )}\n          <div className=\"text-sm text-muted-foreground mb-4\">\n            <strong>Answer:</strong> <span data-testid=\"text-correct-answer\">{answer}</span>\n          </div>\n        </div>\n\n        {/* Learning Material Section for incorrect/unsure answers */}\n        {(userAssessment === \"incorrect\" || userAssessment === \"unsure\") && (\n          <div className=\"mb-6\">\n            {!showLearningMaterial ? (\n              <div className=\"text-center\">\n                <Button\n                  onClick={handleShowLearningMaterial}\n                  variant=\"outline\"\n                  className=\"mb-4\"\n                  data-testid=\"button-show-explanation\"\n                >\n                  <BookOpen className=\"mr-2\" size={16} />\n                  Get Detailed Explanation\n                </Button>\n                <p className=\"text-sm text-muted-foreground\">\n                  Learn more about this topic with expert explanations and related facts\n                </p>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                <Separator />\n                \n                {isGenerating ? (\n                  <div className=\"flex items-center justify-center py-8\">\n                    <Loader2 className=\"mr-2 animate-spin\" size={20} />\n                    <span>Generating detailed explanation...</span>\n                  </div>\n                ) : learningMaterial ? (\n                  <div className=\"space-y-4\">\n                    <div className=\"flex items-center justify-between\">\n                      <div className=\"flex items-center\">\n                        <Lightbulb className=\"mr-2 text-primary\" size={20} />\n                        <h4 className=\"font-semibold\">Learning Materials</h4>\n                      </div>\n                      <div className=\"flex items-center space-x-2\">\n                        {renderCommonnessIcon(learningMaterial.commonness)}\n                        <span className=\"text-xs text-muted-foreground capitalize\">\n                          {learningMaterial.commonness?.replace('_', ' ') || 'common'} topic\n                        </span>\n                      </div>\n                    </div>\n                    \n                    {/* Question and Answer Context */}\n                    <div className=\"bg-muted/30 p-3 rounded-lg mb-4\">\n                      <div className=\"text-sm\">\n                        <p className=\"font-medium mb-1 text-primary\">Question:</p>\n                        <p className=\"mb-2\">{question}</p>\n                        <p className=\"font-medium mb-1 text-primary\">Answer:</p>\n                        <p className=\"font-semibold\">{answer}</p>\n                      </div>\n                    </div>\n\n                    {/* Explanation */}\n                    <div className=\"bg-muted/50 p-4 rounded-lg\">\n                      <h5 className=\"font-medium mb-2\">Learning Material</h5>\n                      <div className=\"text-sm prose prose-sm max-w-none\" data-testid=\"text-explanation\">\n                        {processContent(learningMaterial.explanation || '')}\n                      </div>\n                    </div>\n\n                    {/* Related Facts */}\n                    {learningMaterial.relatedFacts && learningMaterial.relatedFacts.length > 0 && (\n                      <div>\n                        <h5 className=\"font-medium mb-2\">Related Trivia Facts</h5>\n                        <div className=\"space-y-2\">\n                          {learningMaterial.relatedFacts\n                            .filter(fact => {\n                              const trimmed = fact.trim();\n                              return trimmed.length >= 10 && \n                                     !trimmed.toLowerCase().includes('why this is correct') &&\n                                     !trimmed.endsWith('...') &&\n                                     !(trimmed.length < 50 && trimmed.split(' ').length < 5);\n                            })\n                            .map((fact, index) => (\n                            <div key={index} className=\"bg-muted/30 p-2 rounded text-sm\" data-testid={`related-fact-${index}`}>\n                              <span className=\"inline-block w-1.5 h-1.5 bg-primary rounded-full mr-2\"></span>\n                              <div className=\"inline\">\n                                {fact.includes('**') ? (\n                                  fact.split('**').map((part, partIndex) => \n                                    partIndex % 2 === 1 ? \n                                      <strong key={partIndex} className=\"font-semibold\">{part}</strong> : \n                                      part\n                                  )\n                                ) : fact}\n                              </div>\n                            </div>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n\n                    {/* Sources */}\n                    {learningMaterial.sources && learningMaterial.sources.length > 0 && (\n                      <div>\n                        <h5 className=\"font-medium mb-2\">Sources</h5>\n                        <div className=\"flex flex-wrap gap-2\">\n                          {learningMaterial.sources.map((source, index) => (\n                            <Badge key={index} variant=\"outline\" className=\"text-xs\" data-testid={`source-${index}`}>\n                              <ExternalLink size={12} className=\"mr-1\" />\n                              <a \n                                href={source} \n                                target=\"_blank\" \n                                rel=\"noopener noreferrer\"\n                                className=\"hover:underline\"\n                              >\n                                Source {index + 1}\n                              </a>\n                            </Badge>\n                          ))}\n                        </div>\n                      </div>\n                    )}\n                  </div>\n                ) : (\n                  <div className=\"text-center py-4 text-muted-foreground\">\n                    <p>Unable to generate learning materials at this time.</p>\n                  </div>\n                )}\n              </div>\n            )}\n          </div>\n        )}\n\n        <Button\n          onClick={onNext}\n          className=\"w-full bg-primary text-primary-foreground hover:bg-primary/90\"\n          data-testid=\"button-next-question\"\n        >\n          Continue\n        </Button>\n        </Card>\n      </div>\n    </div>\n  );\n}","size_bytes":12228},"client/src/lib/spaced-repetition.ts":{"content":"export interface SpacedRepetitionCard {\n  id: string;\n  easeFactor: number;\n  interval: number;\n  repetitions: number;\n  nextReview: Date;\n  lastReviewed?: Date;\n}\n\nexport interface ReviewResult {\n  quality: number; // 0-5 scale (0 = complete blackout, 5 = perfect response)\n}\n\n/**\n * SuperMemo SM-2 Algorithm Implementation\n * \n * @param card - Current spaced repetition data\n * @param result - Review result with quality rating\n * @returns Updated spaced repetition data\n */\nexport function updateSpacedRepetition(\n  card: SpacedRepetitionCard,\n  result: ReviewResult\n): SpacedRepetitionCard {\n  const { quality } = result;\n  let { easeFactor, interval, repetitions } = card;\n\n  // If quality < 3, restart the card\n  if (quality < 3) {\n    repetitions = 0;\n    interval = 1;\n  } else {\n    repetitions += 1;\n    \n    // Calculate new interval\n    if (repetitions === 1) {\n      interval = 1;\n    } else if (repetitions === 2) {\n      interval = 6;\n    } else {\n      interval = Math.round(interval * easeFactor);\n    }\n  }\n\n  // Update ease factor\n  easeFactor = easeFactor + (0.1 - (5 - quality) * (0.08 + (5 - quality) * 0.02));\n  \n  // Ensure ease factor doesn't go below 1.3\n  easeFactor = Math.max(1.3, easeFactor);\n\n  // Calculate next review date\n  const nextReview = new Date();\n  nextReview.setDate(nextReview.getDate() + interval);\n\n  return {\n    ...card,\n    easeFactor,\n    interval,\n    repetitions,\n    nextReview,\n    lastReviewed: new Date(),\n  };\n}\n\n/**\n * Convert answer correctness to quality score\n * \n * @param correct - Whether the answer was correct\n * @param timeSpent - Time taken to answer (in seconds)\n * @param timeLimit - Maximum time allowed (in seconds)\n * @returns Quality score (0-5)\n */\nexport function calculateQuality(\n  correct: boolean,\n  timeSpent: number,\n  timeLimit: number = 30\n): number {\n  if (!correct) {\n    return timeSpent > timeLimit ? 0 : 1; // Complete failure or hesitant failure\n  }\n\n  // For correct answers, factor in response time\n  const timeRatio = timeSpent / timeLimit;\n  \n  if (timeRatio <= 0.3) return 5; // Perfect response (< 30% of time)\n  if (timeRatio <= 0.5) return 4; // Good response (< 50% of time)\n  if (timeRatio <= 0.8) return 3; // Acceptable response (< 80% of time)\n  return 3; // Slow but correct response\n}\n\n/**\n * Get cards due for review\n * \n * @param cards - All spaced repetition cards\n * @param limit - Maximum number of cards to return\n * @returns Cards due for review, sorted by priority\n */\nexport function getCardsForReview(\n  cards: SpacedRepetitionCard[],\n  limit: number = 20\n): SpacedRepetitionCard[] {\n  const now = new Date();\n  \n  return cards\n    .filter(card => card.nextReview <= now)\n    .sort((a, b) => {\n      // Prioritize by overdue time and difficulty (lower ease factor = more difficult)\n      const aOverdue = now.getTime() - a.nextReview.getTime();\n      const bOverdue = now.getTime() - b.nextReview.getTime();\n      const aDifficulty = 1 / a.easeFactor;\n      const bDifficulty = 1 / b.easeFactor;\n      \n      // Combine overdue time and difficulty for priority scoring\n      const aScore = aOverdue + (aDifficulty * 1000000); // Weight difficulty heavily\n      const bScore = bOverdue + (bDifficulty * 1000000);\n      \n      return bScore - aScore; // Descending order (highest priority first)\n    })\n    .slice(0, limit);\n}\n\n/**\n * Calculate study statistics\n * \n * @param cards - All spaced repetition cards\n * @returns Study statistics\n */\nexport function getStudyStats(cards: SpacedRepetitionCard[]) {\n  const now = new Date();\n  const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());\n  const tomorrow = new Date(today);\n  tomorrow.setDate(tomorrow.getDate() + 1);\n  const nextWeek = new Date(today);\n  nextWeek.setDate(nextWeek.getDate() + 7);\n\n  const dueToday = cards.filter(card => card.nextReview <= tomorrow).length;\n  const dueTomorrow = cards.filter(card => \n    card.nextReview > tomorrow && card.nextReview <= new Date(tomorrow.getTime() + 24 * 60 * 60 * 1000)\n  ).length;\n  const dueThisWeek = cards.filter(card => \n    card.nextReview > tomorrow && card.nextReview <= nextWeek\n  ).length;\n\n  return {\n    dueToday,\n    dueTomorrow,\n    dueThisWeek,\n    totalCards: cards.length,\n  };\n}\n","size_bytes":4236},"client/src/components/ui/sidebar.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { VariantProps, cva } from \"class-variance-authority\"\nimport { PanelLeft } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nconst SidebarProvider = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    defaultOpen?: boolean\n    open?: boolean\n    onOpenChange?: (open: boolean) => void\n  }\n>(\n  (\n    {\n      defaultOpen = true,\n      open: openProp,\n      onOpenChange: setOpenProp,\n      className,\n      style,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const isMobile = useIsMobile()\n    const [openMobile, setOpenMobile] = React.useState(false)\n\n    // This is the internal state of the sidebar.\n    // We use openProp and setOpenProp for control from outside the component.\n    const [_open, _setOpen] = React.useState(defaultOpen)\n    const open = openProp ?? _open\n    const setOpen = React.useCallback(\n      (value: boolean | ((value: boolean) => boolean)) => {\n        const openState = typeof value === \"function\" ? value(open) : value\n        if (setOpenProp) {\n          setOpenProp(openState)\n        } else {\n          _setOpen(openState)\n        }\n\n        // This sets the cookie to keep the sidebar state.\n        document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n      },\n      [setOpenProp, open]\n    )\n\n    // Helper to toggle the sidebar.\n    const toggleSidebar = React.useCallback(() => {\n      return isMobile\n        ? setOpenMobile((open) => !open)\n        : setOpen((open) => !open)\n    }, [isMobile, setOpen, setOpenMobile])\n\n    // Adds a keyboard shortcut to toggle the sidebar.\n    React.useEffect(() => {\n      const handleKeyDown = (event: KeyboardEvent) => {\n        if (\n          event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n          (event.metaKey || event.ctrlKey)\n        ) {\n          event.preventDefault()\n          toggleSidebar()\n        }\n      }\n\n      window.addEventListener(\"keydown\", handleKeyDown)\n      return () => window.removeEventListener(\"keydown\", handleKeyDown)\n    }, [toggleSidebar])\n\n    // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n    // This makes it easier to style the sidebar with Tailwind classes.\n    const state = open ? \"expanded\" : \"collapsed\"\n\n    const contextValue = React.useMemo<SidebarContextProps>(\n      () => ({\n        state,\n        open,\n        setOpen,\n        isMobile,\n        openMobile,\n        setOpenMobile,\n        toggleSidebar,\n      }),\n      [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n    )\n\n    return (\n      <SidebarContext.Provider value={contextValue}>\n        <TooltipProvider delayDuration={0}>\n          <div\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH,\n                \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n                ...style,\n              } as React.CSSProperties\n            }\n            className={cn(\n              \"group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar\",\n              className\n            )}\n            ref={ref}\n            {...props}\n          >\n            {children}\n          </div>\n        </TooltipProvider>\n      </SidebarContext.Provider>\n    )\n  }\n)\nSidebarProvider.displayName = \"SidebarProvider\"\n\nconst Sidebar = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    side?: \"left\" | \"right\"\n    variant?: \"sidebar\" | \"floating\" | \"inset\"\n    collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n  }\n>(\n  (\n    {\n      side = \"left\",\n      variant = \"sidebar\",\n      collapsible = \"offcanvas\",\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n    if (collapsible === \"none\") {\n      return (\n        <div\n          className={cn(\n            \"flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground\",\n            className\n          )}\n          ref={ref}\n          {...props}\n        >\n          {children}\n        </div>\n      )\n    }\n\n    if (isMobile) {\n      return (\n        <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n          <SheetContent\n            data-sidebar=\"sidebar\"\n            data-mobile=\"true\"\n            className=\"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden\"\n            style={\n              {\n                \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n              } as React.CSSProperties\n            }\n            side={side}\n          >\n            <SheetHeader className=\"sr-only\">\n              <SheetTitle>Sidebar</SheetTitle>\n              <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n            </SheetHeader>\n            <div className=\"flex h-full w-full flex-col\">{children}</div>\n          </SheetContent>\n        </Sheet>\n      )\n    }\n\n    return (\n      <div\n        ref={ref}\n        className=\"group peer hidden text-sidebar-foreground md:block\"\n        data-state={state}\n        data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n        data-variant={variant}\n        data-side={side}\n      >\n        {/* This is what handles the sidebar gap on desktop */}\n        <div\n          className={cn(\n            \"relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear\",\n            \"group-data-[collapsible=offcanvas]:w-0\",\n            \"group-data-[side=right]:rotate-180\",\n            variant === \"floating\" || variant === \"inset\"\n              ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon]\"\n          )}\n        />\n        <div\n          className={cn(\n            \"fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex\",\n            side === \"left\"\n              ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n              : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n            // Adjust the padding for floating and inset variants.\n            variant === \"floating\" || variant === \"inset\"\n              ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]\"\n              : \"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n            className\n          )}\n          {...props}\n        >\n          <div\n            data-sidebar=\"sidebar\"\n            className=\"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow\"\n          >\n            {children}\n          </div>\n        </div>\n      </div>\n    )\n  }\n)\nSidebar.displayName = \"Sidebar\"\n\nconst SidebarTrigger = React.forwardRef<\n  React.ElementRef<typeof Button>,\n  React.ComponentProps<typeof Button>\n>(({ className, onClick, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      ref={ref}\n      data-sidebar=\"trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeft />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n})\nSidebarTrigger.displayName = \"SidebarTrigger\"\n\nconst SidebarRail = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\">\n>(({ className, ...props }, ref) => {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <button\n      ref={ref}\n      data-sidebar=\"rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex\",\n        \"[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarRail.displayName = \"SidebarRail\"\n\nconst SidebarInset = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"main\">\n>(({ className, ...props }, ref) => {\n  return (\n    <main\n      ref={ref}\n      className={cn(\n        \"relative flex w-full flex-1 flex-col bg-background\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInset.displayName = \"SidebarInset\"\n\nconst SidebarInput = React.forwardRef<\n  React.ElementRef<typeof Input>,\n  React.ComponentProps<typeof Input>\n>(({ className, ...props }, ref) => {\n  return (\n    <Input\n      ref={ref}\n      data-sidebar=\"input\"\n      className={cn(\n        \"h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarInput.displayName = \"SidebarInput\"\n\nconst SidebarHeader = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarHeader.displayName = \"SidebarHeader\"\n\nconst SidebarFooter = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarFooter.displayName = \"SidebarFooter\"\n\nconst SidebarSeparator = React.forwardRef<\n  React.ElementRef<typeof Separator>,\n  React.ComponentProps<typeof Separator>\n>(({ className, ...props }, ref) => {\n  return (\n    <Separator\n      ref={ref}\n      data-sidebar=\"separator\"\n      className={cn(\"mx-2 w-auto bg-sidebar-border\", className)}\n      {...props}\n    />\n  )\n})\nSidebarSeparator.displayName = \"SidebarSeparator\"\n\nconst SidebarContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarContent.displayName = \"SidebarContent\"\n\nconst SidebarGroup = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => {\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n})\nSidebarGroup.displayName = \"SidebarGroup\"\n\nconst SidebarGroupLabel = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupLabel.displayName = \"SidebarGroupLabel\"\n\nconst SidebarGroupAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & { asChild?: boolean }\n>(({ className, asChild = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarGroupAction.displayName = \"SidebarGroupAction\"\n\nconst SidebarGroupContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"group-content\"\n    className={cn(\"w-full text-sm\", className)}\n    {...props}\n  />\n))\nSidebarGroupContent.displayName = \"SidebarGroupContent\"\n\nconst SidebarMenu = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu\"\n    className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n    {...props}\n  />\n))\nSidebarMenu.displayName = \"SidebarMenu\"\n\nconst SidebarMenuItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    data-sidebar=\"menu-item\"\n    className={cn(\"group/menu-item relative\", className)}\n    {...props}\n  />\n))\nSidebarMenuItem.displayName = \"SidebarMenuItem\"\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:!p-0\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst SidebarMenuButton = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    isActive?: boolean\n    tooltip?: string | React.ComponentProps<typeof TooltipContent>\n  } & VariantProps<typeof sidebarMenuButtonVariants>\n>(\n  (\n    {\n      asChild = false,\n      isActive = false,\n      variant = \"default\",\n      size = \"default\",\n      tooltip,\n      className,\n      ...props\n    },\n    ref\n  ) => {\n    const Comp = asChild ? Slot : \"button\"\n    const { isMobile, state } = useSidebar()\n\n    const button = (\n      <Comp\n        ref={ref}\n        data-sidebar=\"menu-button\"\n        data-size={size}\n        data-active={isActive}\n        className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n        {...props}\n      />\n    )\n\n    if (!tooltip) {\n      return button\n    }\n\n    if (typeof tooltip === \"string\") {\n      tooltip = {\n        children: tooltip,\n      }\n    }\n\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\n        <TooltipContent\n          side=\"right\"\n          align=\"center\"\n          hidden={state !== \"collapsed\" || isMobile}\n          {...tooltip}\n        />\n      </Tooltip>\n    )\n  }\n)\nSidebarMenuButton.displayName = \"SidebarMenuButton\"\n\nconst SidebarMenuAction = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<\"button\"> & {\n    asChild?: boolean\n    showOnHover?: boolean\n  }\n>(({ className, asChild = false, showOnHover = false, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 after:md:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuAction.displayName = \"SidebarMenuAction\"\n\nconst SidebarMenuBadge = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\">\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    data-sidebar=\"menu-badge\"\n    className={cn(\n      \"pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground\",\n      \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n      \"peer-data-[size=sm]/menu-button:top-1\",\n      \"peer-data-[size=default]/menu-button:top-1.5\",\n      \"peer-data-[size=lg]/menu-button:top-2.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuBadge.displayName = \"SidebarMenuBadge\"\n\nconst SidebarMenuSkeleton = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    showIcon?: boolean\n  }\n>(({ className, showIcon = false, ...props }, ref) => {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      ref={ref}\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[--skeleton-width] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n})\nSidebarMenuSkeleton.displayName = \"SidebarMenuSkeleton\"\n\nconst SidebarMenuSub = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    data-sidebar=\"menu-sub\"\n    className={cn(\n      \"mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5\",\n      \"group-data-[collapsible=icon]:hidden\",\n      className\n    )}\n    {...props}\n  />\n))\nSidebarMenuSub.displayName = \"SidebarMenuSub\"\n\nconst SidebarMenuSubItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ ...props }, ref) => <li ref={ref} {...props} />)\nSidebarMenuSubItem.displayName = \"SidebarMenuSubItem\"\n\nconst SidebarMenuSubButton = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentProps<\"a\"> & {\n    asChild?: boolean\n    size?: \"sm\" | \"md\"\n    isActive?: boolean\n  }\n>(({ asChild = false, size = \"md\", isActive, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nSidebarMenuSubButton.displayName = \"SidebarMenuSubButton\"\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","size_bytes":23567},"client/src/components/header.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Target, GraduationCap, User, LogOut, ChevronDown } from \"lucide-react\";\nimport NotificationCenter from \"@/components/notification-center\";\nimport StreakIndicator from \"@/components/streak-indicator\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport { cn } from \"@/lib/utils\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuSeparator,\n  DropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport type { ReadinessScore, GamificationStats } from \"@shared/schema\";\n\nexport default function Header() {\n  const { user, isLoading: authLoading } = useAuth();\n  \n  const { data: readinessData } = useQuery<ReadinessScore>({\n    queryKey: [\"/api/readiness\"],\n  });\n\n  const { data: overallStats } = useQuery<{\n    totalQuestions: number;\n    overallAccuracy: number;\n    currentStreak: number;\n    totalStudyTime: number;\n  }>({\n    queryKey: [\"/api/stats/overall\"],\n  });\n\n  const { data: gamificationStats } = useQuery<GamificationStats>({\n    queryKey: [\"/api/gamification-stats\"],\n  });\n\n  const getGradeColor = (grade: string, score: number) => {\n    if (score >= 90) return \"from-green-500 to-emerald-600\";\n    if (score >= 80) return \"from-blue-500 to-cyan-600\";\n    if (score >= 70) return \"from-yellow-500 to-orange-500\";\n    if (score >= 60) return \"from-orange-500 to-red-500\";\n    return \"from-red-500 to-pink-500\";\n  };\n\n  const score = readinessData?.overallScore || 0;\n  const grade = readinessData?.letterGrade || \"F\";\n\n  const handleLogout = () => {\n    window.location.href = \"/api/logout\";\n  };\n\n  const getUserInitials = (firstName?: string | null, lastName?: string | null, email?: string | null) => {\n    if (firstName && lastName) {\n      return `${firstName.charAt(0)}${lastName.charAt(0)}`.toUpperCase();\n    }\n    if (firstName) {\n      return firstName.charAt(0).toUpperCase();\n    }\n    if (email) {\n      return email.charAt(0).toUpperCase();\n    }\n    return \"U\";\n  };\n\n  return (\n    <header className=\"sticky top-0 z-30 bg-white/95 dark:bg-gray-900/95 backdrop-blur-sm border-b border-gray-200 dark:border-gray-700\">\n      <div className=\"px-4 py-3\">\n        <div className=\"flex items-center justify-between\">\n          {/* Left: App Title and Readiness */}\n          <div className=\"flex items-center gap-4\">\n            {/* App Icon & Title */}\n            <div className=\"flex items-center gap-2\">\n              <div className=\"p-2 bg-gradient-to-br from-blue-500 to-purple-600 rounded-lg\">\n                <GraduationCap className=\"w-5 h-5 text-white\" />\n              </div>\n              <div className=\"hidden sm:block\">\n                <h1 className=\"text-lg font-bold text-gray-900 dark:text-white\">\n                  The Daily Double Down\n                </h1>\n                <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                  Train for Trivia Excellence\n                </p>\n              </div>\n            </div>\n\n            {/* Readiness Score - Compact */}\n            <div className=\"flex items-center gap-3 bg-gradient-to-r from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-700 rounded-full px-3 py-2 border\">\n              <Target className=\"w-4 h-4 text-primary\" />\n              \n              {/* Score with Grade */}\n              <div className=\"flex items-center gap-2\">\n                <div className={cn(\n                  \"px-3 py-1 rounded-full text-sm font-bold text-white bg-gradient-to-r\",\n                  getGradeColor(grade, score)\n                )}>\n                  {grade}\n                </div>\n                <div className=\"text-sm\">\n                  <span className=\"font-semibold text-gray-900 dark:text-white\">\n                    {score.toFixed(1)}%\n                  </span>\n                  <span className=\"text-gray-500 dark:text-gray-400 ml-1\">\n                    Ready\n                  </span>\n                </div>\n              </div>\n\n              {/* Status Indicator */}\n              <div className={cn(\n                \"w-2 h-2 rounded-full\",\n                score >= 80 ? \"bg-green-500 animate-pulse\" : \n                score >= 70 ? \"bg-yellow-500\" : \"bg-red-500\"\n              )} />\n            </div>\n          </div>\n\n          {/* Right: Stats and Notification */}\n          <div className=\"flex items-center gap-3\">\n            {/* Quick Stats */}\n            <div className=\"hidden md:flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400\">\n              {/* Enhanced Streak Indicator */}\n              {overallStats?.currentStreak !== undefined && (\n                <StreakIndicator\n                  streakValue={overallStats.currentStreak}\n                  streakType=\"daily\"\n                  goalProgress={gamificationStats?.streakInfo.goalProgress || 0}\n                  size=\"small\"\n                  animated={true}\n                  showProgress={false}\n                  showLabel={false}\n                  className=\"hover:scale-110 transition-transform\"\n                />\n              )}\n              \n              {overallStats?.totalQuestions && overallStats.totalQuestions > 0 && (\n                <div className=\"flex items-center gap-1\">\n                  <span className=\"text-blue-500\">üìù</span>\n                  <span className=\"font-medium\">{overallStats.totalQuestions}</span>\n                </div>\n              )}\n              \n              {overallStats?.overallAccuracy && overallStats.overallAccuracy > 0 && (\n                <div className=\"flex items-center gap-1\">\n                  <span className=\"text-green-500\">‚úÖ</span>\n                  <span className=\"font-medium\">{overallStats.overallAccuracy.toFixed(0)}%</span>\n                </div>\n              )}\n            </div>\n\n            {/* User Profile & Notification Center */}\n            <div className=\"flex items-center gap-3\">\n              {user && <NotificationCenter />}\n              \n              {/* User Profile Dropdown or Sign In Button */}\n              {user ? (\n                <DropdownMenu>\n                  <DropdownMenuTrigger className=\"flex items-center gap-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg px-2 py-1 transition-colors\" data-testid=\"dropdown-user-profile\">\n                    <Avatar className=\"w-8 h-8\">\n                      <AvatarImage src={user.profileImageUrl || undefined} alt={user.firstName && user.lastName ? `${user.firstName} ${user.lastName}` : user.email || \"User\"} />\n                      <AvatarFallback className=\"bg-blue-500 text-white text-sm font-medium\">\n                        {getUserInitials(user.firstName, user.lastName, user.email)}\n                      </AvatarFallback>\n                    </Avatar>\n                    <div className=\"hidden sm:block text-left\">\n                      <p className=\"text-sm font-medium text-gray-900 dark:text-white\" data-testid=\"text-username\">\n                        {user.firstName && user.lastName ? `${user.firstName} ${user.lastName}` : user.email || \"User\"}\n                      </p>\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400\" data-testid=\"text-email\">\n                        {user.email}\n                      </p>\n                    </div>\n                    <ChevronDown className=\"w-4 h-4 text-gray-500\" />\n                  </DropdownMenuTrigger>\n                  <DropdownMenuContent align=\"end\" className=\"w-56\">\n                    <DropdownMenuItem className=\"flex items-center gap-2\" data-testid=\"menu-profile\">\n                      <User className=\"w-4 h-4\" />\n                      Profile Settings\n                    </DropdownMenuItem>\n                    <DropdownMenuSeparator />\n                    <DropdownMenuItem \n                      className=\"flex items-center gap-2 text-red-600 dark:text-red-400\" \n                      onClick={handleLogout}\n                      data-testid=\"button-logout\"\n                    >\n                      <LogOut className=\"w-4 h-4\" />\n                      Sign Out\n                    </DropdownMenuItem>\n                  </DropdownMenuContent>\n                </DropdownMenu>\n              ) : (\n                <button\n                  onClick={() => window.location.href = \"/api/login\"}\n                  className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg transition-colors text-sm font-medium\"\n                  data-testid=\"button-login\"\n                >\n                  <User className=\"w-4 h-4\" />\n                  <span className=\"hidden sm:inline\">Sign In</span>\n                </button>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n    </header>\n  );\n}","size_bytes":8803},"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","size_bytes":1251},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","size_bytes":791},"server/db.ts":{"content":"import { Pool, neonConfig } from '@neondatabase/serverless';\nimport { drizzle } from 'drizzle-orm/neon-serverless';\nimport ws from \"ws\";\nimport * as schema from \"@shared/schema\";\n\nneonConfig.webSocketConstructor = ws;\n\nif (!process.env.DATABASE_URL) {\n  const error = new Error(\"DATABASE_URL must be set. Did you forget to provision a database?\");\n  console.error(\"üí• DATABASE ERROR:\", error.message);\n  console.error(\"Available env vars:\", Object.keys(process.env).filter(k => k.includes('DB') || k.includes('DATABASE')));\n  throw error;\n}\n\nconsole.log(\"üì¶ Initializing database connection...\");\nconsole.log(\"Database URL configured:\", process.env.DATABASE_URL.replace(/:[^:@]+@/, ':****@'));\n\nlet pool: Pool;\nlet db: ReturnType<typeof drizzle>;\n\ntry {\n  pool = new Pool({ \n    connectionString: process.env.DATABASE_URL,\n    connectionTimeoutMillis: 10000,\n  });\n  \n  db = drizzle({ client: pool, schema });\n  console.log(\"‚úÖ Database connection initialized\");\n} catch (error) {\n  console.error(\"üí• Failed to initialize database:\", error);\n  throw error;\n}\n\nexport { pool, db };\n","size_bytes":1088},"server/storage.ts":{"content":"import { \n  type Category, \n  type Question, \n  type UserProgress, \n  type SpacedRepetition,\n  type LearningMaterial,\n  type StudyMaterial,\n  type TestAttempt,\n  type Achievement,\n  type UserAchievement,\n  type Notification,\n  type UserGoals,\n  type CategoryMastery,\n  type InsertCategory,\n  type InsertQuestion,\n  type InsertUserProgress,\n  type InsertSpacedRepetition,\n  type InsertLearningMaterial,\n  type InsertStudyMaterial,\n  type InsertTestAttempt,\n  type InsertAchievement,\n  type InsertUserAchievement,\n  type InsertNotification,\n  type InsertUserGoals,\n  type InsertCategoryMastery,\n  type QuestionWithCategory,\n  type QuestionWithLearning,\n  type StudyReview,\n  type CategoryStats,\n  type DailyStats,\n  type ReadinessScore,\n  type StreakInfo,\n  type AchievementWithProgress,\n  type GamificationStats,\n  type NotificationWithAction,\n  type User,\n  type UpsertUser\n} from \"@shared/schema\";\nimport { randomUUID } from \"crypto\";\nimport { openTDBClient } from \"./opentdb\";\nimport { calculateTimeDecayWeight, calculateWeightedCorrectScore, determineMasteryLevel, calculateCategoryMasteryScore, calculateBreadthScore, calculateOverallReadiness } from \"./utils/mastery-calculations\";\n\nexport interface IStorage {\n  // User operations (IMPORTANT) - mandatory for Replit Auth\n  getUser(id: string): Promise<User | undefined>;\n  upsertUser(user: UpsertUser): Promise<User>;\n  \n  // Categories\n  getCategories(): Promise<Category[]>;\n  createCategory(category: InsertCategory): Promise<Category>;\n  \n  // Questions\n  getQuestions(): Promise<Question[]>;\n  getQuestionsByCategory(categoryId: string): Promise<Question[]>;\n  getRandomQuestionsByCategory(categoryId: string, value: number): Promise<Question[]>;\n  getQuestion(id: string): Promise<QuestionWithCategory | undefined>;\n  createQuestion(question: InsertQuestion): Promise<Question>;\n  getQuestionByValue(categoryId: string, value: number): Promise<QuestionWithCategory | undefined>;\n  getRapidFireQuestions(limit?: number, categoryIds?: string[]): Promise<QuestionWithCategory[]>;\n  getAnsweredQuestions(userId?: string, mode?: \"game\" | \"rapid_fire\" | \"anytime_test\"): Promise<{ questionId: string; assessment: \"correct\" | \"incorrect\" | \"unsure\" }[]>;\n  clearProgress(userId?: string): Promise<void>;\n  resetGameBoard(userId?: string): Promise<void>;\n  \n  // User Progress\n  getUserProgress(userId?: string): Promise<UserProgress[]>;\n  createUserProgress(progress: InsertUserProgress): Promise<UserProgress>;\n  getUserProgressByCategory(categoryId: string, userId?: string): Promise<UserProgress[]>;\n  \n  // Spaced Repetition\n  getSpacedRepetitionData(): Promise<SpacedRepetition[]>;\n  getSpacedRepetitionForQuestion(questionId: string): Promise<SpacedRepetition | undefined>;\n  createSpacedRepetition(data: InsertSpacedRepetition): Promise<SpacedRepetition>;\n  updateSpacedRepetition(id: string, data: Partial<SpacedRepetition>): Promise<SpacedRepetition>;\n  getQuestionsForReview(limit?: number): Promise<QuestionWithCategory[]>;\n  \n  // Learning Materials\n  getLearningMaterial(questionId: string): Promise<LearningMaterial | undefined>;\n  createLearningMaterial(material: InsertLearningMaterial): Promise<LearningMaterial>;\n  getStudyReview(): Promise<StudyReview>;\n  \n  // Study Materials  \n  getStudyMaterials(): Promise<StudyMaterial[]>;\n  getStudyMaterialsByCategory(category: string): Promise<StudyMaterial[]>;\n  createStudyMaterial(material: InsertStudyMaterial): Promise<StudyMaterial>;\n  \n  // Test Attempts\n  createTestAttempt(attempt: InsertTestAttempt): Promise<TestAttempt>;\n  getTestAttempts(mode?: \"anytime_test\"): Promise<TestAttempt[]>;\n  getAnytimeTestSet(userId?: string): Promise<QuestionWithCategory[]>;\n  \n  // Readiness Calculation\n  getReadinessScore(): Promise<ReadinessScore>;\n  \n  // Category Mastery Tracking\n  getCategoryMasteryRecords(userId?: string): Promise<CategoryMastery[]>;\n  updateCategoryMastery(userId: string, categoryName: string, isCorrect: boolean, answeredAt: Date): Promise<CategoryMastery>;\n  \n  // Statistics\n  getCategoryStats(userId?: string): Promise<CategoryStats[]>;\n  getDailyStats(days: number, userId?: string): Promise<DailyStats[]>;\n  getOverallStats(userId?: string): Promise<{\n    totalQuestions: number;\n    overallAccuracy: number;\n    currentStreak: number;\n    totalStudyTime: number;\n  }>;\n\n  // Gamification - Achievements\n  getAchievements(): Promise<Achievement[]>;\n  createAchievement(achievement: InsertAchievement): Promise<Achievement>;\n  getUserAchievements(userId?: string): Promise<UserAchievement[]>;\n  getUserAchievementByKey(key: string, userId?: string): Promise<UserAchievement | undefined>;\n  createUserAchievement(userAchievement: InsertUserAchievement): Promise<UserAchievement>;\n  updateUserAchievement(id: string, data: Partial<UserAchievement>): Promise<UserAchievement>;\n  getAchievementsWithProgress(userId?: string): Promise<AchievementWithProgress[]>;\n  awardAchievement(achievementKey: string, progress?: number, userId?: string): Promise<{ achievement: Achievement; notification: Notification } | null>;\n\n  // Gamification - Notifications\n  getNotifications(unreadOnly?: boolean, userId?: string): Promise<NotificationWithAction[]>;\n  createNotification(notification: InsertNotification): Promise<Notification>;\n  markNotificationRead(id: string, userId?: string): Promise<void>;\n  getUnreadNotificationCount(userId?: string): Promise<number>;\n\n  // Gamification - Goals and Streaks\n  getUserGoals(userId?: string): Promise<UserGoals>;\n  updateUserGoals(goals: Partial<InsertUserGoals>, userId?: string): Promise<UserGoals>;\n  getStreakInfo(userId?: string): Promise<StreakInfo>;\n  getGamificationStats(userId?: string): Promise<GamificationStats>;\n\n  // Achievement Detection\n  checkAndAwardAchievements(progressData: UserProgress): Promise<Notification[]>;\n  evaluateAchievements(): Promise<void>;\n}\n\nexport class MemStorage implements IStorage {\n  private users: Map<string, User> = new Map();\n  private categories: Map<string, Category> = new Map();\n  private questions: Map<string, Question> = new Map();\n  private userProgress: Map<string, UserProgress> = new Map();\n  private spacedRepetition: Map<string, SpacedRepetition> = new Map();\n  private learningMaterials: Map<string, LearningMaterial> = new Map();\n  private studyMaterials: Map<string, StudyMaterial> = new Map();\n  private testAttempts: Map<string, TestAttempt> = new Map();\n  private categoryMastery: Map<string, CategoryMastery> = new Map();\n  \n  // Gamification storage\n  private achievements: Map<string, Achievement> = new Map();\n  private userAchievements: Map<string, UserAchievement> = new Map();\n  private notifications: Map<string, Notification> = new Map();\n  private userGoals: Map<string, UserGoals> = new Map();\n\n  private initialized = false;\n  private initializationPromise: Promise<void> | null = null;\n\n  constructor() {\n    this.initializeData();\n  }\n\n  private initializeData() {\n    // Initialize achievement catalog only\n    // Categories and questions will be loaded from jService API on demand\n    this.initializeAchievements();\n  }\n\n  // Fetch fresh game board from Open Trivia DB API\n  async fetchFreshGameBoard(): Promise<void> {\n    // If already initialized, return immediately\n    if (this.initialized) {\n      return;\n    }\n\n    // If initialization is in progress, wait for it\n    if (this.initializationPromise) {\n      return this.initializationPromise;\n    }\n\n    // Start initialization and store the promise\n    this.initializationPromise = this._doFetchFreshGameBoard();\n    \n    try {\n      await this.initializationPromise;\n    } finally {\n      // Clear the promise after completion (success or failure)\n      this.initializationPromise = null;\n    }\n  }\n\n  private async _doFetchFreshGameBoard(): Promise<void> {\n    try {\n      console.log('üéØ Fetching fresh game board from Open Trivia DB...');\n      \n      // Define all 24 Open Trivia DB categories grouped by topic\n      const categoryGroups = {\n        entertainment: [\n          { id: 10, name: 'Entertainment: Books' },\n          { id: 11, name: 'Entertainment: Film' },\n          { id: 12, name: 'Entertainment: Music' },\n          { id: 13, name: 'Entertainment: Musicals & Theatres' },\n          { id: 14, name: 'Entertainment: Television' },\n          { id: 15, name: 'Entertainment: Video Games' },\n          { id: 16, name: 'Entertainment: Board Games' },\n          { id: 29, name: 'Entertainment: Comics' },\n          { id: 31, name: 'Entertainment: Japanese Anime & Manga' },\n          { id: 32, name: 'Entertainment: Cartoon & Animations' }\n        ],\n        science: [\n          { id: 17, name: 'Science & Nature' },\n          { id: 18, name: 'Science: Computers' },\n          { id: 19, name: 'Science: Mathematics' },\n          { id: 30, name: 'Science: Gadgets' }\n        ],\n        general: [\n          { id: 9, name: 'General Knowledge' },\n          { id: 20, name: 'Mythology' },\n          { id: 21, name: 'Sports' },\n          { id: 22, name: 'Geography' },\n          { id: 23, name: 'History' },\n          { id: 24, name: 'Politics' },\n          { id: 25, name: 'Art' },\n          { id: 26, name: 'Celebrities' },\n          { id: 27, name: 'Animals' },\n          { id: 28, name: 'Vehicles' }\n        ]\n      };\n      \n      // Shuffle each group independently\n      const shuffleArray = <T,>(arr: T[]): T[] => {\n        const shuffled = [...arr];\n        for (let i = shuffled.length - 1; i > 0; i--) {\n          const j = Math.floor(Math.random() * (i + 1));\n          [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];\n        }\n        return shuffled;\n      };\n      \n      const shuffledEntertainment = shuffleArray(categoryGroups.entertainment);\n      const shuffledScience = shuffleArray(categoryGroups.science);\n      const shuffledGeneral = shuffleArray(categoryGroups.general);\n      \n      // Create a diverse selection pool: max 2 from Entertainment, max 1 from Science, rest from General\n      // This ensures broad topic coverage\n      const diversePool = [\n        ...shuffledEntertainment.slice(0, 2),  // Max 2 Entertainment\n        ...shuffledScience.slice(0, 1),        // Max 1 Science\n        ...shuffledGeneral                      // All General topics\n      ];\n      \n      // Shuffle the final pool\n      const shuffled = shuffleArray(diversePool);\n      \n      // Fetch and select questions for each category with retry logic\n      const selectedByCategory: Array<{ categoryName: string; questions: any[] }> = [];\n      const difficultyOrder = { easy: 1, medium: 2, hard: 3 };\n      const maxAttempts = 20; // Try up to 20 categories to get 6 successful ones\n      let attemptedCount = 0;\n      \n      for (const cat of shuffled) {\n        if (selectedByCategory.length >= 6) break; // Got enough categories\n        if (attemptedCount >= maxAttempts) break; // Prevent infinite loop\n        attemptedCount++;\n        \n        try {\n          // Fetch 12 questions from this category\n          const questions = await openTDBClient.getQuestionsByCategory(cat.id, 12);\n          console.log(`   üìö Fetched ${questions.length} Jeopardy-suitable questions from ${cat.name}`);\n          \n          if (questions.length < 5) {\n            console.warn(`   ‚ö†Ô∏è  Not enough questions for ${cat.name}, trying next category...`);\n            continue;\n          }\n          \n          // Sort WITHIN this category by difficulty: easy ‚Üí medium ‚Üí hard\n          const sortedQuestions = [...questions].sort((a, b) => {\n            const orderA = difficultyOrder[a.difficulty as keyof typeof difficultyOrder] || 2;\n            const orderB = difficultyOrder[b.difficulty as keyof typeof difficultyOrder] || 2;\n            return orderA - orderB;\n          });\n          \n          // Select 5 questions spanning difficulty range:\n          // - Positions 0-1: Easy questions ‚Üí $200, $400\n          // - Position 2: Medium question ‚Üí $600\n          // - Positions 3-4: Harder questions ‚Üí $800, $1000\n          const selected = [\n            sortedQuestions[0],  // Easiest ‚Üí $200\n            sortedQuestions[1],  // Easy ‚Üí $400\n            sortedQuestions[Math.floor(sortedQuestions.length / 2)],  // Middle ‚Üí $600\n            sortedQuestions[sortedQuestions.length - 2] || sortedQuestions[sortedQuestions.length - 1],  // Hard ‚Üí $800\n            sortedQuestions[sortedQuestions.length - 1]  // Hardest ‚Üí $1000\n          ];\n          \n          selectedByCategory.push({ categoryName: cat.name, questions: selected });\n          console.log(`   ‚úÖ Selected 5 questions for ${cat.name}: ${selected.filter(q => q.difficulty === 'easy').length} easy, ${selected.filter(q => q.difficulty === 'medium').length} medium, ${selected.filter(q => q.difficulty === 'hard').length} hard`);\n          \n        } catch (error) {\n          console.warn(`   ‚ö†Ô∏è  Failed to fetch ${cat.name}, trying next category...`);\n        }\n      }\n      \n      // Ensure we have enough categories\n      if (selectedByCategory.length < 6) {\n        throw new Error(`Insufficient categories: got ${selectedByCategory.length}, need 6. Tried ${attemptedCount} categories.`);\n      }\n      \n      console.log(`üé≤ Final board categories: ${selectedByCategory.map(c => c.categoryName).join(', ')}`);\n      \n      console.log(`üìù Successfully prepared ${selectedByCategory.length} categories with proper difficulty distribution`);\n      \n      // Prepare new data structures\n      const newCategories = new Map<string, Category>();\n      const newQuestions = new Map<string, Question>();\n      const newSpacedRepetition = new Map<string, SpacedRepetition>();\n      const values = [200, 400, 600, 800, 1000];\n      \n      // Assign questions to categories and values\n      for (const catData of selectedByCategory) {\n        // Create category\n        const category: Category = {\n          id: randomUUID(),\n          name: catData.categoryName,\n          weight: 1.0\n        };\n        newCategories.set(category.id, category);\n        \n        // Assign the 5 selected questions to this category\n        // They're already sorted: 2 easy, 1 medium, 2 hard\n        for (let i = 0; i < 5 && i < catData.questions.length; i++) {\n          const tq = catData.questions[i];\n          const converted = openTDBClient.convertQuestion(tq);\n          const assignedValue = values[i];  // $200, $400, $600, $800, $1000\n          \n          const question: Question = {\n            id: randomUUID(),\n            categoryId: category.id,\n            text: converted.text,\n            answer: converted.answer,\n            value: assignedValue,\n            difficulty: Math.ceil(assignedValue / 200),\n            airDate: null,\n            jServiceId: null\n          };\n          \n          newQuestions.set(question.id, question);\n          \n          // Initialize spaced repetition data\n          const srData: SpacedRepetition = {\n            id: randomUUID(),\n            userId: \"system\",\n            questionId: question.id,\n            easeFactor: 2.5,\n            interval: 1,\n            repetitions: 0,\n            nextReview: new Date(),\n            lastReviewed: null,\n          };\n          newSpacedRepetition.set(srData.id, srData);\n        }\n      }\n      \n      // Only clear and replace after successful fetch\n      this.categories.clear();\n      this.questions.clear();\n      \n      // Copy new data into existing maps\n      for (const [key, value] of newCategories) {\n        this.categories.set(key, value);\n      }\n      for (const [key, value] of newQuestions) {\n        this.questions.set(key, value);\n      }\n      \n      // Add new spaced repetition data (append to existing user data)\n      for (const [key, value] of newSpacedRepetition) {\n        this.spacedRepetition.set(key, value);\n      }\n      \n      const totalQuestions = this.questions.size;\n      console.log(`‚ú® Game board initialized with ${totalQuestions} questions from ${this.categories.size} categories`);\n      \n      this.initialized = true;\n    } catch (error) {\n      console.error('‚ùå Failed to fetch fresh game board:', error);\n      \n      // If not initialized yet and we have no fallback, keep error thrown\n      if (!this.initialized) {\n        throw error;\n      }\n      \n      // If already initialized, keep existing data and log error\n      console.warn('‚ö†Ô∏è  Keeping existing game board due to API error');\n    }\n  }\n\n  private initializeAchievements() {\n    const achievements: InsertAchievement[] = [\n      // Milestone achievements\n      {\n        key: \"first_clue\",\n        name: \"First Clue! üéØ\",\n        description: \"Answer your very first Jeopardy question\",\n        icon: \"üéØ\",\n        category: \"milestone\",\n        tier: \"bronze\",\n        points: 10,\n        requirements: JSON.stringify({ totalQuestions: 1 })\n      },\n      {\n        key: \"getting_started\", \n        name: \"Getting Started üìö\",\n        description: \"Answer 5 questions correctly\",\n        icon: \"üìö\",\n        category: \"milestone\", \n        tier: \"bronze\",\n        points: 25,\n        requirements: JSON.stringify({ correctAnswers: 5 })\n      },\n      {\n        key: \"quiz_enthusiast\",\n        name: \"Quiz Enthusiast üß†\", \n        description: \"Answer 25 questions total\",\n        icon: \"üß†\",\n        category: \"milestone\",\n        tier: \"silver\", \n        points: 50,\n        requirements: JSON.stringify({ totalQuestions: 25 })\n      },\n      {\n        key: \"jeopardy_scholar\",\n        name: \"Jeopardy Scholar üéì\",\n        description: \"Answer 100 questions total\",\n        icon: \"üéì\", \n        category: \"milestone\",\n        tier: \"gold\",\n        points: 100,\n        requirements: JSON.stringify({ totalQuestions: 100 })\n      },\n\n      // Streak achievements\n      {\n        key: \"daily_habit\",\n        name: \"Daily Habit üî•\",\n        description: \"Maintain a 3-day streak\",\n        icon: \"üî•\",\n        category: \"streak\",\n        tier: \"bronze\", \n        points: 30,\n        requirements: JSON.stringify({ dailyStreak: 3 })\n      },\n      {\n        key: \"week_warrior\",\n        name: \"Week Warrior ‚ö°\",\n        description: \"Maintain a 7-day streak\", \n        icon: \"‚ö°\",\n        category: \"streak\",\n        tier: \"silver\",\n        points: 75,\n        requirements: JSON.stringify({ dailyStreak: 7 })\n      },\n      {\n        key: \"streak_master\",\n        name: \"Streak Master üåü\",\n        description: \"Maintain a 30-day streak\",\n        icon: \"üåü\", \n        category: \"streak\",\n        tier: \"gold\",\n        points: 200,\n        requirements: JSON.stringify({ dailyStreak: 30 })\n      },\n\n      // Mastery achievements\n      {\n        key: \"category_specialist\",\n        name: \"Category Specialist üèÜ\",\n        description: \"Achieve 80%+ accuracy in any category with 10+ questions\",\n        icon: \"üèÜ\",\n        category: \"mastery\", \n        tier: \"silver\",\n        points: 60,\n        requirements: JSON.stringify({ categoryAccuracy: 80, categoryQuestions: 10 })\n      },\n      {\n        key: \"well_rounded\",\n        name: \"Well Rounded üåà\",\n        description: \"Practice in 6 different categories\",\n        icon: \"üåà\",\n        category: \"mastery\",\n        tier: \"silver\", \n        points: 50,\n        requirements: JSON.stringify({ categoriesCovered: 6 })\n      },\n      {\n        key: \"perfectionist\", \n        name: \"Perfectionist üíé\",\n        description: \"Get 10 questions correct in a row\",\n        icon: \"üíé\",\n        category: \"mastery\",\n        tier: \"gold\",\n        points: 80,\n        requirements: JSON.stringify({ perfectStreak: 10 })\n      },\n\n      // Speed achievements\n      {\n        key: \"quick_thinker\",\n        name: \"Quick Thinker ‚ö°\",\n        description: \"Answer 5 questions in under 5 seconds each\",\n        icon: \"‚ö°\", \n        category: \"speed\",\n        tier: \"bronze\",\n        points: 40,\n        requirements: JSON.stringify({ fastAnswers: 5, timeLimit: 5 })\n      },\n      {\n        key: \"speed_demon\",\n        name: \"Speed Demon üèÉ\",\n        description: \"Answer 20 questions in under 3 seconds each\", \n        icon: \"üèÉ\",\n        category: \"speed\",\n        tier: \"gold\",\n        points: 100,\n        requirements: JSON.stringify({ fastAnswers: 20, timeLimit: 3 })\n      },\n\n      // Test achievements\n      {\n        key: \"test_taker\", \n        name: \"Test Taker üìù\",\n        description: \"Complete your first Anytime! Test\",\n        icon: \"üìù\",\n        category: \"milestone\",\n        tier: \"silver\",\n        points: 75,\n        requirements: JSON.stringify({ anytimeTestsCompleted: 1 })\n      },\n      {\n        key: \"test_master\",\n        name: \"Test Master üëë\",\n        description: \"Score 80%+ on an Anytime! Test\",\n        icon: \"üëë\", \n        category: \"mastery\",\n        tier: \"platinum\",\n        points: 150,\n        requirements: JSON.stringify({ anytimeTestScore: 80 })\n      },\n\n      // Readiness achievements\n      {\n        key: \"test_ready\",\n        name: \"Test Ready! üéØ\",\n        description: \"Reach 70% overall readiness\",\n        icon: \"üéØ\",\n        category: \"milestone\",\n        tier: \"silver\", \n        points: 100,\n        requirements: JSON.stringify({ readinessScore: 70 })\n      },\n      {\n        key: \"highly_prepared\", \n        name: \"Highly Prepared üöÄ\",\n        description: \"Reach 80% overall readiness\",\n        icon: \"üöÄ\",\n        category: \"milestone\",\n        tier: \"gold\",\n        points: 150,\n        requirements: JSON.stringify({ readinessScore: 80 })\n      },\n      {\n        key: \"jeopardy_master\",\n        name: \"Jeopardy Master üëë\",\n        description: \"Reach 90% overall readiness\", \n        icon: \"üëë\",\n        category: \"milestone\",\n        tier: \"platinum\",\n        points: 250,\n        requirements: JSON.stringify({ readinessScore: 90 })\n      }\n    ];\n\n    achievements.forEach(ach => {\n      const achievement: Achievement = { ...ach, id: randomUUID() };\n      this.achievements.set(achievement.key, achievement);\n    });\n  }\n\n  // User operations (IMPORTANT) - mandatory for Replit Auth\n  async getUser(id: string): Promise<User | undefined> {\n    return this.users.get(id);\n  }\n\n  async upsertUser(userData: UpsertUser): Promise<User> {\n    const existingUser = this.users.get(userData.id!);\n    const user: User = {\n      id: userData.id!,\n      email: userData.email,\n      firstName: userData.firstName,\n      lastName: userData.lastName,\n      profileImageUrl: userData.profileImageUrl,\n      createdAt: existingUser?.createdAt || new Date(),\n      updatedAt: new Date(),\n    };\n    this.users.set(user.id, user);\n    return user;\n  }\n\n  async getCategories(): Promise<Category[]> {\n    // Auto-initialize if not loaded yet\n    if (!this.initialized) {\n      await this.fetchFreshGameBoard();\n    }\n    return Array.from(this.categories.values());\n  }\n\n  async createCategory(insertCategory: InsertCategory): Promise<Category> {\n    const id = randomUUID();\n    const category: Category = { ...insertCategory, id, weight: insertCategory.weight || 1.0 };\n    this.categories.set(id, category);\n    return category;\n  }\n\n  async getQuestions(): Promise<Question[]> {\n    // Auto-initialize if not loaded yet\n    if (!this.initialized) {\n      await this.fetchFreshGameBoard();\n    }\n    return Array.from(this.questions.values());\n  }\n\n  async getQuestionsByCategory(categoryId: string): Promise<Question[]> {\n    return Array.from(this.questions.values()).filter(q => q.categoryId === categoryId);\n  }\n\n  async getRandomQuestionsByCategory(categoryId: string, value: number): Promise<Question[]> {\n    return Array.from(this.questions.values()).filter(q => q.categoryId === categoryId && q.value === value);\n  }\n\n  async getQuestionByValue(categoryId: string, value: number): Promise<QuestionWithCategory | undefined> {\n    const question = Array.from(this.questions.values()).find(q => q.categoryId === categoryId && q.value === value);\n    if (!question) return undefined;\n    \n    const category = this.categories.get(question.categoryId);\n    if (!category) return undefined;\n    \n    return { ...question, category };\n  }\n\n  async getRapidFireQuestions(limit: number = 10, categoryIds?: string[]): Promise<QuestionWithCategory[]> {\n    let allQuestions = Array.from(this.questions.values());\n    \n    // Filter by categories if specified\n    if (categoryIds && categoryIds.length > 0) {\n      allQuestions = allQuestions.filter(q => categoryIds.includes(q.categoryId));\n    }\n    \n    const shuffled = allQuestions.sort(() => Math.random() - 0.5);\n    const questionsWithCategories: QuestionWithCategory[] = [];\n    \n    for (const question of shuffled.slice(0, limit)) {\n      const category = this.categories.get(question.categoryId);\n      if (category) {\n        questionsWithCategories.push({ ...question, category });\n      }\n    }\n    \n    return questionsWithCategories;\n  }\n\n  async getQuestion(id: string): Promise<QuestionWithCategory | undefined> {\n    const question = this.questions.get(id);\n    if (!question) return undefined;\n    \n    const category = this.categories.get(question.categoryId);\n    if (!category) return undefined;\n    \n    return { ...question, category };\n  }\n\n  async getAnsweredQuestions(userId?: string, mode?: \"game\" | \"rapid_fire\" | \"anytime_test\"): Promise<{ questionId: string; assessment: \"correct\" | \"incorrect\" | \"unsure\" }[]> {\n    let progressEntries = Array.from(this.userProgress.values());\n    \n    // Filter by userId if provided\n    if (userId) {\n      progressEntries = progressEntries.filter(p => p.userId === userId);\n    }\n    \n    // Filter by mode if provided\n    if (mode) {\n      progressEntries = progressEntries.filter(p => p.mode === mode);\n    }\n    \n    return progressEntries.map(p => ({ \n      questionId: p.questionId, \n      assessment: p.selfAssessment as \"correct\" | \"incorrect\" | \"unsure\"\n    }));\n  }\n\n  async clearProgress(userId?: string): Promise<void> {\n    if (userId) {\n      // Clear progress for specific user only\n      for (const [key, progress] of this.userProgress.entries()) {\n        if (progress.userId === userId) {\n          this.userProgress.delete(key);\n        }\n      }\n      for (const [key, sr] of this.spacedRepetition.entries()) {\n        if (sr.userId === userId) {\n          this.spacedRepetition.delete(key);\n        }\n      }\n    } else {\n      // Clear all progress (backward compatibility)\n      this.userProgress.clear();\n      this.spacedRepetition.clear();\n    }\n  }\n\n  async resetGameBoard(userId?: string): Promise<void> {\n    // Clear progress for user (or all if no userId provided)\n    await this.clearProgress(userId);\n    \n    // Always fetch fresh questions from jService API\n    await this.fetchFreshGameBoard();\n  }\n\n  async createQuestion(insertQuestion: InsertQuestion): Promise<Question> {\n    const id = randomUUID();\n    const question: Question = { \n      ...insertQuestion, \n      id,\n      difficulty: insertQuestion.difficulty || 1,\n      airDate: insertQuestion.airDate || null,\n      jServiceId: insertQuestion.jServiceId || null\n    };\n    this.questions.set(id, question);\n    return question;\n  }\n\n  async getUserProgress(userId?: string): Promise<UserProgress[]> {\n    let progressEntries = Array.from(this.userProgress.values());\n    \n    // Filter by userId if provided\n    if (userId) {\n      progressEntries = progressEntries.filter(p => p.userId === userId);\n    }\n    \n    return progressEntries;\n  }\n\n  async createUserProgress(insertProgress: InsertUserProgress): Promise<UserProgress> {\n    const id = randomUUID();\n    const progress: UserProgress = { \n      ...insertProgress, \n      id, \n      mode: insertProgress.mode || \"game\",\n      sessionId: insertProgress.sessionId || null,\n      answeredAt: new Date(),\n      userAnswer: insertProgress.userAnswer || null,\n      timeSpent: insertProgress.timeSpent || null,\n      selfAssessment: insertProgress.selfAssessment || \"unsure\"\n    };\n    this.userProgress.set(id, progress);\n    return progress;\n  }\n\n  async getUserProgressByCategory(categoryId: string, userId?: string): Promise<UserProgress[]> {\n    const categoryQuestions = await this.getQuestionsByCategory(categoryId);\n    const questionIds = new Set(categoryQuestions.map(q => q.id));\n    \n    let progressEntries = Array.from(this.userProgress.values()).filter(\n      progress => questionIds.has(progress.questionId)\n    );\n    \n    // Filter by userId if provided\n    if (userId) {\n      progressEntries = progressEntries.filter(p => p.userId === userId);\n    }\n    \n    return progressEntries;\n  }\n\n  async getSpacedRepetitionData(): Promise<SpacedRepetition[]> {\n    return Array.from(this.spacedRepetition.values());\n  }\n\n  async getSpacedRepetitionForQuestion(questionId: string): Promise<SpacedRepetition | undefined> {\n    return Array.from(this.spacedRepetition.values()).find(sr => sr.questionId === questionId);\n  }\n\n  async createSpacedRepetition(insertData: InsertSpacedRepetition): Promise<SpacedRepetition> {\n    const id = randomUUID();\n    const data: SpacedRepetition = { \n      ...insertData, \n      id,\n      easeFactor: insertData.easeFactor ?? 2.5,\n      interval: insertData.interval ?? 1,\n      repetitions: insertData.repetitions ?? 0,\n      nextReview: insertData.nextReview ?? new Date(),\n      lastReviewed: insertData.lastReviewed ?? null\n    };\n    this.spacedRepetition.set(id, data);\n    return data;\n  }\n\n  async updateSpacedRepetition(id: string, updates: Partial<SpacedRepetition>): Promise<SpacedRepetition> {\n    const existing = this.spacedRepetition.get(id);\n    if (!existing) throw new Error(\"Spaced repetition data not found\");\n    \n    const updated: SpacedRepetition = { ...existing, ...updates };\n    this.spacedRepetition.set(id, updated);\n    return updated;\n  }\n\n  async getQuestionsForReview(limit: number = 10): Promise<QuestionWithCategory[]> {\n    const now = new Date();\n    const dueForReview = Array.from(this.spacedRepetition.values())\n      .filter(sr => sr.nextReview <= now)\n      .sort((a, b) => a.nextReview.getTime() - b.nextReview.getTime())\n      .slice(0, limit);\n\n    const questionsWithCategories: QuestionWithCategory[] = [];\n    \n    for (const sr of dueForReview) {\n      const questionWithCategory = await this.getQuestion(sr.questionId);\n      if (questionWithCategory) {\n        questionsWithCategories.push(questionWithCategory);\n      }\n    }\n    \n    return questionsWithCategories;\n  }\n\n  async getCategoryStats(userId?: string): Promise<CategoryStats[]> {\n    const categories = await this.getCategories();\n    const stats: CategoryStats[] = [];\n\n    for (const category of categories) {\n      const categoryProgress = await this.getUserProgressByCategory(category.id, userId);\n      const totalQuestions = categoryProgress.length;\n      const correctAnswers = categoryProgress.filter(p => p.correct).length;\n      const averageTime = totalQuestions > 0 \n        ? categoryProgress.reduce((sum, p) => sum + (p.timeSpent || 0), 0) / totalQuestions \n        : 0;\n\n      stats.push({\n        categoryId: category.id,\n        categoryName: category.name,\n        totalQuestions,\n        correctAnswers,\n        accuracy: totalQuestions > 0 ? (correctAnswers / totalQuestions) * 100 : 0,\n        averageTime,\n      });\n    }\n\n    return stats;\n  }\n\n  async getDailyStats(days: number, userId?: string): Promise<DailyStats[]> {\n    const endDate = new Date();\n    const startDate = new Date(endDate);\n    startDate.setDate(startDate.getDate() - days);\n\n    const allProgress = await this.getUserProgress(userId);\n    const dailyStats: DailyStats[] = [];\n\n    for (let i = 0; i < days; i++) {\n      const date = new Date(startDate);\n      date.setDate(date.getDate() + i);\n      const dateStr = date.toISOString().split('T')[0];\n      \n      const dayProgress = allProgress.filter(p => {\n        const progressDate = p.answeredAt.toISOString().split('T')[0];\n        return progressDate === dateStr;\n      });\n\n      const questionsAnswered = dayProgress.length;\n      const correctAnswers = dayProgress.filter(p => p.correct).length;\n      const studyTime = dayProgress.reduce((sum, p) => sum + (p.timeSpent || 0), 0);\n\n      dailyStats.push({\n        date: dateStr,\n        questionsAnswered,\n        correctAnswers,\n        accuracy: questionsAnswered > 0 ? (correctAnswers / questionsAnswered) * 100 : 0,\n        studyTime,\n      });\n    }\n\n    return dailyStats;\n  }\n\n  async getOverallStats(userId?: string): Promise<{\n    totalQuestions: number;\n    overallAccuracy: number;\n    currentStreak: number;\n    totalStudyTime: number;\n  }> {\n    const allProgress = await this.getUserProgress(userId);\n    const totalQuestions = allProgress.length;\n    const correctAnswers = allProgress.filter(p => p.correct).length;\n    const overallAccuracy = totalQuestions > 0 ? (correctAnswers / totalQuestions) * 100 : 0;\n    const totalStudyTime = Math.round(allProgress.reduce((sum, p) => sum + (p.timeSpent || 0), 0) / 3600); // hours\n\n    // Calculate current streak\n    const sortedProgress = allProgress\n      .sort((a, b) => b.answeredAt.getTime() - a.answeredAt.getTime());\n    \n    let currentStreak = 0;\n    for (const progress of sortedProgress) {\n      if (progress.correct) {\n        currentStreak++;\n      } else {\n        break;\n      }\n    }\n\n    return {\n      totalQuestions,\n      overallAccuracy,\n      currentStreak,\n      totalStudyTime,\n    };\n  }\n\n  // Learning Materials implementation\n  async getLearningMaterial(questionId: string): Promise<LearningMaterial | undefined> {\n    return Array.from(this.learningMaterials.values()).find(lm => lm.questionId === questionId);\n  }\n\n  async createLearningMaterial(insertMaterial: InsertLearningMaterial): Promise<LearningMaterial> {\n    const id = randomUUID();\n    const material: LearningMaterial = { \n      ...insertMaterial, \n      id, \n      commonness: insertMaterial.commonness || \"common\",\n      generatedAt: new Date() \n    };\n    this.learningMaterials.set(id, material);\n    return material;\n  }\n\n  async getStudyReview(): Promise<StudyReview> {\n    const allProgress = await this.getUserProgress();\n    const review: StudyReview = {\n      correct: [],\n      incorrect: [],\n      unsure: []\n    };\n\n    for (const progress of allProgress) {\n      const questionWithCategory = await this.getQuestion(progress.questionId);\n      if (!questionWithCategory) continue;\n\n      const learningMaterial = await this.getLearningMaterial(progress.questionId);\n      const questionWithLearning: QuestionWithLearning = {\n        ...questionWithCategory,\n        learningMaterial\n      };\n\n      review[progress.selfAssessment].push(questionWithLearning);\n    }\n\n    return review;\n  }\n\n  // Study Materials implementation\n  async getStudyMaterials(): Promise<StudyMaterial[]> {\n    return Array.from(this.studyMaterials.values());\n  }\n\n  async getStudyMaterialsByCategory(category: string): Promise<StudyMaterial[]> {\n    return Array.from(this.studyMaterials.values()).filter(sm => sm.category === category);\n  }\n\n  async createStudyMaterial(insertMaterial: InsertStudyMaterial): Promise<StudyMaterial> {\n    const id = randomUUID();\n    const material: StudyMaterial = { \n      ...insertMaterial, \n      id, \n      generatedAt: new Date()\n    };\n    this.studyMaterials.set(id, material);\n    return material;\n  }\n\n  // Test Attempts implementation\n  async createTestAttempt(insertAttempt: InsertTestAttempt): Promise<TestAttempt> {\n    const id = randomUUID();\n    const attempt: TestAttempt = {\n      ...insertAttempt,\n      id,\n      finishedAt: new Date()\n    };\n    this.testAttempts.set(id, attempt);\n    return attempt;\n  }\n\n  async getTestAttempts(mode?: \"anytime_test\"): Promise<TestAttempt[]> {\n    const attempts = Array.from(this.testAttempts.values());\n    if (mode) {\n      return attempts.filter(attempt => attempt.mode === mode);\n    }\n    return attempts;\n  }\n\n  async getAnytimeTestSet(userId?: string): Promise<QuestionWithCategory[]> {\n    try {\n      console.log('üéØ Fetching fresh Jeopardy-suitable questions from Open Trivia DB for Anytime Test...');\n      \n      // Fetch 50 random questions from Open Trivia DB (already filtered for Jeopardy suitability)\n      const triviaQuestions = await openTDBClient.getRandomQuestions(50);\n      console.log(`üìù Fetched ${triviaQuestions.length} Jeopardy-suitable questions from Open Trivia DB`);\n      \n      // Ensure we have enough questions\n      if (triviaQuestions.length < 30) {\n        console.warn(`‚ö†Ô∏è Only got ${triviaQuestions.length} questions after filtering, attempting to fetch more...`);\n        // If we don't have enough, return what we have rather than failing\n        if (triviaQuestions.length === 0) {\n          throw new Error('No suitable questions available');\n        }\n      }\n      \n      const questions: QuestionWithCategory[] = [];\n      \n      // Convert each question to our format\n      for (const tq of triviaQuestions) {\n        const converted = openTDBClient.convertQuestion(tq);\n        \n        // Create a temporary category for this question\n        const category: Category = {\n          id: randomUUID(),\n          name: tq.category,\n          weight: 1.0\n        };\n        \n        const question: QuestionWithCategory = {\n          id: randomUUID(),\n          categoryId: category.id,\n          text: converted.text,\n          answer: converted.answer,\n          value: converted.value,\n          difficulty: converted.difficulty,\n          airDate: null,\n          jServiceId: null,\n          category\n        };\n        \n        questions.push(question);\n      }\n      \n      console.log(`‚ú® Anytime Test set ready with ${questions.length} Jeopardy-suitable questions`);\n      return questions;\n    } catch (error) {\n      console.error('‚ùå Failed to fetch Anytime Test questions:', error);\n      // Fallback to empty array rather than failing completely\n      return [];\n    }\n  }\n\n  async getCategoryMasteryRecords(userId?: string): Promise<CategoryMastery[]> {\n    // For MemStorage, we filter by userId (in DB implementation, this would be a WHERE clause)\n    const allRecords = Array.from(this.categoryMastery.values());\n    if (userId) {\n      return allRecords.filter(record => record.userId === userId);\n    }\n    return allRecords;\n  }\n\n  async updateCategoryMastery(\n    userId: string,\n    categoryName: string,\n    isCorrect: boolean,\n    answeredAt: Date\n  ): Promise<CategoryMastery> {\n    // Find existing record or create new one\n    const recordKey = `${userId}:${categoryName}`;\n    let record = Array.from(this.categoryMastery.values()).find(\n      r => r.userId === userId && r.categoryName === categoryName\n    );\n    \n    if (!record) {\n      // Create new record\n      const id = randomUUID();\n      record = {\n        id,\n        userId,\n        categoryName,\n        totalCorrect: 0,\n        totalAnswered: 0,\n        weightedCorrectScore: 0,\n        lastAnswered: null,\n        masteryLevel: 'novice',\n        updatedAt: new Date()\n      };\n      this.categoryMastery.set(id, record);\n    }\n    \n    // Update counts\n    record.totalAnswered += 1;\n    if (isCorrect) {\n      record.totalCorrect += 1;\n    }\n    record.lastAnswered = answeredAt;\n    \n    // Recalculate weighted score based on ALL answers in this category\n    const categoryProgress = await this.getUserProgress(userId);\n    const categoryAnswers = categoryProgress\n      .filter(p => {\n        const question = this.questions.get(p.questionId);\n        if (!question) return false;\n        const category = this.categories.get(question.categoryId);\n        return category?.name === categoryName;\n      })\n      .map(p => ({\n        correct: p.correct,\n        answeredAt: p.answeredAt\n      }));\n    \n    record.weightedCorrectScore = calculateWeightedCorrectScore(categoryAnswers);\n    record.masteryLevel = determineMasteryLevel(record.weightedCorrectScore);\n    record.updatedAt = new Date();\n    \n    return record;\n  }\n\n  async getReadinessScore(): Promise<ReadinessScore> {\n    const now = new Date();\n    const allProgress = await this.getUserProgress();\n    const testAttempts = await this.getTestAttempts(\"anytime_test\");\n    const masteryRecords = await this.getCategoryMasteryRecords();\n    const categories = await this.getCategories();\n\n    // Component 1: Category Mastery (60%)\n    // Based on time-weighted correct answers across all categories\n    const categoryMasteryScore = calculateCategoryMasteryScore(masteryRecords);\n\n    // Component 2: Category Breadth (20%)\n    // Percentage of the 24 total categories that have been practiced\n    const totalCategories = 24; // All Open Trivia DB categories\n    const practicedCategories = masteryRecords.length;\n    const breadthScore = calculateBreadthScore(totalCategories, practicedCategories);\n\n    // Component 3: Anytime Test Performance (20%)\n    // Time-weighted accuracy from Anytime Test attempts\n    let anytimeTestScore = 0;\n    if (testAttempts.length > 0) {\n      const weightedAttempts = testAttempts.map(attempt => {\n        const accuracy = (attempt.correctCount / attempt.totalQuestions) * 100;\n        const daysSince = (now.getTime() - attempt.finishedAt.getTime()) / (1000 * 60 * 60 * 24);\n        const weight = Math.exp(-daysSince / 21); // 21-day half-life\n        return { accuracy, weight };\n      });\n      \n      const totalWeight = weightedAttempts.reduce((sum, a) => sum + a.weight, 0);\n      if (totalWeight > 0) {\n        anytimeTestScore = weightedAttempts.reduce((sum, a) => sum + (a.accuracy * a.weight), 0) / totalWeight;\n      }\n    }\n\n    // Calculate overall readiness: 60% mastery + 20% breadth + 20% test\n    const overallScore = calculateOverallReadiness(\n      categoryMasteryScore,\n      breadthScore,\n      anytimeTestScore\n    );\n\n    // Build category coverage details\n    const categoryCoverage: Array<{\n      categoryId: string;\n      categoryName: string;\n      accuracy: number;\n      recentQuestions: number;\n      weight: number;\n      covered: boolean;\n    }> = [];\n\n    for (const category of categories) {\n      const categoryProgress = allProgress.filter(p => {\n        const question = Array.from(this.questions.values()).find(q => q.id === p.questionId);\n        return question?.categoryId === category.id;\n      });\n\n      const accuracy = categoryProgress.length > 0 \n        ? (categoryProgress.filter(p => p.correct).length / categoryProgress.length) * 100 \n        : 0;\n\n      const covered = accuracy >= 70 && categoryProgress.length >= 3;\n\n      categoryCoverage.push({\n        categoryId: category.id,\n        categoryName: category.name,\n        accuracy,\n        recentQuestions: categoryProgress.length,\n        weight: category.weight,\n        covered\n      });\n    }\n\n    const coveredCategories = categoryCoverage.filter(c => c.covered).length;\n\n    // Letter grade\n    const letterGrade: \"A\" | \"B\" | \"C\" | \"D\" | \"F\" = \n      overallScore >= 90 ? \"A\" :\n      overallScore >= 80 ? \"B\" :\n      overallScore >= 70 ? \"C\" :\n      overallScore >= 60 ? \"D\" : \"F\";\n\n    // Test ready: ‚â•80% readiness and at least one passing test in last 30 days\n    const recentPassingTests = testAttempts.filter(attempt => {\n      const daysDiff = (now.getTime() - attempt.finishedAt.getTime()) / (1000 * 60 * 60 * 24);\n      const accuracy = (attempt.correctCount / attempt.totalQuestions) * 100;\n      return daysDiff <= 30 && accuracy >= 70;\n    });\n\n    const testReady = overallScore >= 80 && recentPassingTests.length > 0;\n\n    // Identify weak categories (below 60% mastery score)\n    const weakMasteryRecords = masteryRecords.filter(r => r.weightedCorrectScore < 60);\n    const weakCategories = categoryCoverage.filter(c => \n      weakMasteryRecords.some(r => r.categoryName === c.categoryName) || c.recentQuestions < 3\n    );\n\n    const components = [\n      { name: \"Category Mastery\", score: categoryMasteryScore, weight: 0.6, description: \"Time-weighted performance across categories\" },\n      { name: \"Category Breadth\", score: breadthScore, weight: 0.2, description: \"Variety of categories practiced\" },\n      { name: \"Anytime Test\", score: anytimeTestScore, weight: 0.2, description: \"Practice test performance\" }\n    ];\n\n    return {\n      overallScore: Math.round(overallScore * 10) / 10,\n      letterGrade,\n      components,\n      categoryBreadth: {\n        coveredCategories,\n        totalCategories: totalCategories,\n        requiredCategories: Math.ceil(totalCategories * 0.5), // 50% of 24 = 12\n        breadthFactor: Math.round((practicedCategories / totalCategories) * 100) / 100\n      },\n      categoryCoverage,\n      weakCategories,\n      testReady,\n      lastUpdated: now\n    };\n  }\n\n  // Gamification methods implementation\n  async getAchievements(): Promise<Achievement[]> {\n    return Array.from(this.achievements.values());\n  }\n\n  async createAchievement(achievement: InsertAchievement): Promise<Achievement> {\n    const id = randomUUID();\n    const newAchievement: Achievement = { ...achievement, id };\n    this.achievements.set(achievement.key, newAchievement);\n    return newAchievement;\n  }\n\n  async getUserAchievements(): Promise<UserAchievement[]> {\n    return Array.from(this.userAchievements.values());\n  }\n\n  async getUserAchievementByKey(key: string): Promise<UserAchievement | undefined> {\n    return Array.from(this.userAchievements.values()).find(ua => ua.achievementKey === key);\n  }\n\n  async createUserAchievement(userAchievement: InsertUserAchievement): Promise<UserAchievement> {\n    const id = randomUUID();\n    const newUserAchievement: UserAchievement = {\n      ...userAchievement,\n      id,\n      createdAt: new Date(),\n    };\n    this.userAchievements.set(id, newUserAchievement);\n    return newUserAchievement;\n  }\n\n  async updateUserAchievement(id: string, data: Partial<UserAchievement>): Promise<UserAchievement> {\n    const existing = this.userAchievements.get(id);\n    if (!existing) {\n      throw new Error(\"UserAchievement not found\");\n    }\n    const updated = { ...existing, ...data };\n    this.userAchievements.set(id, updated);\n    return updated;\n  }\n\n  async getAchievementsWithProgress(): Promise<AchievementWithProgress[]> {\n    const achievements = await this.getAchievements();\n    const userAchievements = await this.getUserAchievements();\n    \n    return achievements.map(achievement => {\n      const userAchievement = userAchievements.find(ua => ua.achievementKey === achievement.key);\n      \n      return {\n        ...achievement,\n        progress: userAchievement?.progress || 0,\n        maxProgress: userAchievement?.maxProgress || 1,\n        isEarned: userAchievement?.isEarned || false,\n        earnedAt: userAchievement?.earnedAt,\n        progressPercent: userAchievement ? (userAchievement.progress / userAchievement.maxProgress) * 100 : 0,\n      };\n    });\n  }\n\n  async awardAchievement(achievementKey: string, progress?: number): Promise<{ achievement: Achievement; notification: Notification } | null> {\n    const achievement = this.achievements.get(achievementKey);\n    if (!achievement) return null;\n\n    let userAchievement = await this.getUserAchievementByKey(achievementKey);\n    \n    if (!userAchievement) {\n      // Create new user achievement\n      userAchievement = await this.createUserAchievement({\n        achievementKey,\n        progress: progress || 1,\n        maxProgress: 1,\n        isEarned: false,\n      });\n    } else if (userAchievement.isEarned) {\n      return null; // Already earned\n    }\n\n    // Update progress\n    const newProgress = Math.min(userAchievement.progress + (progress || 1), userAchievement.maxProgress);\n    const isEarned = newProgress >= userAchievement.maxProgress;\n\n    await this.updateUserAchievement(userAchievement.id, {\n      progress: newProgress,\n      isEarned,\n      earnedAt: isEarned ? new Date() : undefined,\n    });\n\n    if (isEarned) {\n      // Create notification\n      const notification = await this.createNotification({\n        type: \"achievement\",\n        title: \"Achievement Unlocked!\",\n        message: `${achievement.name}: ${achievement.description}`,\n        icon: achievement.icon,\n        priority: \"high\",\n      });\n\n      return { achievement, notification };\n    }\n\n    return null;\n  }\n\n  async getNotifications(unreadOnly?: boolean): Promise<NotificationWithAction[]> {\n    const notifications = Array.from(this.notifications.values());\n    const filtered = unreadOnly ? notifications.filter(n => !n.isRead) : notifications;\n    \n    return filtered\n      .sort((a, b) => b.createdAt.getTime() - a.createdAt.getTime())\n      .map(notification => ({\n        ...notification,\n        canDismiss: true,\n        timeAgo: this.formatTimeAgo(notification.createdAt),\n        achievementData: notification.type === \"achievement\" ? \n          this.achievements.get(notification.message.split(\":\")[0]?.trim()) : undefined,\n      }));\n  }\n\n  async createNotification(notification: InsertNotification): Promise<Notification> {\n    const id = randomUUID();\n    const newNotification: Notification = {\n      ...notification,\n      id,\n      createdAt: new Date(),\n    };\n    this.notifications.set(id, newNotification);\n    return newNotification;\n  }\n\n  async markNotificationRead(id: string): Promise<void> {\n    const notification = this.notifications.get(id);\n    if (notification) {\n      notification.isRead = true;\n      this.notifications.set(id, notification);\n    }\n  }\n\n  async getUnreadNotificationCount(userId?: string): Promise<number> {\n    const notifications = Array.from(this.notifications.values());\n    return notifications.filter(n => !n.isRead && (!userId || n.userId === userId)).length;\n  }\n\n  async getUserGoals(userId?: string): Promise<UserGoals> {\n    // For now, return the single user goals instance\n    // In a multi-user system, this would be scoped by userId\n    return this.userGoals;\n  }\n\n  async updateUserGoals(goals: Partial<InsertUserGoals>, userId?: string): Promise<UserGoals> {\n    // For now, update the single user goals instance\n    // In a multi-user system, this would be scoped by userId\n    this.userGoals = {\n      ...this.userGoals,\n      ...goals,\n      updatedAt: new Date(),\n    };\n    return this.userGoals;\n  }\n\n  async getStreakInfo(userId?: string): Promise<StreakInfo> {\n    // For now, calculate streaks for all data\n    // In a multi-user system, this would be scoped by userId\n    const dailyStats = await this.getDailyStats(365); // Get full year for accurate streaks\n    const today = new Date().toISOString().split('T')[0];\n    const userGoals = await this.getUserGoals(userId);\n    \n    // Calculate streaks\n    let dailyStreak = 0;\n    let longestDailyStreak = 0;\n    let currentStreak = 0;\n    \n    // Sort daily stats by date\n    const sortedStats = dailyStats.sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());\n    \n    // Check daily streak from today backwards\n    for (let i = 0; i < sortedStats.length; i++) {\n      const stat = sortedStats[i];\n      if (stat.questionsAnswered > 0) {\n        if (i === 0 || dailyStreak === i) { // Continuous streak\n          dailyStreak++;\n          currentStreak++;\n        } else {\n          break;\n        }\n      } else if (i === 0) {\n        break; // Today has no activity\n      }\n    }\n    \n    // Calculate longest streak\n    let tempStreak = 0;\n    for (const stat of sortedStats.reverse()) {\n      if (stat.questionsAnswered > 0) {\n        tempStreak++;\n        longestDailyStreak = Math.max(longestDailyStreak, tempStreak);\n      } else {\n        tempStreak = 0;\n      }\n    }\n\n    const todayStat = dailyStats.find(s => s.date === today);\n    const questionsToday = todayStat?.questionsAnswered || 0;\n    const goalProgress = Math.min((questionsToday / userGoals.dailyQuestionGoal) * 100, 100);\n\n    return {\n      dailyStreak,\n      weeklyStreak: Math.floor(dailyStreak / 7), // Simple weekly calculation\n      monthlyStreak: Math.floor(dailyStreak / 30), // Simple monthly calculation\n      longestDailyStreak,\n      lastActiveDate: sortedStats.find(s => s.questionsAnswered > 0)?.date || today,\n      todayComplete: questionsToday >= userGoals.dailyQuestionGoal,\n      questionsToday,\n      goalProgress,\n    };\n  }\n\n  async getGamificationStats(userId?: string): Promise<GamificationStats> {\n    // For now, calculate stats for all data\n    // In a multi-user system, this would be scoped by userId\n    const achievements = await this.getAchievementsWithProgress(userId);\n    const earnedAchievements = achievements.filter(a => a.isEarned);\n    const streakInfo = await this.getStreakInfo(userId);\n    const unreadCount = await this.getUnreadNotificationCount(userId);\n    \n    const totalPoints = earnedAchievements.reduce((sum, a) => sum + a.points, 0);\n    \n    // Determine tier based on points\n    let currentTier = \"Bronze\";\n    let nextTierProgress = 0;\n    \n    if (totalPoints >= 1000) {\n      currentTier = \"Platinum\";\n      nextTierProgress = 100;\n    } else if (totalPoints >= 500) {\n      currentTier = \"Gold\";\n      nextTierProgress = ((totalPoints - 500) / 500) * 100;\n    } else if (totalPoints >= 200) {\n      currentTier = \"Silver\";\n      nextTierProgress = ((totalPoints - 200) / 300) * 100;\n    } else {\n      nextTierProgress = (totalPoints / 200) * 100;\n    }\n\n    return {\n      totalPoints,\n      achievementsEarned: earnedAchievements.length,\n      totalAchievements: achievements.length,\n      currentTier,\n      nextTierProgress: Math.round(nextTierProgress),\n      streakInfo,\n      recentAchievements: earnedAchievements\n        .sort((a, b) => (b.earnedAt?.getTime() || 0) - (a.earnedAt?.getTime() || 0))\n        .slice(0, 5),\n      unreadNotifications: unreadCount,\n    };\n  }\n\n  async checkAndAwardAchievements(progressData: UserProgress): Promise<Notification[]> {\n    const notifications: Notification[] = [];\n    const overallStats = await this.getOverallStats();\n    const categoryStats = await this.getCategoryStats();\n    const streakInfo = await this.getStreakInfo();\n    const readiness = await this.getReadinessScore();\n    const testAttempts = await this.getTestAttempts(\"anytime_test\");\n    \n    // Check various achievement conditions\n    const checks = [\n      // Milestone achievements\n      { key: \"first_clue\", condition: overallStats.totalQuestions >= 1 },\n      { key: \"getting_started\", condition: overallStats.totalQuestions >= 5 && overallStats.overallAccuracy >= 50 },\n      { key: \"quiz_enthusiast\", condition: overallStats.totalQuestions >= 25 },\n      { key: \"jeopardy_scholar\", condition: overallStats.totalQuestions >= 100 },\n      \n      // Streak achievements  \n      { key: \"daily_habit\", condition: streakInfo.dailyStreak >= 3 },\n      { key: \"week_warrior\", condition: streakInfo.dailyStreak >= 7 },\n      { key: \"streak_master\", condition: streakInfo.dailyStreak >= 30 },\n      \n      // Mastery achievements\n      { key: \"category_specialist\", condition: categoryStats.some(c => c.accuracy >= 80 && c.totalQuestions >= 10) },\n      { key: \"well_rounded\", condition: categoryStats.filter(c => c.totalQuestions >= 5).length >= 6 },\n      \n      // Test achievements\n      { key: \"test_taker\", condition: testAttempts.length >= 1 },\n      { key: \"test_master\", condition: testAttempts.some(t => (t.correctCount / t.totalQuestions) * 100 >= 80) },\n      \n      // Readiness achievements\n      { key: \"test_ready\", condition: readiness.overallScore >= 70 },\n      { key: \"highly_prepared\", condition: readiness.overallScore >= 80 },\n      { key: \"jeopardy_master\", condition: readiness.overallScore >= 90 },\n    ];\n\n    for (const check of checks) {\n      if (check.condition) {\n        const result = await this.awardAchievement(check.key);\n        if (result) {\n          notifications.push(result.notification);\n        }\n      }\n    }\n\n    return notifications;\n  }\n\n  async evaluateAchievements(): Promise<void> {\n    // This method can be called periodically to check all achievements\n    // For now, it's implemented as part of checkAndAwardAchievements\n    // but could be expanded for more complex evaluation logic\n  }\n\n  private formatTimeAgo(date: Date): string {\n    const now = new Date();\n    const diffMs = now.getTime() - date.getTime();\n    const diffMins = Math.floor(diffMs / (1000 * 60));\n    const diffHours = Math.floor(diffMins / 60);\n    const diffDays = Math.floor(diffHours / 24);\n\n    if (diffMins < 1) return \"Just now\";\n    if (diffMins < 60) return `${diffMins}m ago`;\n    if (diffHours < 24) return `${diffHours}h ago`;\n    if (diffDays < 7) return `${diffDays}d ago`;\n    return date.toLocaleDateString();\n  }\n}\n\nimport { DbStorage } from './db-storage';\n\n// Feature flag: use database storage for production autoscale compatibility\n// Set USE_DB_STORAGE=true to enable database-backed storage\nconst USE_DB_STORAGE = process.env.USE_DB_STORAGE === 'true' || process.env.NODE_ENV === 'production';\n\nconst storageInstance: IStorage = USE_DB_STORAGE \n  ? new DbStorage() \n  : new MemStorage();\n\nconsole.log(`üíæ Using ${USE_DB_STORAGE ? 'Database' : 'In-Memory'} Storage`);\n\n// Export initialization function for server startup\nexport async function initializeStorage(): Promise<void> {\n  if (USE_DB_STORAGE && storageInstance instanceof DbStorage) {\n    console.log('‚è≥ Waiting for database storage initialization...');\n    await storageInstance.waitForInitialization();\n    console.log('‚úÖ Database storage initialized and ready');\n  }\n}\n\nexport const storage: IStorage = storageInstance;\n\n","size_bytes":57308},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","size_bytes":166},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","size_bytes":689},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","size_bytes":1056},"server/perplexity-service.ts":{"content":"interface PerplexityResponse {\n  id: string;\n  model: string;\n  object: string;\n  created: number;\n  citations: string[];\n  choices: Array<{\n    index: number;\n    finish_reason: string;\n    message: {\n      role: string;\n      content: string;\n    };\n  }>;\n}\n\ninterface LearningExplanation {\n  explanation: string;\n  sources: string[];\n  relatedFacts: string[];\n  commonness: 'very_common' | 'common' | 'uncommon' | 'rare';\n}\n\nexport class PerplexityService {\n  private readonly apiKey: string;\n  private readonly baseUrl = 'https://api.perplexity.ai/chat/completions';\n\n  constructor(apiKey: string) {\n    this.apiKey = apiKey;\n  }\n\n  async generateExplanation(question: string, correctAnswer: string, userWasCorrect: boolean): Promise<LearningExplanation> {\n    const systemPrompt = userWasCorrect \n      ? `You are an expert Jeopardy tutor. The user answered correctly. Provide additional context and learning material about this topic.`\n      : `You are an expert Jeopardy tutor helping a student learn from their mistake. Provide a clear explanation and additional context.`;\n\n    const userPrompt = userWasCorrect\n      ? `Great job! You correctly answered: \"${correctAnswer}\" to the question \"${question}\". \n\nCreate a well-formatted learning explanation with the following structure:\n\n**Why This Answer Matters:**\nExplain the significance and context of this answer.\n\n**Key Trivia Facts:**\n‚Ä¢ Provide 2-3 bullet points with interesting related facts\n‚Ä¢ Focus on information that commonly appears in trivia\n‚Ä¢ Include memorable details that aid retention\n\n**Memory Techniques:**\nShare specific strategies or associations to remember this topic.\n\n**How Common on Jeopardy:**\nRate this topic as: very common, common, uncommon, or rare\n\n**Question Variations:**\nExplain how this topic might be asked differently in Jeopardy.\n\nUse proper formatting with headers, bullet points, and line breaks for readability.`\n      : `The correct answer to \"${question}\" is \"${correctAnswer}\".\n\nCreate a well-formatted learning explanation with the following structure:\n\n**Why This is Correct:**\nClear explanation of why this is the right answer.\n\n**Key Facts to Remember:**\n‚Ä¢ Provide 2-3 bullet points with essential information\n‚Ä¢ Focus on details that help distinguish this from similar topics\n‚Ä¢ Include context that makes this memorable\n\n**Memory Techniques:**\nShare specific strategies or associations to remember this topic.\n\n**How Common on Jeopardy:**\nRate this topic as: very common, common, uncommon, or rare\n\n**Question Variations:**\nExplain how this topic might be asked differently in future questions.\n\nUse proper formatting with headers, bullet points, and line breaks for readability.`;\n\n    try {\n      const response = await fetch(this.baseUrl, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${this.apiKey}`,\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          model: 'sonar',\n          messages: [\n            {\n              role: 'system',\n              content: systemPrompt\n            },\n            {\n              role: 'user',\n              content: userPrompt\n            }\n          ],\n          temperature: 0.2,\n          max_tokens: 500,\n          return_related_questions: false,\n          search_recency_filter: 'month',\n          stream: false\n        })\n      });\n\n      if (!response.ok) {\n        throw new Error(`Perplexity API error: ${response.status}`);\n      }\n\n      const data: PerplexityResponse = await response.json();\n      const explanation = data.choices[0]?.message?.content || 'No explanation available';\n      const sources = data.citations || [];\n\n      // Extract related facts from the explanation (simple approach - split by numbered points)\n      const relatedFacts = this.extractRelatedFacts(explanation);\n      const commonness = this.extractCommonness(explanation);\n\n      return {\n        explanation,\n        sources,\n        relatedFacts,\n        commonness\n      };\n    } catch (error) {\n      console.error('Error generating explanation:', error);\n      // Return fallback explanation\n      return {\n        explanation: `The correct answer is ${correctAnswer}. This is a common Jeopardy topic that appears frequently in trivia competitions.`,\n        sources: [],\n        relatedFacts: [],\n        commonness: 'common' as const\n      };\n    }\n  }\n\n  async generateStudyMaterial(category: string, topic?: string): Promise<{\n    title: string;\n    content: string;\n    sources: string[];\n    relatedTopics: string[];\n  }> {\n    const prompt = topic \n      ? `Create comprehensive study material for Jeopardy contestants about ${topic} in the ${category} category.`\n      : `Create comprehensive study material for Jeopardy contestants about key topics in the ${category} category.`;\n\n    const detailedPrompt = `${prompt}\n\nCreate a well-structured study guide with the following format:\n\n**Essential Trivia Facts:**\n‚Ä¢ List 4-5 key facts that frequently appear in Jeopardy questions\n‚Ä¢ Include specific names, dates, and numbers that are commonly tested\n‚Ä¢ Focus on information that helps distinguish similar topics\n\n**Common Question Patterns:**\nExplain how this topic typically appears in Jeopardy questions and what contestants should look for.\n\n**Memory Techniques:**\nProvide specific strategies to remember the key facts.\n\n**Related Topics to Study:**\nList 3-4 related topics that often appear together in trivia.\n\n**Quick Reference:**\nSummarize the most important facts in a concise format.\n\nUse proper formatting with headers, bullet points, and clear organization for easy studying.`;\n\n    try {\n      const response = await fetch(this.baseUrl, {\n        method: 'POST',\n        headers: {\n          'Authorization': `Bearer ${this.apiKey}`,\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({\n          model: 'sonar',\n          messages: [\n            {\n              role: 'system',\n              content: 'You are an expert Jeopardy coach creating study materials for contestants. Focus on facts, dates, names, and concepts that frequently appear on the show.'\n            },\n            {\n              role: 'user',\n              content: detailedPrompt\n            }\n          ],\n          temperature: 0.3,\n          max_tokens: 800,\n          return_related_questions: false,\n          search_recency_filter: 'year',\n          stream: false\n        })\n      });\n\n      if (!response.ok) {\n        throw new Error(`Perplexity API error: ${response.status}`);\n      }\n\n      const data: PerplexityResponse = await response.json();\n      const content = data.choices[0]?.message?.content || 'Study material not available';\n      const sources = data.citations || [];\n\n      // Extract title and related topics from content\n      const { title, cleanedContent } = this.extractTitleFromContent(content, category, topic);\n      const relatedTopics = this.extractRelatedTopics(content);\n\n      return {\n        title,\n        content: cleanedContent,\n        sources,\n        relatedTopics\n      };\n    } catch (error) {\n      console.error('Error generating study material:', error);\n      return {\n        title: `${category} Study Guide`,\n        content: `Study material for ${category} category. Key concepts and facts commonly appearing on Jeopardy.`,\n        sources: [],\n        relatedTopics: []\n      };\n    }\n  }\n\n  private extractRelatedFacts(explanation: string): string[] {\n    // Simple extraction of numbered points or bullet points as related facts\n    const facts: string[] = [];\n    const lines = explanation.split('\\n');\n    \n    for (const line of lines) {\n      const trimmed = line.trim();\n      // Look for numbered points (1., 2., etc.) or bullet points (‚Ä¢, -, *)\n      if (/^[\\d+\\.\\-\\*\\‚Ä¢]/.test(trimmed) && trimmed.length > 10) {\n        // Remove the numbering/bullet and clean up\n        const cleaned = trimmed.replace(/^[\\d+\\.\\-\\*\\‚Ä¢]\\s*/, '').trim();\n        if (cleaned.length > 10) {\n          facts.push(cleaned);\n        }\n      }\n    }\n    \n    return facts.slice(0, 5); // Limit to 5 related facts\n  }\n\n  private extractTitleFromContent(content: string, category: string, topic?: string): { title: string; cleanedContent: string } {\n    const lines = content.split('\\n');\n    let title = topic ? `${topic} - ${category}` : `${category} Study Guide`;\n    let cleanedContent = content;\n\n    // Look for potential title in first few lines\n    for (let i = 0; i < Math.min(3, lines.length); i++) {\n      const line = lines[i].trim();\n      if (line.length > 5 && line.length < 100 && !line.includes('.') && line === line.toUpperCase()) {\n        title = line;\n        cleanedContent = lines.slice(i + 1).join('\\n').trim();\n        break;\n      }\n    }\n\n    return { title, cleanedContent };\n  }\n\n  private extractRelatedTopics(content: string): string[] {\n    const topics: string[] = [];\n    const lines = content.split('\\n');\n    \n    for (const line of lines) {\n      const lower = line.toLowerCase();\n      if (lower.includes('related') && (lower.includes('topics') || lower.includes('subjects'))) {\n        // Found a related topics section\n        const index = lines.indexOf(line);\n        for (let i = index + 1; i < Math.min(index + 6, lines.length); i++) {\n          const topicLine = lines[i].trim();\n          if (topicLine.length > 3 && topicLine.length < 50) {\n            const cleaned = topicLine.replace(/^[\\d+\\.\\-\\*\\‚Ä¢]\\s*/, '').trim();\n            if (cleaned.length > 3) {\n              topics.push(cleaned);\n            }\n          }\n        }\n        break;\n      }\n    }\n    \n    return topics.slice(0, 8); // Limit to 8 related topics\n  }\n\n  private extractCommonness(content: string): 'very_common' | 'common' | 'uncommon' | 'rare' {\n    const lower = content.toLowerCase();\n    \n    if (lower.includes('very common') || lower.includes('extremely common') || lower.includes('frequently appears')) {\n      return 'very_common';\n    } else if (lower.includes('uncommon') || lower.includes('less common') || lower.includes('infrequent')) {\n      return 'uncommon';\n    } else if (lower.includes('rare') || lower.includes('rarely') || lower.includes('seldom')) {\n      return 'rare';\n    } else {\n      return 'common'; // Default fallback\n    }\n  }\n}\n\nexport const perplexityService = new PerplexityService(process.env.PERPLEXITY_API_KEY || '');","size_bytes":10397},"client/src/components/game-board.tsx":{"content":"import { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Clock, Target, Zap, RotateCcw, Timer } from \"lucide-react\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport type { Category, QuestionWithCategory, CategoryStats } from \"@shared/schema\";\nimport { useAnsweredQuestions } from \"@/hooks/useAnsweredQuestions\";\n\ninterface GameBoardProps {\n  onQuestionSelect: (questionId: string) => void;\n  onRapidFire: () => void;\n  onAnytimeTest: () => void;\n}\n\nexport default function GameBoard({ onQuestionSelect, onRapidFire, onAnytimeTest }: GameBoardProps) {\n  const { data: categories } = useQuery<Category[]>({\n    queryKey: [\"/api/categories\"],\n  });\n\n  const { data: categoryStats } = useQuery<CategoryStats[]>({\n    queryKey: [\"/api/stats/categories\"],\n  });\n\n  const { data: overallStats } = useQuery({\n    queryKey: [\"/api/stats/overall\"],\n  });\n\n  const { answeredQuestions, clearAnsweredQuestions } = useAnsweredQuestions();\n\n  const resetBoardMutation = useMutation({\n    mutationFn: () => apiRequest(\"POST\", \"/api/reset-board\"),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/categories\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/questions\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/answered-questions\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/stats\"] });\n    },\n  });\n\n  const values = [200, 400, 600, 800, 1000];\n  const totalQuestions = categories?.length ? categories.length * values.length : 30;\n  const completedQuestions = answeredQuestions.length;\n  const isGameComplete = completedQuestions >= totalQuestions;\n\n  const handleResetBoard = () => {\n    if (confirm(\"Are you sure you want to reset the board? This will generate new questions and clear all progress.\")) {\n      resetBoardMutation.mutate();\n    }\n  };\n\n  return (\n    <section className=\"p-4\" data-testid=\"game-board\">\n      {/* Progress Section */}\n      <div className=\"mb-4\">\n        <h2 className=\"text-xl font-bold mb-2\">Today's Challenge</h2>\n        <Card className=\"p-4\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <span className=\"text-muted-foreground\">Progress Today</span>\n            <span className=\"text-sm font-medium\" data-testid=\"text-daily-progress\">\n              {overallStats?.totalQuestions || 0}/30 questions\n            </span>\n          </div>\n          <div className=\"w-full bg-muted rounded-full h-2\">\n            <div \n              className=\"bg-primary h-2 rounded-full transition-all duration-500\" \n              style={{ width: `${Math.min(((overallStats?.totalQuestions || 0) / 30) * 100, 100)}%` }}\n            />\n          </div>\n        </Card>\n      </div>\n\n      {/* Jeopardy Game Board */}\n      <Card className=\"mb-6 overflow-hidden\">\n        <div className=\"jeopardy-gradient text-primary-foreground p-2\">\n          <h3 className=\"text-center font-bold text-lg\">JEOPARDY!</h3>\n        </div>\n        \n        <div className=\"p-4\">\n          {/* Category Headers */}\n          <div className=\"grid grid-cols-6 gap-1 mb-2\">\n            {categories?.slice(0, 6).map((category) => (\n              <div\n                key={category.id}\n                className=\"bg-primary text-primary-foreground p-2 text-center text-xs font-bold uppercase rounded\"\n                data-testid={`header-${category.id}`}\n              >\n                {category.name.replace(/&/g, '&').substring(0, 12)}\n              </div>\n            ))}\n          </div>\n          \n          {/* Question Grid */}\n          <div className=\"grid grid-cols-6 gap-1\">\n            {values.map((value) => (\n              categories?.slice(0, 6).map((category) => (\n                <QuestionButton\n                  key={`${category.id}-${value}`}\n                  categoryId={category.id}\n                  value={value}\n                  onSelect={onQuestionSelect}\n                  answeredQuestions={answeredQuestions}\n                />\n              ))\n            ))}\n          </div>\n        </div>\n      </Card>\n\n      {/* Completion Status */}\n      {isGameComplete && (\n        <Card className=\"p-4 mb-4 bg-green-50 border-green-200 dark:bg-green-950 dark:border-green-800\">\n          <div className=\"text-center\">\n            <h3 className=\"font-bold text-green-800 dark:text-green-200 mb-2\">üéâ Game Board Complete!</h3>\n            <p className=\"text-sm text-green-700 dark:text-green-300 mb-3\">\n              You've answered all {totalQuestions} questions! Ready for a new challenge?\n            </p>\n            <Button \n              onClick={handleResetBoard}\n              className=\"bg-green-600 hover:bg-green-700 text-white\"\n              disabled={resetBoardMutation.isPending}\n              data-testid=\"button-reset-board-complete\"\n            >\n              <RotateCcw className=\"mr-2\" size={16} />\n              {resetBoardMutation.isPending ? \"Generating New Board...\" : \"Get New Questions\"}\n            </Button>\n          </div>\n        </Card>\n      )}\n\n      {/* Quick Study Mode */}\n      <Card className=\"p-4\">\n        <h3 className=\"font-bold mb-3\">Study Modes</h3>\n        <div className=\"grid grid-cols-2 gap-3\">\n          <Button \n            onClick={onRapidFire}\n            className=\"bg-destructive text-destructive-foreground p-4 h-auto hover:bg-destructive/90 flex flex-col items-center\"\n            data-testid=\"button-rapid-fire\"\n          >\n            <Zap className=\"mb-2 text-lg\" />\n            <span className=\"font-medium text-xs\">Rapid Fire</span>\n          </Button>\n          <Button \n            onClick={onAnytimeTest}\n            className=\"bg-orange-600 text-white p-4 h-auto hover:bg-orange-700 flex flex-col items-center\"\n            data-testid=\"button-anytime-test\"\n          >\n            <Timer className=\"mb-2 text-lg\" />\n            <span className=\"font-medium text-xs\">Anytime! Test</span>\n          </Button>\n          <Button \n            className=\"bg-accent text-accent-foreground p-4 h-auto hover:bg-accent/90 flex flex-col items-center\"\n            data-testid=\"button-spaced-repetition\"\n          >\n            <Clock className=\"mb-2 text-lg\" />\n            <span className=\"font-medium text-xs\">Spaced Rep.</span>\n          </Button>\n          <Button \n            className=\"bg-primary text-primary-foreground p-4 h-auto hover:bg-primary/90 flex flex-col items-center\"\n            data-testid=\"button-weak-areas\"\n          >\n            <Target className=\"mb-2 text-lg\" />\n            <span className=\"font-medium text-xs\">Weak Areas</span>\n          </Button>\n        </div>\n      </Card>\n    </section>\n  );\n}\n\ninterface QuestionButtonProps {\n  categoryId: string;\n  value: number;\n  onSelect: (questionId: string) => void;\n  answeredQuestions: { questionId: string; assessment: \"correct\" | \"incorrect\" | \"unsure\" }[];\n}\n\nfunction QuestionButton({ categoryId, value, onSelect, answeredQuestions }: QuestionButtonProps) {\n  const { data: question } = useQuery<QuestionWithCategory>({\n    queryKey: [`/api/questions?categoryId=${categoryId}&value=${value}`],\n    enabled: !!categoryId,\n  });\n\n  const isAvailable = !!question;\n  const answeredData = question && answeredQuestions.find(aq => aq.questionId === question.id);\n  const isAnswered = !!answeredData;\n\n  const handleClick = () => {\n    if (question) {\n      onSelect(question.id);\n    }\n  };\n\n  const getButtonStyle = () => {\n    if (!isAvailable) {\n      return 'bg-muted text-muted-foreground cursor-not-allowed';\n    }\n    if (isAnswered && answeredData) {\n      switch (answeredData.assessment) {\n        case 'correct':\n          return 'bg-green-600 text-white opacity-85 border-2 border-green-400';\n        case 'incorrect':\n          return 'bg-red-600 text-white opacity-85 border-2 border-red-400';\n        case 'unsure':\n          return 'bg-orange-500 text-white opacity-85 border-2 border-orange-400';\n      }\n    }\n    return 'gold-gradient text-black hover:opacity-90';\n  };\n\n  const getAssessmentIcon = () => {\n    if (!isAnswered || !answeredData) return null;\n    switch (answeredData.assessment) {\n      case 'correct':\n        return '‚úì';\n      case 'incorrect':\n        return '‚úó';\n      case 'unsure':\n        return '?';\n      default:\n        return null;\n    }\n  };\n\n  return (\n    <Button\n      onClick={handleClick}\n      disabled={!isAvailable}\n      className={`\n        ripple font-bold text-lg transition-colors min-h-[60px] flex items-center justify-center relative\n        ${getButtonStyle()}\n      `}\n      data-testid={`button-question-${categoryId}-${value}${!isAvailable ? '-disabled' : isAnswered ? '-answered' : ''}`}\n    >\n      ${value}\n      {isAnswered && (\n        <span className=\"absolute top-1 right-1 text-sm font-bold\">\n          {getAssessmentIcon()}\n        </span>\n      )}\n    </Button>\n  );\n}\n","size_bytes":8921},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":711},"client/src/components/notification-center.tsx":{"content":"import { useState } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Bell, X, Trophy, Star, Target, CheckCircle } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { apiRequest, queryClient } from \"@/lib/queryClient\";\nimport { cn } from \"@/lib/utils\";\nimport type { NotificationWithAction } from \"@shared/schema\";\n\nexport default function NotificationCenter() {\n  const [isOpen, setIsOpen] = useState(false);\n\n  const { data: notifications = [] } = useQuery<NotificationWithAction[]>({\n    queryKey: [\"/api/notifications\"],\n    refetchInterval: 60000, // COST OPTIMIZED: Reduced from 30s to 60s\n  });\n\n  const { data: unreadCount = { count: 0 } } = useQuery<{ count: number }>({\n    queryKey: [\"/api/notifications/unread-count\"],\n    refetchInterval: 30000, // COST OPTIMIZED: Reduced from 10s to 30s\n  });\n\n  const markAsReadMutation = useMutation({\n    mutationFn: (id: string) => apiRequest(\"PATCH\", `/api/notifications/${id}/read`),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/notifications/unread-count\"] });\n    },\n  });\n\n  const handleNotificationClick = (notification: NotificationWithAction) => {\n    if (!notification.isRead) {\n      markAsReadMutation.mutate(notification.id);\n    }\n  };\n\n  const getNotificationIcon = (type: string, icon?: string, message?: string) => {\n    if (icon) return icon; // Use custom emoji icon if provided\n    \n    switch (type) {\n      case \"achievement\":\n        return \"üèÜ\";\n      case \"streak\":\n        // Enhanced flame icons based on streak value in message\n        if (message?.includes(\"streak\")) {\n          const streakMatch = message.match(/(\\d+)/);\n          const streakValue = streakMatch ? parseInt(streakMatch[1]) : 1;\n          if (streakValue >= 15) return \"üî•üî•üî•üî•\";\n          if (streakValue >= 7) return \"üî•üî•üî•\";\n          if (streakValue >= 3) return \"üî•üî•\";\n          return \"üî•\";\n        }\n        return \"üî•\";\n      case \"milestone\":\n        return \"‚≠ê\";\n      case \"reminder\":\n        return \"‚è∞\";\n      default:\n        return \"üîî\";\n    }\n  };\n\n  const getNotificationColor = (type: string, priority: string) => {\n    if (priority === \"high\") return \"from-yellow-400 to-orange-500\";\n    \n    switch (type) {\n      case \"achievement\":\n        return \"from-purple-400 to-pink-500\";\n      case \"streak\":\n        return \"from-red-400 to-orange-500\";\n      case \"milestone\":\n        return \"from-blue-400 to-cyan-500\";\n      case \"reminder\":\n        return \"from-green-400 to-teal-500\";\n      default:\n        return \"from-gray-400 to-gray-500\";\n    }\n  };\n\n  return (\n    <div className=\"relative\">\n      {/* Bell Icon Button */}\n      <Button\n        variant=\"ghost\"\n        size=\"sm\"\n        className=\"relative p-2 hover:bg-primary/10 transition-colors\"\n        onClick={() => setIsOpen(!isOpen)}\n        data-testid=\"notification-bell\"\n      >\n        <Bell className=\"w-5 h-5 text-primary\" />\n        {unreadCount.count > 0 && (\n          <Badge \n            className=\"absolute -top-1 -right-1 min-w-[18px] h-[18px] p-0 text-xs bg-red-500 hover:bg-red-500 animate-pulse\"\n            data-testid=\"notification-badge\"\n          >\n            {unreadCount.count > 99 ? \"99+\" : unreadCount.count}\n          </Badge>\n        )}\n      </Button>\n\n      {/* Slide-out Notification Drawer */}\n      {isOpen && (\n        <>\n          {/* Overlay */}\n          <div \n            className=\"fixed inset-0 bg-black/20 z-40\"\n            onClick={() => setIsOpen(false)}\n          />\n          \n          {/* Drawer */}\n          <div className=\"fixed top-0 right-0 h-full w-full max-w-sm bg-white dark:bg-gray-900 shadow-2xl z-50 transform transition-transform duration-300 ease-out\">\n            {/* Header */}\n            <div className=\"flex items-center justify-between p-4 border-b bg-gradient-to-r from-primary/10 to-purple-100 dark:from-primary/20 dark:to-purple-900\">\n              <div className=\"flex items-center gap-2\">\n                <Bell className=\"w-5 h-5 text-primary\" />\n                <h2 className=\"text-lg font-semibold text-primary\">Notifications</h2>\n              </div>\n              <Button\n                variant=\"ghost\"\n                size=\"sm\"\n                onClick={() => setIsOpen(false)}\n                data-testid=\"close-notifications\"\n              >\n                <X className=\"w-4 h-4\" />\n              </Button>\n            </div>\n\n            {/* Notification List */}\n            <div className=\"overflow-y-auto max-h-[calc(100vh-80px)]\">\n              {notifications.length === 0 ? (\n                <div className=\"p-6 text-center text-gray-500 dark:text-gray-400\">\n                  <Bell className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n                  <p className=\"text-sm\">No notifications yet!</p>\n                  <p className=\"text-xs mt-1\">Keep practicing to unlock achievements üèÜ</p>\n                </div>\n              ) : (\n                <div className=\"p-2 space-y-2\">\n                  {notifications.map((notification) => (\n                    <div\n                      key={notification.id}\n                      className={cn(\n                        \"relative p-3 rounded-lg border cursor-pointer transition-all duration-200 hover:scale-[1.02]\",\n                        notification.isRead \n                          ? \"bg-gray-50 dark:bg-gray-800 border-gray-200 dark:border-gray-700\" \n                          : \"bg-white dark:bg-gray-900 border-primary/20 shadow-sm\"\n                      )}\n                      onClick={() => handleNotificationClick(notification)}\n                      data-testid={`notification-${notification.id}`}\n                    >\n                      {/* Colorful gradient accent */}\n                      <div className={cn(\n                        \"absolute top-0 left-0 w-1 h-full rounded-l-lg bg-gradient-to-b\",\n                        getNotificationColor(notification.type, notification.priority)\n                      )} />\n                      \n                      <div className=\"flex items-start gap-3 ml-2\">\n                        {/* Icon */}\n                        <div className=\"text-2xl flex-shrink-0\">\n                          {getNotificationIcon(notification.type, notification.icon || undefined, notification.message)}\n                        </div>\n                        \n                        {/* Content */}\n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"flex items-center gap-2 mb-1\">\n                            <h3 className={cn(\n                              \"text-sm font-medium truncate\",\n                              notification.isRead ? \"text-gray-600 dark:text-gray-400\" : \"text-gray-900 dark:text-white\"\n                            )}>\n                              {notification.title}\n                            </h3>\n                            {!notification.isRead && (\n                              <div className=\"w-2 h-2 bg-primary rounded-full flex-shrink-0\" />\n                            )}\n                          </div>\n                          \n                          <p className={cn(\n                            \"text-xs leading-relaxed\",\n                            notification.isRead ? \"text-gray-500 dark:text-gray-500\" : \"text-gray-700 dark:text-gray-300\"\n                          )}>\n                            {notification.message}\n                          </p>\n                          \n                          <div className=\"flex items-center justify-between mt-2\">\n                            <span className=\"text-xs text-gray-400\">\n                              {notification.timeAgo}\n                            </span>\n                            \n                            {notification.type === \"achievement\" && (\n                              <div className=\"flex items-center gap-1 text-xs text-yellow-600 dark:text-yellow-400\">\n                                <Trophy className=\"w-3 h-3\" />\n                                <span>Achievement!</span>\n                              </div>\n                            )}\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  ))}\n                </div>\n              )}\n            </div>\n          </div>\n        </>\n      )}\n    </div>\n  );\n}","size_bytes":8541},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","size_bytes":3848},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","size_bytes":4420},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","size_bytes":1977},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","size_bytes":710},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","size_bytes":1883},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","size_bytes":1723},"client/src/pages/landing.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\n\nexport default function Landing() {\n  const handleLogin = () => {\n    window.location.href = \"/api/login\";\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 flex items-center justify-center p-4\">\n      <Card className=\"w-full max-w-md\">\n        <CardHeader className=\"text-center\">\n          <CardTitle className=\"text-3xl font-bold text-blue-900 dark:text-blue-100\">\n            The Daily Double Down\n          </CardTitle>\n          <CardDescription className=\"text-lg\">\n            Master trivia with spaced repetition and gamification\n          </CardDescription>\n        </CardHeader>\n        <CardContent className=\"space-y-6\">\n          <div className=\"text-center space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4 text-sm\">\n              <div className=\"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-lg\">\n                <div className=\"font-semibold text-blue-900 dark:text-blue-100\">üéØ Smart Learning</div>\n                <div className=\"text-blue-700 dark:text-blue-300\">Spaced repetition algorithm</div>\n              </div>\n              <div className=\"bg-green-50 dark:bg-green-900/20 p-3 rounded-lg\">\n                <div className=\"font-semibold text-green-900 dark:text-green-100\">üèÜ Gamification</div>\n                <div className=\"text-green-700 dark:text-green-300\">Achievements & streaks</div>\n              </div>\n              <div className=\"bg-purple-50 dark:bg-purple-900/20 p-3 rounded-lg\">\n                <div className=\"font-semibold text-purple-900 dark:text-purple-100\">üìä Analytics</div>\n                <div className=\"text-purple-700 dark:text-purple-300\">Track your progress</div>\n              </div>\n              <div className=\"bg-orange-50 dark:bg-orange-900/20 p-3 rounded-lg\">\n                <div className=\"font-semibold text-orange-900 dark:text-orange-100\">üéÆ Game Modes</div>\n                <div className=\"text-orange-700 dark:text-orange-300\">Classic & rapid-fire</div>\n              </div>\n            </div>\n          </div>\n          \n          <Button \n            onClick={handleLogin}\n            className=\"w-full text-lg py-6 bg-blue-600 hover:bg-blue-700 text-white\"\n            data-testid=\"button-login\"\n          >\n            Sign In to Get Started\n          </Button>\n          \n          <p className=\"text-xs text-center text-muted-foreground\">\n            Secure authentication powered by Replit\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}","size_bytes":2685},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","size_bytes":2712},"client/src/lib/authUtils.ts":{"content":"export function isUnauthorizedError(error: Error): boolean {\n  return /^401: .*Unauthorized/.test(error.message);\n}","size_bytes":115},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","size_bytes":2765},"client/src/lib/mock-data.ts":{"content":"import type { Category, Question } from \"@shared/schema\";\n\nexport const mockCategories: Category[] = [\n  { id: \"1\", name: \"World History\", weight: 2.0 },\n  { id: \"2\", name: \"Science & Nature\", weight: 1.8 },\n  { id: \"3\", name: \"Literature\", weight: 1.5 },\n  { id: \"4\", name: \"Geography\", weight: 1.7 },\n  { id: \"5\", name: \"Sports\", weight: 1.3 },\n  { id: \"6\", name: \"Entertainment\", weight: 1.4 },\n];\n\nexport const mockQuestions: Question[] = [\n  {\n    id: \"q1\",\n    categoryId: \"1\",\n    text: \"This French emperor was exiled to the island of Elba in 1814, only to return for the famous 'Hundred Days' before his final defeat at Waterloo.\",\n    answer: \"Who is Napoleon Bonaparte?\",\n    value: 600,\n    difficulty: 3,\n  },\n  {\n    id: \"q2\",\n    categoryId: \"1\",\n    text: \"This ancient wonder of the world was a lighthouse built on the island of Pharos near Alexandria, Egypt.\",\n    answer: \"What is the Lighthouse of Alexandria?\",\n    value: 400,\n    difficulty: 2,\n  },\n  {\n    id: \"q3\",\n    categoryId: \"2\",\n    text: \"This element has the chemical symbol Au and atomic number 79.\",\n    answer: \"What is gold?\",\n    value: 400,\n    difficulty: 2,\n  },\n  {\n    id: \"q4\",\n    categoryId: \"3\",\n    text: \"This Shakespeare play features the characters Rosencrantz and Guildenstern.\",\n    answer: \"What is Hamlet?\",\n    value: 800,\n    difficulty: 4,\n  },\n  {\n    id: \"q5\",\n    categoryId: \"6\",\n    text: \"This 1969 music festival took place on Max Yasgur's dairy farm in Bethel, New York.\",\n    answer: \"What is Woodstock?\",\n    value: 200,\n    difficulty: 1,\n  },\n];\n","size_bytes":1567},"server/jservice.ts":{"content":"// Integration service for jService API - authentic Jeopardy data\ninterface JServiceCategory {\n  id: number;\n  title: string;\n  created_at: string;\n  updated_at: string;\n  clues_count: number;\n}\n\ninterface JServiceClue {\n  id: number;\n  answer: string;\n  question: string;\n  value: number | null;\n  airdate: string;\n  created_at: string;\n  updated_at: string;\n  category_id: number;\n  game_id: number;\n  invalid_count: number | null;\n  category: {\n    id: number;\n    title: string;\n    created_at: string;\n    updated_at: string;\n    clues_count: number;\n  };\n}\n\ninterface JServiceRandomClues {\n  id: number;\n  answer: string;\n  question: string;\n  value: number | null;\n  airdate: string;\n  created_at: string;\n  updated_at: string;\n  category_id: number;\n  game_id: number;\n  invalid_count: number | null;\n  category: {\n    id: number;\n    title: string;\n    created_at: string;\n    updated_at: string;\n    clues_count: number;\n  };\n}\n\nexport class JServiceClient {\n  private baseUrl = 'https://jservice.io/api';\n  private minDate = '2000-01-01'; // Only fetch questions from 2000 onwards\n\n  async getRandomCategories(count: number = 6): Promise<JServiceCategory[]> {\n    try {\n      const response = await fetch(`${this.baseUrl}/categories?count=${count}&offset=${Math.floor(Math.random() * 100)}`);\n      if (!response.ok) throw new Error(`HTTP ${response.status}`);\n      return await response.json();\n    } catch (error) {\n      console.error('Failed to fetch categories from jService:', error);\n      throw error;\n    }\n  }\n\n  async getCluesForCategory(categoryId: number, count: number = 10): Promise<JServiceClue[]> {\n    try {\n      const response = await fetch(`${this.baseUrl}/clues?category=${categoryId}&min_date=${this.minDate}`);\n      if (!response.ok) throw new Error(`HTTP ${response.status}`);\n      const clues = await response.json();\n      \n      // Filter out invalid clues and return up to count items\n      return clues\n        .filter((clue: JServiceClue) => \n          clue.question && \n          clue.answer && \n          clue.value && \n          clue.value > 0 &&\n          clue.airdate && new Date(clue.airdate) >= new Date(this.minDate) &&\n          !clue.question.includes('audio') &&\n          !clue.question.includes('video') &&\n          !clue.question.includes('seen here') &&\n          !clue.question.includes('this image')\n        )\n        .slice(0, count);\n    } catch (error) {\n      console.error(`Failed to fetch clues for category ${categoryId}:`, error);\n      throw error;\n    }\n  }\n\n  async getRandomClues(count: number = 30): Promise<JServiceRandomClues[]> {\n    try {\n      // Fetch more than needed to account for filtering\n      const response = await fetch(`${this.baseUrl}/random?count=${count * 3}`);\n      if (!response.ok) throw new Error(`HTTP ${response.status}`);\n      const clues = await response.json();\n      \n      // Filter out invalid clues and old questions\n      const filtered = clues.filter((clue: JServiceRandomClues) => \n        clue.question && \n        clue.answer && \n        clue.value && \n        clue.value > 0 &&\n        clue.airdate && new Date(clue.airdate) >= new Date(this.minDate) &&\n        !clue.question.includes('audio') &&\n        !clue.question.includes('video') &&\n        !clue.question.includes('seen here') &&\n        !clue.question.includes('this image')\n      );\n      \n      // Return up to the requested count\n      return filtered.slice(0, count);\n    } catch (error) {\n      console.error('Failed to fetch random clues from jService:', error);\n      throw error;\n    }\n  }\n\n  async searchClues(query: string, count: number = 10): Promise<JServiceClue[]> {\n    try {\n      const response = await fetch(`${this.baseUrl}/clues?query=${encodeURIComponent(query)}`);\n      if (!response.ok) throw new Error(`HTTP ${response.status}`);\n      const clues = await response.json();\n      \n      return clues\n        .filter((clue: JServiceClue) => \n          clue.question && \n          clue.answer && \n          clue.value && \n          clue.value > 0\n        )\n        .slice(0, count);\n    } catch (error) {\n      console.error(`Failed to search clues for \"${query}\":`, error);\n      throw error;\n    }\n  }\n\n  // Convert jService data to our internal format\n  convertCategory(jCategory: JServiceCategory): { name: string; weight: number } {\n    return {\n      name: jCategory.title,\n      weight: 1.0\n    };\n  }\n\n  convertClue(jClue: JServiceClue | JServiceRandomClues): {\n    text: string;\n    answer: string;\n    value: number;\n    difficulty: number;\n    airDate: string;\n    jServiceId: number;\n  } {\n    return {\n      text: jClue.question,\n      answer: jClue.answer,\n      value: jClue.value || 200,\n      difficulty: Math.ceil((jClue.value || 200) / 200),\n      airDate: jClue.airdate,\n      jServiceId: jClue.id\n    };\n  }\n}\n\nexport const jServiceClient = new JServiceClient();","size_bytes":4882},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","size_bytes":10481},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","size_bytes":5742},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","size_bytes":1753},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","size_bytes":1077},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","size_bytes":6210},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, integer, timestamp, boolean, real, jsonb, index } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\n// Session storage table.\n// (IMPORTANT) This table is mandatory for Replit Auth, don't drop it.\nexport const sessions = pgTable(\n  \"sessions\",\n  {\n    sid: varchar(\"sid\").primaryKey(),\n    sess: jsonb(\"sess\").notNull(),\n    expire: timestamp(\"expire\").notNull(),\n  },\n  (table) => [index(\"IDX_session_expire\").on(table.expire)],\n);\n\n// User storage table.\n// (IMPORTANT) This table is mandatory for Replit Auth, don't drop it.\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  email: varchar(\"email\").unique(),\n  firstName: varchar(\"first_name\"),\n  lastName: varchar(\"last_name\"),\n  profileImageUrl: varchar(\"profile_image_url\"),\n  createdAt: timestamp(\"created_at\").defaultNow(),\n  updatedAt: timestamp(\"updated_at\").defaultNow(),\n});\n\nexport const categories = pgTable(\"categories\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  weight: real(\"weight\").notNull().default(1.0), // Higher weight = more likely to appear\n});\n\nexport const questions = pgTable(\"questions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  categoryId: varchar(\"category_id\").notNull().references(() => categories.id),\n  text: text(\"text\").notNull(),\n  answer: text(\"answer\").notNull(),\n  value: integer(\"value\").notNull(), // Dollar value ($200, $400, etc.)\n  difficulty: integer(\"difficulty\").notNull().default(1), // 1-5 scale\n  airDate: text(\"air_date\"), // When the question originally aired on Jeopardy\n  jServiceId: integer(\"j_service_id\"), // Original ID from jService API\n});\n\nexport const userProgress = pgTable(\"user_progress\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  questionId: varchar(\"question_id\").notNull().references(() => questions.id),\n  correct: boolean(\"correct\").notNull(),\n  userAnswer: text(\"user_answer\"),\n  timeSpent: integer(\"time_spent\"), // in seconds\n  selfAssessment: varchar(\"self_assessment\", { enum: [\"correct\", \"incorrect\", \"unsure\"] }).notNull().default(\"unsure\"),\n  mode: varchar(\"mode\", { enum: [\"game\", \"rapid_fire\", \"anytime_test\"] }).notNull().default(\"game\"),\n  sessionId: varchar(\"session_id\"), // Groups related questions (e.g., a single test attempt)\n  answeredAt: timestamp(\"answered_at\").notNull().defaultNow(),\n});\n\nexport const spacedRepetition = pgTable(\"spaced_repetition\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  questionId: varchar(\"question_id\").notNull().references(() => questions.id),\n  easeFactor: real(\"ease_factor\").notNull().default(2.5),\n  interval: integer(\"interval\").notNull().default(1), // days\n  repetitions: integer(\"repetitions\").notNull().default(0),\n  nextReview: timestamp(\"next_review\").notNull().defaultNow(),\n  lastReviewed: timestamp(\"last_reviewed\"),\n});\n\nexport const testAttempts = pgTable(\"test_attempts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  sessionId: varchar(\"session_id\").notNull(),\n  mode: varchar(\"mode\", { enum: [\"anytime_test\"] }).notNull(),\n  correctCount: integer(\"correct_count\").notNull(),\n  totalQuestions: integer(\"total_questions\").notNull(),\n  durationSeconds: integer(\"duration_seconds\").notNull(),\n  startedAt: timestamp(\"started_at\").notNull(),\n  finishedAt: timestamp(\"finished_at\").notNull().defaultNow(),\n});\n\nexport const learningMaterials = pgTable(\"learning_materials\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  questionId: varchar(\"question_id\").notNull().references(() => questions.id),\n  explanation: text(\"explanation\").notNull(),\n  sources: text(\"sources\").array().notNull(), // JSON array of source URLs\n  relatedFacts: text(\"related_facts\").array().notNull(), // Additional trivia facts\n  commonness: varchar(\"commonness\", { enum: [\"very_common\", \"common\", \"uncommon\", \"rare\"] }).notNull().default(\"common\"),\n  generatedAt: timestamp(\"generated_at\").notNull().defaultNow(),\n});\n\nexport const studyMaterials = pgTable(\"study_materials\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  category: text(\"category\").notNull(),\n  title: text(\"title\").notNull(),\n  content: text(\"content\").notNull(),\n  sources: text(\"sources\").array().notNull(),\n  relatedTopics: text(\"related_topics\").array().notNull(),\n  generatedAt: timestamp(\"generated_at\").notNull().defaultNow(),\n});\n\n// Gamification tables\nexport const achievements = pgTable(\"achievements\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  key: varchar(\"key\").notNull().unique(), // unique identifier like \"first_clue\", \"10_in_a_day\"\n  name: text(\"name\").notNull(), // display name like \"First Clue!\"\n  description: text(\"description\").notNull(),\n  icon: text(\"icon\").notNull(), // icon name or emoji\n  category: varchar(\"category\", { enum: [\"milestone\", \"streak\", \"mastery\", \"speed\", \"consistency\"] }).notNull(),\n  tier: varchar(\"tier\", { enum: [\"bronze\", \"silver\", \"gold\", \"platinum\"] }).notNull().default(\"bronze\"),\n  points: integer(\"points\").notNull().default(10), // points awarded\n  requirements: text(\"requirements\").notNull(), // JSON description of requirements\n  isHidden: boolean(\"is_hidden\").notNull().default(false), // hidden until earned\n});\n\nexport const userAchievements = pgTable(\"user_achievements\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  achievementKey: varchar(\"achievement_key\").notNull().references(() => achievements.key),\n  progress: integer(\"progress\").notNull().default(0), // current progress toward achievement\n  maxProgress: integer(\"max_progress\").notNull().default(1), // required progress to earn\n  isEarned: boolean(\"is_earned\").notNull().default(false),\n  earnedAt: timestamp(\"earned_at\"),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const notifications = pgTable(\"notifications\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  type: varchar(\"type\", { enum: [\"achievement\", \"streak\", \"milestone\", \"reminder\", \"goal\"] }).notNull(),\n  title: text(\"title\").notNull(),\n  message: text(\"message\").notNull(),\n  icon: text(\"icon\"), // optional icon\n  actionUrl: text(\"action_url\"), // optional deep link\n  isRead: boolean(\"is_read\").notNull().default(false),\n  priority: varchar(\"priority\", { enum: [\"low\", \"medium\", \"high\"] }).notNull().default(\"medium\"),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const userGoals = pgTable(\"user_goals\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id).unique(), // One goals record per user\n  dailyQuestionGoal: integer(\"daily_question_goal\").notNull().default(10),\n  weeklyStreakGoal: integer(\"weekly_streak_goal\").notNull().default(7),\n  remindersEnabled: boolean(\"reminders_enabled\").notNull().default(false),\n  reminderHour: integer(\"reminder_hour\").notNull().default(19), // 7 PM default\n  quietHoursStart: integer(\"quiet_hours_start\").notNull().default(22), // 10 PM\n  quietHoursEnd: integer(\"quiet_hours_end\").notNull().default(8), // 8 AM\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\nexport const categoryMastery = pgTable(\"category_mastery\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").notNull().references(() => users.id),\n  categoryName: text(\"category_name\").notNull(), // Name of the category (e.g., \"Geography\", \"History\")\n  totalCorrect: integer(\"total_correct\").notNull().default(0), // All-time correct answers in this category\n  totalAnswered: integer(\"total_answered\").notNull().default(0), // All-time questions answered in this category\n  weightedCorrectScore: real(\"weighted_correct_score\").notNull().default(0), // Time-decayed correct answer score (0-100)\n  lastAnswered: timestamp(\"last_answered\"), // When user last answered a question in this category\n  masteryLevel: varchar(\"mastery_level\", { enum: [\"novice\", \"intermediate\", \"advanced\", \"expert\", \"master\"] }).notNull().default(\"novice\"),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\nexport const insertCategorySchema = createInsertSchema(categories).omit({\n  id: true,\n});\n\nexport const insertQuestionSchema = createInsertSchema(questions).omit({\n  id: true,\n});\n\nexport const insertUserProgressSchema = createInsertSchema(userProgress).omit({\n  id: true,\n  answeredAt: true,\n}).extend({\n  selfAssessment: z.enum([\"correct\", \"incorrect\", \"unsure\"]).optional(),\n  mode: z.enum([\"game\", \"rapid_fire\", \"anytime_test\"]).optional(),\n});\n\nexport const insertSpacedRepetitionSchema = createInsertSchema(spacedRepetition).omit({\n  id: true,\n});\n\nexport const insertLearningMaterialSchema = createInsertSchema(learningMaterials).omit({\n  id: true,\n  generatedAt: true,\n});\n\nexport const insertStudyMaterialSchema = createInsertSchema(studyMaterials).omit({\n  id: true,\n  generatedAt: true,\n});\n\nexport const insertTestAttemptSchema = createInsertSchema(testAttempts).omit({\n  id: true,\n  finishedAt: true,\n});\n\nexport const insertAchievementSchema = createInsertSchema(achievements).omit({\n  id: true,\n});\n\nexport const insertUserAchievementSchema = createInsertSchema(userAchievements).omit({\n  id: true,\n  createdAt: true,\n});\n\nexport const insertNotificationSchema = createInsertSchema(notifications).omit({\n  id: true,\n  createdAt: true,\n});\n\n// Add users insert schema\nexport const insertUserSchema = createInsertSchema(users).omit({\n  id: true,\n  createdAt: true,\n  updatedAt: true,\n});\n\nexport const insertUserGoalsSchema = createInsertSchema(userGoals).omit({\n  id: true,\n  updatedAt: true,\n});\n\nexport const insertCategoryMasterySchema = createInsertSchema(categoryMastery).omit({\n  id: true,\n  updatedAt: true,\n});\n\n// Types required for Replit Auth\nexport type UpsertUser = typeof users.$inferInsert;\nexport type User = typeof users.$inferSelect;\nexport type Category = typeof categories.$inferSelect;\nexport type Question = typeof questions.$inferSelect;\nexport type UserProgress = typeof userProgress.$inferSelect;\nexport type SpacedRepetition = typeof spacedRepetition.$inferSelect;\nexport type LearningMaterial = typeof learningMaterials.$inferSelect;\nexport type StudyMaterial = typeof studyMaterials.$inferSelect;\nexport type TestAttempt = typeof testAttempts.$inferSelect;\nexport type Achievement = typeof achievements.$inferSelect;\nexport type UserAchievement = typeof userAchievements.$inferSelect;\nexport type Notification = typeof notifications.$inferSelect;\nexport type UserGoals = typeof userGoals.$inferSelect;\nexport type CategoryMastery = typeof categoryMastery.$inferSelect;\n\nexport type InsertCategory = z.infer<typeof insertCategorySchema>;\nexport type InsertQuestion = z.infer<typeof insertQuestionSchema>;\nexport type InsertUserProgress = z.infer<typeof insertUserProgressSchema>;\nexport type InsertSpacedRepetition = z.infer<typeof insertSpacedRepetitionSchema>;\nexport type InsertLearningMaterial = z.infer<typeof insertLearningMaterialSchema>;\nexport type InsertStudyMaterial = z.infer<typeof insertStudyMaterialSchema>;\nexport type InsertTestAttempt = z.infer<typeof insertTestAttemptSchema>;\nexport type InsertAchievement = z.infer<typeof insertAchievementSchema>;\nexport type InsertUserAchievement = z.infer<typeof insertUserAchievementSchema>;\nexport type InsertNotification = z.infer<typeof insertNotificationSchema>;\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type InsertUserGoals = z.infer<typeof insertUserGoalsSchema>;\nexport type InsertCategoryMastery = z.infer<typeof insertCategoryMasterySchema>;\n\n// Extended types for API responses\nexport type QuestionWithCategory = Question & {\n  category: Category;\n};\n\nexport type QuestionWithLearning = QuestionWithCategory & {\n  learningMaterial?: LearningMaterial;\n};\n\nexport type StudyReview = {\n  correct: QuestionWithLearning[];\n  incorrect: QuestionWithLearning[];\n  unsure: QuestionWithLearning[];\n};\n\nexport type CategoryStats = {\n  categoryId: string;\n  categoryName: string;\n  totalQuestions: number;\n  correctAnswers: number;\n  accuracy: number;\n  averageTime: number;\n};\n\nexport type DailyStats = {\n  date: string;\n  questionsAnswered: number;\n  correctAnswers: number;\n  accuracy: number;\n  studyTime: number;\n};\n\n// Readiness scoring types\nexport type ReadinessComponent = {\n  name: string;\n  score: number;\n  weight: number;\n  description: string;\n};\n\nexport type CategoryCoverage = {\n  categoryId: string;\n  categoryName: string;\n  accuracy: number;\n  recentQuestions: number;\n  weight: number;\n  covered: boolean;\n};\n\nexport type ReadinessScore = {\n  overallScore: number;\n  letterGrade: \"A\" | \"B\" | \"C\" | \"D\" | \"F\";\n  components: ReadinessComponent[];\n  categoryBreadth: {\n    coveredCategories: number;\n    totalCategories: number;\n    requiredCategories: number;\n    breadthFactor: number;\n  };\n  categoryCoverage: CategoryCoverage[];\n  weakCategories: CategoryCoverage[];\n  testReady: boolean;\n  lastUpdated: Date;\n};\n\n// Gamification types\nexport type StreakInfo = {\n  dailyStreak: number;\n  weeklyStreak: number;\n  monthlyStreak: number;\n  longestDailyStreak: number;\n  lastActiveDate: string;\n  todayComplete: boolean;\n  questionsToday: number;\n  goalProgress: number; // percentage toward daily goal\n};\n\nexport type AchievementWithProgress = Achievement & {\n  progress: number;\n  maxProgress: number;\n  isEarned: boolean;\n  earnedAt?: Date;\n  progressPercent: number;\n};\n\nexport type GamificationStats = {\n  totalPoints: number;\n  achievementsEarned: number;\n  totalAchievements: number;\n  currentTier: string;\n  nextTierProgress: number;\n  streakInfo: StreakInfo;\n  recentAchievements: AchievementWithProgress[];\n  unreadNotifications: number;\n};\n\nexport type NotificationWithAction = Notification & {\n  achievementData?: Achievement;\n  canDismiss: boolean;\n  timeAgo: string;\n};\n","size_bytes":14349},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","size_bytes":2695},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n:root {\n  --background: hsl(178, 100%, 93%);\n  --foreground: hsl(201, 87%, 15%);\n  --card: hsl(0 0% 100%);\n  --card-foreground: hsl(201, 87%, 15%);\n  --popover: hsl(0 0% 100%);\n  --popover-foreground: hsl(201, 87%, 15%);\n  --primary: hsl(197, 69%, 31%);\n  --primary-foreground: hsl(0 0% 100%);\n  --secondary: hsl(175, 47%, 60%);\n  --secondary-foreground: hsl(201, 87%, 15%);\n  --muted: hsl(178, 50%, 90%);\n  --muted-foreground: hsl(197, 30%, 40%);\n  --accent: hsl(175, 47%, 60%);\n  --accent-foreground: hsl(201, 87%, 15%);\n  --destructive: hsl(0 84% 60%);\n  --destructive-foreground: hsl(0 0% 100%);\n  --border: hsl(178, 30%, 85%);\n  --input: hsl(178, 30%, 85%);\n  --ring: hsl(197, 69%, 31%);\n  --chart-1: hsl(210 83% 53%);\n  --chart-2: hsl(159.7826 100% 36.0784%);\n  --chart-3: hsl(42.0290 92.8251% 56.2745%);\n  --chart-4: hsl(147.1429 78.5047% 41.9608%);\n  --chart-5: hsl(341.4894 75.2000% 50.9804%);\n  --sidebar: hsl(180 6.6667% 97.0588%);\n  --sidebar-foreground: hsl(210 25% 7.8431%);\n  --sidebar-primary: hsl(203.8863 88.2845% 53.1373%);\n  --sidebar-primary-foreground: hsl(0 0% 100%);\n  --sidebar-accent: hsl(211.5789 51.3514% 92.7451%);\n  --sidebar-accent-foreground: hsl(203.8863 88.2845% 53.1373%);\n  --sidebar-border: hsl(205.0000 25.0000% 90.5882%);\n  --sidebar-ring: hsl(202.8169 89.1213% 53.1373%);\n  --font-sans: 'Roboto', system-ui, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: Menlo, monospace;\n  --radius: 8px;\n  --shadow-2xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 2px 4px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 4px 6px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 8px 10px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n}\n\n.dark {\n  --background: hsl(201, 87%, 15%);\n  --foreground: hsl(178, 100%, 93%);\n  --card: hsl(201, 80%, 18%);\n  --card-foreground: hsl(178, 100%, 93%);\n  --popover: hsl(201, 87%, 15%);\n  --popover-foreground: hsl(178, 100%, 93%);\n  --primary: hsl(175, 47%, 60%);\n  --primary-foreground: hsl(201, 87%, 15%);\n  --secondary: hsl(197, 69%, 31%);\n  --secondary-foreground: hsl(178, 100%, 93%);\n  --muted: hsl(201, 70%, 20%);\n  --muted-foreground: hsl(178, 40%, 70%);\n  --accent: hsl(175, 47%, 60%);\n  --accent-foreground: hsl(201, 87%, 15%);\n  --destructive: hsl(0 84% 60%);\n  --destructive-foreground: hsl(0 0% 100%);\n  --border: hsl(197, 50%, 25%);\n  --input: hsl(197, 50%, 25%);\n  --ring: hsl(175, 47%, 60%);\n  --chart-1: hsl(203.8863 88.2845% 53.1373%);\n  --chart-2: hsl(159.7826 100% 36.0784%);\n  --chart-3: hsl(42.0290 92.8251% 56.2745%);\n  --chart-4: hsl(147.1429 78.5047% 41.9608%);\n  --chart-5: hsl(341.4894 75.2000% 50.9804%);\n  --sidebar: hsl(228 9.8039% 10%);\n  --sidebar-foreground: hsl(0 0% 85.0980%);\n  --sidebar-primary: hsl(202.8169 89.1213% 53.1373%);\n  --sidebar-primary-foreground: hsl(0 0% 100%);\n  --sidebar-accent: hsl(205.7143 70% 7.8431%);\n  --sidebar-accent-foreground: hsl(203.7736 87.6033% 52.5490%);\n  --sidebar-border: hsl(205.7143 15.7895% 26.0784%);\n  --sidebar-ring: hsl(202.8169 89.1213% 53.1373%);\n  --font-sans: 'Roboto', system-ui, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: Menlo, monospace;\n  --radius: 8px;\n  --shadow-2xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 1px 2px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 2px 4px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 4px 6px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00), 0px 8px 10px -1px hsl(202.8169 89.1213% 53.1373% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(202.8169 89.1213% 53.1373% / 0.00);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n@layer utilities {\n  .ripple {\n    @apply relative overflow-hidden;\n  }\n  \n  .ripple:before {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 0;\n    height: 0;\n    border-radius: 50%;\n    background: rgba(255, 255, 255, 0.5);\n    transition: width 0.6s, height 0.6s;\n    transform: translate(-50%, -50%);\n  }\n  \n  .ripple:active:before {\n    width: 300px;\n    height: 300px;\n  }\n\n  /* Jeopardy styling */\n  .jeopardy-gradient {\n    background: linear-gradient(135deg, #1e3a8a 0%, #3730a3 100%);\n  }\n  \n  .gold-gradient {\n    background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 50%, #d97706 100%);\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n  }\n  \n  .question-card {\n    background: linear-gradient(135deg, #1e3a8a 0%, #3730a3 100%);\n    color: white;\n  }\n}\n\n.jeopardy-gradient {\n  background: linear-gradient(135deg, hsl(210 83% 53%) 0%, hsl(240 83% 45%) 100%);\n}\n\n.gold-gradient {\n  background: linear-gradient(135deg, hsl(45 93% 47%) 0%, hsl(35 93% 55%) 100%);\n}\n\n.question-card {\n  min-height: 280px;\n}\n\n.ripple {\n  position: relative;\n  overflow: hidden;\n}\n\n.ripple:before {\n  content: '';\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 0;\n  height: 0;\n  border-radius: 50%;\n  background: rgba(255,255,255,0.5);\n  transform: translate(-50%, -50%);\n  transition: width 0.6s, height 0.6s;\n}\n\n.ripple:active:before {\n  width: 300px;\n  height: 300px;\n}\n","size_bytes":6254},"client/src/components/bottom-navigation.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Home, Brain, BarChart3, Trophy } from \"lucide-react\";\nimport { useLocation } from \"wouter\";\n\ninterface BottomNavigationProps {\n  currentScreen: string;\n  onScreenChange: (screen: string) => void;\n}\n\nexport default function BottomNavigation({ currentScreen, onScreenChange }: BottomNavigationProps) {\n  const [, setLocation] = useLocation();\n  \n  const navItems = [\n    { id: \"game\", icon: Home, label: \"Game\", path: \"/\" },\n    { id: \"study\", icon: Brain, label: \"Study\", path: \"/study\" },\n    { id: \"stats\", icon: BarChart3, label: \"Stats\", path: \"/progress\" },\n    { id: \"achievements\", icon: Trophy, label: \"Achievements\", path: \"/\" },\n  ];\n\n  const handleNavClick = (item: typeof navItems[0]) => {\n    if (item.id === \"study\" || item.id === \"stats\") {\n      setLocation(item.path);\n    } else {\n      onScreenChange(item.id);\n    }\n  };\n\n  return (\n    <nav className=\"fixed bottom-0 left-0 right-0 bg-card border-t border-border shadow-lg\" data-testid=\"bottom-navigation\">\n      <div className=\"flex\">\n        {navItems.map((item) => {\n          const Icon = item.icon;\n          const isActive = currentScreen === item.id;\n          \n          return (\n            <Button\n              key={item.id}\n              variant=\"ghost\"\n              onClick={() => handleNavClick(item)}\n              className=\"flex-1 py-3 px-2 h-auto flex flex-col items-center hover:bg-muted transition-colors\"\n              data-testid={`nav-${item.id}`}\n            >\n              <Icon \n                className={`text-xl mb-1 ${isActive ? 'text-primary' : 'text-muted-foreground'}`} \n                size={20}\n              />\n              <span \n                className={`text-xs ${isActive ? 'text-primary font-medium' : 'text-muted-foreground'}`}\n              >\n                {item.label}\n              </span>\n            </Button>\n          );\n        })}\n      </div>\n    </nav>\n  );\n}\n","size_bytes":1948},"client/src/components/feedback-modal.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Card } from \"@/components/ui/card\";\nimport { Check, X } from \"lucide-react\";\n\ninterface FeedbackModalProps {\n  isVisible: boolean;\n  correct: boolean;\n  answer: string;\n  value: number;\n  onNext: () => void;\n}\n\nexport default function FeedbackModal({ \n  isVisible, \n  correct, \n  answer, \n  value, \n  onNext \n}: FeedbackModalProps) {\n  if (!isVisible) return null;\n\n  return (\n    <div \n      className=\"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50\"\n      data-testid=\"feedback-modal\"\n    >\n      <Card className=\"p-6 max-w-sm w-full shadow-xl\">\n        <div className=\"text-center\">\n          <div className={`w-16 h-16 rounded-full flex items-center justify-center mx-auto mb-4 ${\n            correct ? 'bg-accent' : 'bg-destructive'\n          }`}>\n            {correct ? (\n              <Check className=\"text-2xl text-accent-foreground\" data-testid=\"icon-correct\" />\n            ) : (\n              <X className=\"text-2xl text-destructive-foreground\" data-testid=\"icon-incorrect\" />\n            )}\n          </div>\n          <h3 className=\"text-lg font-bold mb-2\" data-testid=\"text-feedback-title\">\n            {correct ? 'Correct!' : 'Incorrect'}\n          </h3>\n          {correct && (\n            <p className=\"text-muted-foreground mb-4\" data-testid=\"text-points-earned\">\n              You earned ${value}\n            </p>\n          )}\n          <div className=\"text-sm text-muted-foreground mb-4\">\n            <strong>Answer:</strong> <span data-testid=\"text-correct-answer\">{answer}</span>\n          </div>\n          <Button\n            onClick={onNext}\n            className=\"w-full bg-primary text-primary-foreground hover:bg-primary/90\"\n            data-testid=\"button-next-question\"\n          >\n            Next Question\n          </Button>\n        </div>\n      </Card>\n    </div>\n  );\n}\n","size_bytes":1883},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","size_bytes":4120},"server/routes.ts":{"content":"import type { Express } from \"express\";\nimport type { Server } from \"http\";\nimport { storage, initializeStorage } from \"./storage\";\nimport { insertUserProgressSchema, insertSpacedRepetitionSchema, insertLearningMaterialSchema, insertStudyMaterialSchema, insertTestAttemptSchema, insertUserGoalsSchema } from \"@shared/schema\";\nimport { z } from \"zod\";\nimport { perplexityService } from \"./perplexity-service\";\nimport { setupAuth, isAuthenticated, optionalAuth } from \"./replitAuth\";\n\nexport async function registerRoutes(app: Express, server: Server): Promise<void> {\n  // Initialize storage first (critical for production database)\n  console.log(\"üíæ Initializing storage...\");\n  try {\n    await initializeStorage();\n    console.log(\"‚úÖ Storage initialized\");\n  } catch (error) {\n    console.error(\"‚ùå Failed to initialize storage:\", error);\n    throw error;\n  }\n\n  // Auth middleware - set up next\n  console.log(\"üîê Setting up authentication...\");\n  try {\n    await setupAuth(app);\n    console.log(\"‚úÖ Authentication configured\");\n  } catch (error) {\n    console.error(\"‚ùå Failed to setup authentication:\", error);\n    throw error;\n  }\n\n  // Auth routes\n  app.get('/api/auth/user', isAuthenticated, async (req: any, res) => {\n    try {\n      const userId = req.user.claims.sub;\n      const user = await storage.getUser(userId);\n      res.json(user);\n    } catch (error) {\n      console.error(\"Error fetching user:\", error);\n      res.status(500).json({ message: \"Failed to fetch user\" });\n    }\n  });\n  // Categories\n  app.get(\"/api/categories\", async (req, res) => {\n    try {\n      const categories = await storage.getCategories();\n      res.json(categories);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch categories\" });\n    }\n  });\n\n  // Questions\n  app.get(\"/api/questions\", async (req, res) => {\n    try {\n      const { categoryId, value } = req.query;\n      \n      if (categoryId && value) {\n        const question = await storage.getQuestionByValue(categoryId as string, parseInt(value as string));\n        res.json(question);\n      } else if (categoryId) {\n        const questions = await storage.getQuestionsByCategory(categoryId as string);\n        res.json(questions);\n      } else {\n        const questions = await storage.getQuestions();\n        res.json(questions);\n      }\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch questions\" });\n    }\n  });\n\n  // Rapid-fire mode\n  app.get(\"/api/questions/rapid-fire\", async (req, res) => {\n    try {\n      const limit = parseInt(req.query.limit as string) || 10;\n      const categories = req.query.categories ? (req.query.categories as string).split(',') : undefined;\n      const questions = await storage.getRapidFireQuestions(limit, categories);\n      res.json(questions);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch rapid-fire questions\" });\n    }\n  });\n\n  // Get answered questions (only for game mode by default, to keep Anytime Test isolated)\n  app.get(\"/api/answered-questions\", optionalAuth, async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims) {\n        return res.json([]);\n      }\n      const userId = req.user.claims.sub;\n      const answeredQuestions = await storage.getAnsweredQuestions(userId, \"game\");\n      res.json(answeredQuestions);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch answered questions\" });\n    }\n  });\n\n  // Reset game board with new questions\n  app.post(\"/api/reset-board\", optionalAuth, async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims) {\n        return res.json({ message: \"Game board reset successfully\" });\n      }\n      const userId = req.user.claims.sub;\n      await storage.resetGameBoard(userId);\n      res.json({ message: \"Game board reset successfully\" });\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to reset game board\" });\n    }\n  });\n\n  // Clear all progress\n  app.post(\"/api/clear-progress\", optionalAuth, async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims) {\n        return res.json({ message: \"Progress cleared successfully\" });\n      }\n      const userId = req.user.claims.sub;\n      await storage.clearProgress(userId);\n      res.json({ message: \"Progress cleared successfully\" });\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to clear progress\" });\n    }\n  });\n\n  app.get(\"/api/questions/:id\", async (req, res) => {\n    try {\n      const question = await storage.getQuestion(req.params.id);\n      if (!question) {\n        return res.status(404).json({ message: \"Question not found\" });\n      }\n      res.json(question);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch question\" });\n    }\n  });\n\n  // Spaced repetition questions\n  app.get(\"/api/questions/review/next\", async (req, res) => {\n    try {\n      const limit = parseInt(req.query.limit as string) || 10;\n      const questions = await storage.getQuestionsForReview(limit);\n      res.json(questions);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch review questions\" });\n    }\n  });\n\n  // User progress\n  app.post(\"/api/progress\", optionalAuth, async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims) {\n        return res.json({ message: \"Progress not saved (anonymous user)\" });\n      }\n      const userId = req.user.claims.sub;\n      console.log(\"üéØ POST /api/progress called with:\", req.body, \"for user:\", userId);\n      const validatedData = insertUserProgressSchema.parse({\n        ...req.body,\n        userId: userId\n      });\n      const progress = await storage.createUserProgress(validatedData);\n      console.log(\"üìä Progress saved:\", progress);\n      \n      // Update category mastery tracking\n      try {\n        const question = await storage.getQuestion(validatedData.questionId);\n        if (question) {\n          const categories = await storage.getCategories();\n          const category = categories.find(c => c.id === question.categoryId);\n          if (category) {\n            await storage.updateCategoryMastery(\n              userId,\n              category.name,\n              validatedData.correct,\n              new Date()\n            );\n            console.log(\"üìà Category mastery updated for:\", category.name);\n          }\n        }\n      } catch (masteryError) {\n        console.error(\"‚ùå Category mastery update failed:\", masteryError);\n        // Don't fail the entire request if mastery tracking fails\n      }\n      \n      // Update spaced repetition data ONLY for game mode (not anytime_test or rapid_fire)\n      // This keeps Anytime Test isolated from affecting game board questions\n      if (validatedData.mode === 'game') {\n        const srData = await storage.getSpacedRepetitionForQuestion(validatedData.questionId);\n        if (srData) {\n          const { easeFactor, interval, repetitions } = calculateSpacedRepetition(\n            srData.easeFactor,\n            srData.interval,\n            srData.repetitions,\n            validatedData.correct\n          );\n          \n          const nextReview = new Date();\n          nextReview.setDate(nextReview.getDate() + interval);\n          \n          await storage.updateSpacedRepetition(srData.id, {\n            easeFactor,\n            interval,\n            repetitions,\n            nextReview,\n            lastReviewed: new Date(),\n          });\n        }\n      }\n\n      // üö® CRITICAL FIX: Trigger achievement detection after saving progress\n      console.log(\"üèÜ Checking achievements for progress:\", progress.id);\n      try {\n        const notifications = await storage.checkAndAwardAchievements(progress);\n        console.log(\"üéâ Achievement notifications created:\", notifications.length);\n      } catch (achievementError) {\n        console.error(\"‚ùå Achievement detection failed:\", achievementError);\n        // Don't fail the entire request if achievement detection fails\n      }\n\n      // Also trigger full achievement evaluation to update all progress\n      try {\n        await storage.evaluateAchievements();\n        console.log(\"‚úÖ Achievement evaluation completed\");\n      } catch (evaluationError) {\n        console.error(\"‚ùå Achievement evaluation failed:\", evaluationError);\n      }\n      \n      res.json(progress);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ message: \"Invalid data\", errors: error.errors });\n      }\n      console.error(\"‚ùå Progress save failed:\", error);\n      res.status(500).json({ message: \"Failed to save progress\" });\n    }\n  });\n\n  // Statistics\n  app.get(\"/api/stats/categories\", optionalAuth, async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims) {\n        return res.json([]);\n      }\n      const userId = req.user.claims.sub;\n      const stats = await storage.getCategoryStats(userId);\n      res.json(stats);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch category stats\" });\n    }\n  });\n\n  app.get(\"/api/stats/daily\", optionalAuth, async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims) {\n        return res.json([]);\n      }\n      const userId = req.user.claims.sub;\n      const days = parseInt(req.query.days as string) || 7;\n      const stats = await storage.getDailyStats(days, userId);\n      res.json(stats);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch daily stats\" });\n    }\n  });\n\n  app.get(\"/api/stats/overall\", optionalAuth, async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims) {\n        return res.json({ totalQuestions: 0, overallAccuracy: 0, currentStreak: 0, totalStudyTime: 0 });\n      }\n      const userId = req.user.claims.sub;\n      const stats = await storage.getOverallStats(userId);\n      res.json(stats);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch overall stats\" });\n    }\n  });\n\n  // Learning Materials\n  app.post(\"/api/learning-materials\", async (req, res) => {\n    try {\n      const { questionId, userWasCorrect } = req.body;\n      \n      // Check if learning material already exists\n      const existing = await storage.getLearningMaterial(questionId);\n      if (existing) {\n        return res.json(existing);\n      }\n\n      // Get question details\n      const question = await storage.getQuestion(questionId);\n      if (!question) {\n        return res.status(404).json({ message: \"Question not found\" });\n      }\n\n      // Generate explanation using Perplexity\n      const explanation = await perplexityService.generateExplanation(\n        question.text,\n        question.answer,\n        userWasCorrect || false\n      );\n\n      // Save to storage\n      const learningMaterial = await storage.createLearningMaterial({\n        questionId,\n        explanation: explanation.explanation,\n        sources: explanation.sources,\n        relatedFacts: explanation.relatedFacts,\n        commonness: explanation.commonness,\n      });\n\n      res.json(learningMaterial);\n    } catch (error) {\n      console.error('Error generating learning material:', error);\n      res.status(500).json({ message: \"Failed to generate learning material\" });\n    }\n  });\n\n  app.get(\"/api/learning-materials/:questionId\", async (req, res) => {\n    try {\n      const material = await storage.getLearningMaterial(req.params.questionId);\n      if (!material) {\n        return res.status(404).json({ message: \"Learning material not found\" });\n      }\n      res.json(material);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch learning material\" });\n    }\n  });\n\n  // Study Review\n  app.get(\"/api/study-review\", async (req, res) => {\n    try {\n      const review = await storage.getStudyReview();\n      res.json(review);\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch study review\" });\n    }\n  });\n\n  // Study Materials\n  app.get(\"/api/study-materials\", async (req, res) => {\n    try {\n      const { category } = req.query;\n      \n      if (category) {\n        const materials = await storage.getStudyMaterialsByCategory(category as string);\n        res.json(materials);\n      } else {\n        const materials = await storage.getStudyMaterials();\n        res.json(materials);\n      }\n    } catch (error) {\n      res.status(500).json({ message: \"Failed to fetch study materials\" });\n    }\n  });\n\n  app.post(\"/api/study-materials\", async (req, res) => {\n    try {\n      const { category, topic } = req.body;\n      \n      if (!category) {\n        return res.status(400).json({ message: \"Category is required\" });\n      }\n\n      // Generate study material using Perplexity\n      const generatedMaterial = await perplexityService.generateStudyMaterial(category, topic);\n\n      // Save to storage\n      const studyMaterial = await storage.createStudyMaterial({\n        category,\n        title: generatedMaterial.title,\n        content: generatedMaterial.content,\n        sources: generatedMaterial.sources,\n        relatedTopics: generatedMaterial.relatedTopics,\n      });\n\n      res.json(studyMaterial);\n    } catch (error) {\n      console.error('Error generating study material:', error);\n      res.status(500).json({ message: \"Failed to generate study material\" });\n    }\n  });\n\n  // Readiness Score\n  app.get(\"/api/readiness\", async (req, res) => {\n    try {\n      const readinessScore = await storage.getReadinessScore();\n      res.json(readinessScore);\n    } catch (error) {\n      console.error(\"Failed to get readiness score:\", error);\n      res.status(500).json({ message: \"Failed to calculate readiness score\" });\n    }\n  });\n\n  // Category Mastery\n  app.get(\"/api/category-mastery\", optionalAuth, async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims) {\n        return res.json([]);\n      }\n      const userId = req.user.claims.sub;\n      const masteryRecords = await storage.getCategoryMasteryRecords(userId);\n      res.json(masteryRecords);\n    } catch (error) {\n      console.error(\"Failed to get category mastery:\", error);\n      res.status(500).json({ message: \"Failed to fetch category mastery data\" });\n    }\n  });\n\n  // Test Attempts\n  app.post(\"/api/test-attempts\", async (req, res) => {\n    try {\n      const validatedData = insertTestAttemptSchema.parse(req.body);\n      const testAttempt = await storage.createTestAttempt(validatedData);\n      res.json(testAttempt);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        res.status(400).json({ message: \"Invalid test attempt data\", errors: error.errors });\n        return;\n      }\n      console.error(\"Failed to create test attempt:\", error);\n      res.status(500).json({ message: \"Failed to create test attempt\" });\n    }\n  });\n\n  app.get(\"/api/test-attempts\", async (req, res) => {\n    try {\n      const { mode } = req.query;\n      const testAttempts = await storage.getTestAttempts(mode as \"anytime_test\" | undefined);\n      res.json(testAttempts);\n    } catch (error) {\n      console.error(\"Failed to get test attempts:\", error);\n      res.status(500).json({ message: \"Failed to fetch test attempts\" });\n    }\n  });\n\n  // Anytime Test Questions\n  app.get(\"/api/anytime-test-questions\", optionalAuth, async (req: any, res) => {\n    try {\n      const userId = req.user?.claims?.sub;\n      // For anonymous users, pass undefined to get a generic 50-question set\n      // For authenticated users, pass userId to get personalized set\n      const questions = await storage.getAnytimeTestSet(userId);\n      res.json(questions || []);\n    } catch (error) {\n      console.error(\"Failed to get anytime test questions:\", error);\n      // Return empty array instead of 500 error to prevent UI breakage\n      res.json([]);\n    }\n  });\n\n  // ===== GAMIFICATION API ROUTES =====\n\n  // Achievements\n  app.get(\"/api/achievements\", async (req, res) => {\n    try {\n      const achievements = await storage.getAchievements();\n      res.json(achievements);\n    } catch (error) {\n      console.error(\"Failed to get achievements:\", error);\n      res.status(500).json({ message: \"Failed to fetch achievements\" });\n    }\n  });\n\n  app.get(\"/api/achievements/progress\", optionalAuth, async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims) {\n        return res.json([]);\n      }\n      const userId = req.user.claims.sub;\n      const achievementsWithProgress = await storage.getAchievementsWithProgress(userId);\n      res.json(achievementsWithProgress);\n    } catch (error) {\n      console.error(\"Failed to get achievements with progress:\", error);\n      res.status(500).json({ message: \"Failed to fetch achievements with progress\" });\n    }\n  });\n\n  app.get(\"/api/user-achievements\", optionalAuth, async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims) {\n        return res.json([]);\n      }\n      const userId = req.user.claims.sub;\n      const userAchievements = await storage.getUserAchievements(userId);\n      res.json(userAchievements);\n    } catch (error) {\n      console.error(\"Failed to get user achievements:\", error);\n      res.status(500).json({ message: \"Failed to fetch user achievements\" });\n    }\n  });\n\n  // Notifications\n  app.get(\"/api/notifications\", optionalAuth, async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims) {\n        return res.json([]);\n      }\n      const userId = req.user.claims.sub;\n      const { unread } = req.query;\n      const notifications = await storage.getNotifications(unread === 'true', userId);\n      res.json(notifications || []);\n    } catch (error) {\n      console.error(\"Failed to get notifications:\", error);\n      // Return empty array instead of 500 error to prevent UI breakage\n      res.json([]);\n    }\n  });\n\n  app.patch(\"/api/notifications/:id/read\", optionalAuth, async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims) {\n        return res.json({ message: \"Cannot mark notification as read (anonymous user)\" });\n      }\n      const userId = req.user.claims.sub;\n      const { id } = req.params;\n      await storage.markNotificationRead(id, userId);\n      res.json({ message: \"Notification marked as read\" });\n    } catch (error) {\n      console.error(\"Failed to mark notification as read:\", error);\n      res.status(500).json({ message: \"Failed to mark notification as read\" });\n    }\n  });\n\n  app.get(\"/api/notifications/unread-count\", optionalAuth, async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims) {\n        return res.json({ count: 0 });\n      }\n      const userId = req.user.claims.sub;\n      const count = await storage.getUnreadNotificationCount(userId);\n      res.json({ count: count || 0 });\n    } catch (error) {\n      console.error(\"Failed to get unread notification count:\", error);\n      // Return 0 instead of 500 error to prevent UI breakage\n      res.json({ count: 0 });\n    }\n  });\n\n  // User Goals\n  app.get(\"/api/goals\", optionalAuth, async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims) {\n        return res.json(null);\n      }\n      const userId = req.user.claims.sub;\n      const goals = await storage.getUserGoals(userId);\n      res.json(goals);\n    } catch (error) {\n      console.error(\"Failed to get user goals:\", error);\n      res.status(500).json({ message: \"Failed to fetch user goals\" });\n    }\n  });\n\n  app.patch(\"/api/goals\", optionalAuth, async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims) {\n        return res.json({ message: \"Cannot update goals (anonymous user)\" });\n      }\n      const userId = req.user.claims.sub;\n      const validatedData = insertUserGoalsSchema.partial().parse(req.body);\n      const updatedGoals = await storage.updateUserGoals(validatedData, userId);\n      res.json(updatedGoals);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        res.status(400).json({ message: \"Invalid goal data\", errors: error.errors });\n        return;\n      }\n      console.error(\"Failed to update user goals:\", error);\n      res.status(500).json({ message: \"Failed to update user goals\" });\n    }\n  });\n\n  // Streaks and Stats\n  app.get(\"/api/streaks\", optionalAuth, async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims) {\n        return res.json(null);\n      }\n      const userId = req.user.claims.sub;\n      const streakInfo = await storage.getStreakInfo(userId);\n      res.json(streakInfo);\n    } catch (error) {\n      console.error(\"Failed to get streak info:\", error);\n      res.status(500).json({ message: \"Failed to fetch streak info\" });\n    }\n  });\n\n  app.get(\"/api/gamification-stats\", optionalAuth, async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims) {\n        return res.json(null);\n      }\n      const userId = req.user.claims.sub;\n      const stats = await storage.getGamificationStats(userId);\n      res.json(stats);\n    } catch (error) {\n      console.error(\"Failed to get gamification stats:\", error);\n      res.status(500).json({ message: \"Failed to fetch gamification stats\" });\n    }\n  });\n\n  // COST OPTIMIZATION: Consolidated gamification data endpoint\n  app.get(\"/api/gamification/dashboard\", optionalAuth, async (req: any, res) => {\n    try {\n      if (!req.user || !req.user.claims) {\n        return res.json({\n          stats: null,\n          achievements: [],\n          unreadNotificationCount: { count: 0 },\n          userGoals: null\n        });\n      }\n      const userId = req.user.claims.sub;\n      const [\n        stats,\n        achievements,\n        unreadNotificationCount,\n        userGoals\n      ] = await Promise.all([\n        storage.getGamificationStats(userId),\n        storage.getAchievementsWithProgress(userId),\n        storage.getUnreadNotificationCount(userId),\n        storage.getUserGoals(userId)\n      ]);\n\n      res.json({\n        stats,\n        achievements,\n        unreadNotificationCount: { count: unreadNotificationCount },\n        userGoals\n      });\n    } catch (error) {\n      console.error(\"Failed to get consolidated gamification data:\", error);\n      res.status(500).json({ message: \"Failed to fetch gamification dashboard\" });\n    }\n  });\n\n  // Achievement Evaluation (trigger manually or after user actions)\n  app.post(\"/api/evaluate-achievements\", async (req, res) => {\n    try {\n      await storage.evaluateAchievements();\n      res.json({ message: \"Achievement evaluation completed\" });\n    } catch (error) {\n      console.error(\"Failed to evaluate achievements:\", error);\n      res.status(500).json({ message: \"Failed to evaluate achievements\" });\n    }\n  });\n\n  // Award specific achievement (admin/testing endpoint)\n  app.post(\"/api/achievements/:key/award\", async (req, res) => {\n    try {\n      const { key } = req.params;\n      const { progress } = req.body;\n      const result = await storage.awardAchievement(key, progress);\n      \n      if (result) {\n        res.json({ \n          message: \"Achievement awarded successfully\", \n          achievement: result.achievement,\n          notification: result.notification \n        });\n      } else {\n        res.json({ message: \"Achievement not found or already earned\" });\n      }\n    } catch (error) {\n      console.error(\"Failed to award achievement:\", error);\n      res.status(500).json({ message: \"Failed to award achievement\" });\n    }\n  });\n}\n\n// Spaced repetition algorithm (simplified SM-2)\nfunction calculateSpacedRepetition(\n  easeFactor: number,\n  interval: number,\n  repetitions: number,\n  correct: boolean\n): { easeFactor: number; interval: number; repetitions: number } {\n  if (!correct) {\n    return {\n      easeFactor: Math.max(1.3, easeFactor - 0.2),\n      interval: 1,\n      repetitions: 0,\n    };\n  }\n\n  const newRepetitions = repetitions + 1;\n  let newInterval: number;\n  \n  if (newRepetitions === 1) {\n    newInterval = 1;\n  } else if (newRepetitions === 2) {\n    newInterval = 6;\n  } else {\n    newInterval = Math.round(interval * easeFactor);\n  }\n\n  return {\n    easeFactor: Math.max(1.3, easeFactor + (0.1 - (5 - 4) * (0.08 + (5 - 4) * 0.02))),\n    interval: newInterval,\n    repetitions: newRepetitions,\n  };\n}\n","size_bytes":24097},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","size_bytes":140},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","size_bytes":4885},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","size_bytes":261},"client/src/pages/home.tsx":{"content":"import { useState } from \"react\";\nimport GameBoard from \"@/components/game-board\";\nimport QuestionView from \"@/components/question-view\";\nimport RapidFireMode from \"@/components/rapid-fire-mode\";\nimport RapidFireSettings from \"@/components/rapid-fire-settings\";\nimport StatsDashboard from \"@/components/stats-dashboard\";\nimport AchievementGallery from \"@/components/achievement-gallery\";\nimport BottomNavigation from \"@/components/bottom-navigation\";\nimport FeedbackModal from \"@/components/feedback-modal\";\nimport Header from \"@/components/header\";\nimport { GraduationCap, Settings } from \"lucide-react\";\nimport { useQuery } from \"@tanstack/react-query\";\n\ntype Screen = \"game\" | \"question\" | \"rapid-fire\" | \"rapid-fire-settings\" | \"anytime-test\" | \"stats\" | \"achievements\";\n\nexport default function Home() {\n  const [currentScreen, setCurrentScreen] = useState<Screen>(\"game\");\n  const [selectedQuestion, setSelectedQuestion] = useState<string | null>(null);\n  const [showFeedback, setShowFeedback] = useState(false);\n  const [feedbackData, setFeedbackData] = useState<{\n    correct: boolean;\n    answer: string;\n    value: number;\n  } | null>(null);\n  const [rapidFireSettings, setRapidFireSettings] = useState<{\n    selectedCategories: string[];\n    questionCount: number;\n  } | undefined>();\n\n  const { data: overallStats } = useQuery({\n    queryKey: [\"/api/stats/overall\"],\n  });\n\n  const { data: readinessData } = useQuery({\n    queryKey: [\"/api/readiness\"],\n  });\n\n  const handleQuestionSelect = (questionId: string) => {\n    console.log(\"üéØ Question selected:\", questionId);\n    setSelectedQuestion(questionId);\n    setCurrentScreen(\"question\");\n    console.log(\"üîÑ Screen changed to question\");\n  };\n\n  const handleRapidFire = () => {\n    setCurrentScreen(\"rapid-fire-settings\");\n  };\n\n  const handleAnytimeTest = () => {\n    setCurrentScreen(\"anytime-test\");\n  };\n\n  const handleRapidFireStart = (settings: { selectedCategories: string[]; questionCount: number }) => {\n    setRapidFireSettings(settings);\n    setCurrentScreen(\"rapid-fire\");\n  };\n\n  const handleAnswerSubmit = (correct: boolean, answer: string, value: number) => {\n    setFeedbackData({ correct, answer, value });\n    setShowFeedback(true);\n  };\n\n  const handleNextQuestion = () => {\n    setShowFeedback(false);\n    setSelectedQuestion(null);\n    setCurrentScreen(\"game\");\n  };\n\n  const handleScreenChange = (screen: string) => {\n    setCurrentScreen(screen as Screen);\n  };\n\n  const renderScreen = () => {\n    switch (currentScreen) {\n      case \"game\":\n        return <GameBoard onQuestionSelect={handleQuestionSelect} onRapidFire={handleRapidFire} onAnytimeTest={handleAnytimeTest} />;\n      case \"question\":\n        return selectedQuestion ? (\n          <QuestionView \n            questionId={selectedQuestion} \n            onAnswerSubmit={handleAnswerSubmit}\n            onBack={() => setCurrentScreen(\"game\")}\n          />\n        ) : null;\n      case \"rapid-fire-settings\":\n        return <RapidFireSettings onStart={handleRapidFireStart} onBack={() => setCurrentScreen(\"game\")} />;\n      case \"rapid-fire\":\n        return <RapidFireMode settings={rapidFireSettings} onBack={() => setCurrentScreen(\"game\")} />;\n      case \"anytime-test\":\n        return <RapidFireMode isAnytimeTest={true} onBack={() => setCurrentScreen(\"game\")} />;\n      case \"stats\":\n        return <StatsDashboard />;\n      case \"achievements\":\n        return <AchievementGallery />;\n      default:\n        return <GameBoard onQuestionSelect={handleQuestionSelect} onRapidFire={handleRapidFire} onAnytimeTest={handleAnytimeTest} />;\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background\" data-testid=\"main-app\">\n      {/* New Header with Notification Center */}\n      <Header />\n\n      {/* Main Content */}\n      <main className=\"pb-20\">\n        {renderScreen()}\n      </main>\n\n      {/* Bottom Navigation */}\n      <BottomNavigation \n        currentScreen={currentScreen} \n        onScreenChange={handleScreenChange} \n      />\n\n      {/* Feedback Modal */}\n      {showFeedback && feedbackData && (\n        <FeedbackModal\n          isVisible={showFeedback}\n          correct={feedbackData.correct}\n          answer={feedbackData.answer}\n          value={feedbackData.value}\n          onNext={handleNextQuestion}\n        />\n      )}\n    </div>\n  );\n}\n","size_bytes":4323},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","size_bytes":4281},"server/vite.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\nexport async function setupVite(app: Express, server: Server) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(import.meta.dirname, \"public\");\n\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","size_bytes":2263},"client/src/hooks/useAuth.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport type { User } from \"@shared/schema\";\n\nexport function useAuth() {\n  const { data: user, isLoading } = useQuery<User>({\n    queryKey: [\"/api/auth/user\"],\n    retry: false,\n  });\n\n  return {\n    user,\n    isLoading,\n    isAuthenticated: !!user,\n  };\n}","size_bytes":306},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","size_bytes":565},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","size_bytes":4845},"server/opentdb.ts":{"content":"// Integration service for Open Trivia Database API\n// Note: This is NOT authentic Jeopardy data, but general trivia questions\n\ninterface OpenTDBQuestion {\n  category: string;\n  type: \"multiple\" | \"boolean\";\n  difficulty: \"easy\" | \"medium\" | \"hard\";\n  question: string;\n  correct_answer: string;\n  incorrect_answers: string[];\n}\n\ninterface OpenTDBResponse {\n  response_code: number;\n  results: OpenTDBQuestion[];\n}\n\nexport class OpenTDBClient {\n  private baseUrl = 'https://opentdb.com/api.php';\n  private lastRequestTime = 0;\n  private minRequestInterval = 5000; // Open Trivia DB: 1 request per 5 seconds\n  \n  // Retry logic with exponential backoff for rate limiting\n  private async fetchWithRetry<T>(\n    fetchFn: () => Promise<T>, \n    maxRetries: number = 3,\n    baseDelay: number = 2000\n  ): Promise<T> {\n    for (let attempt = 0; attempt <= maxRetries; attempt++) {\n      try {\n        // Rate limiting: wait if needed\n        const now = Date.now();\n        const timeSinceLastRequest = now - this.lastRequestTime;\n        if (timeSinceLastRequest < this.minRequestInterval) {\n          const waitTime = this.minRequestInterval - timeSinceLastRequest;\n          console.log(`‚è±Ô∏è  Rate limiting: waiting ${waitTime}ms before request`);\n          await new Promise(resolve => setTimeout(resolve, waitTime));\n        }\n        \n        this.lastRequestTime = Date.now();\n        const result = await fetchFn();\n        \n        if (attempt > 0) {\n          console.log(`‚úÖ Request succeeded after ${attempt} retries`);\n        }\n        \n        return result;\n      } catch (error: any) {\n        const isLastAttempt = attempt === maxRetries;\n        const isRateLimited = error.message?.includes('429') || error.message?.includes('500');\n        \n        if (isLastAttempt || !isRateLimited) {\n          throw error;\n        }\n        \n        // Exponential backoff: 2s, 4s, 8s\n        const delay = baseDelay * Math.pow(2, attempt);\n        console.warn(`‚ö†Ô∏è  Request failed (attempt ${attempt + 1}/${maxRetries + 1}), retrying in ${delay}ms...`, error.message);\n        await new Promise(resolve => setTimeout(resolve, delay));\n      }\n    }\n    \n    throw new Error('Max retries exceeded');\n  }\n  \n  async getRandomQuestions(count: number = 30): Promise<OpenTDBQuestion[]> {\n    return this.fetchWithRetry(async () => {\n      // Open Trivia DB limits to 50 questions per call\n      const actualCount = Math.min(count, 50);\n      // Only get multiple choice questions (exclude true/false)\n      const response = await fetch(`${this.baseUrl}?amount=${actualCount}&type=multiple`);\n      if (!response.ok) throw new Error(`HTTP ${response.status}`);\n      \n      const data: OpenTDBResponse = await response.json();\n      \n      if (data.response_code !== 0) {\n        throw new Error(`API Error: Code ${data.response_code}`);\n      }\n      \n      // Filter out questions with problematic phrasing for Jeopardy format\n      const filtered = data.results.filter(q => this.isJeopardySuitable(q.question));\n      \n      return filtered;\n    });\n  }\n\n  async getQuestionsByCategory(categoryId: number, count: number = 10): Promise<OpenTDBQuestion[]> {\n    return this.fetchWithRetry(async () => {\n      // Request more questions since we'll filter some out\n      const actualCount = Math.min(count * 2, 50);\n      // Only get multiple choice questions (exclude true/false)\n      const response = await fetch(`${this.baseUrl}?amount=${actualCount}&category=${categoryId}&type=multiple`);\n      if (!response.ok) throw new Error(`HTTP ${response.status}`);\n      \n      const data: OpenTDBResponse = await response.json();\n      \n      if (data.response_code !== 0) {\n        throw new Error(`API Error: Code ${data.response_code}`);\n      }\n      \n      // Filter out questions with problematic phrasing for Jeopardy format\n      const filtered = data.results.filter(q => this.isJeopardySuitable(q.question));\n      \n      // Return requested count\n      return filtered.slice(0, count);\n    });\n  }\n\n  // Check if question is suitable for Jeopardy format (doesn't require seeing multiple choice options)\n  private isJeopardySuitable(question: string): boolean {\n    const problematicPhrases = [\n      'which of the following',\n      'which one of the following',\n      'all of the following except',\n      'which of these',\n      'select all that apply',\n      'which statement is',\n      'which answer',\n      'list the following',\n      'order the following',\n      'arrange the following',\n      'sort the following',\n      'rank the following',\n      'put the following in order',\n      'the following in chronological order',\n    ];\n    \n    const lowerQuestion = question.toLowerCase();\n    return !problematicPhrases.some(phrase => lowerQuestion.includes(phrase));\n  }\n\n  // Convert difficulty to dollar value (Jeopardy-style)\n  getDollarValue(difficulty: string): number {\n    switch (difficulty) {\n      case 'easy': return 200;\n      case 'medium': return 600;\n      case 'hard': return 1000;\n      default: return 400;\n    }\n  }\n\n  // Decode HTML entities in questions/answers\n  decodeHTML(text: string): string {\n    const entities: Record<string, string> = {\n      '&amp;': '&',\n      '&lt;': '<',\n      '&gt;': '>',\n      '&quot;': '\"',\n      '&#039;': \"'\",\n      '&ldquo;': '\"',\n      '&rdquo;': '\"',\n      '&lsquo;': \"'\",\n      '&rsquo;': \"'\",\n      '&ndash;': '‚Äì',\n      '&mdash;': '‚Äî',\n    };\n    \n    // Decode entities multiple times to handle double-encoding\n    let decoded = text;\n    let prevDecoded = '';\n    while (decoded !== prevDecoded) {\n      prevDecoded = decoded;\n      decoded = decoded.replace(/&[^;]+;/g, (entity) => entities[entity] || entity);\n    }\n    \n    return decoded;\n  }\n\n  // Convert Open Trivia DB question to our internal format\n  convertQuestion(question: OpenTDBQuestion): {\n    text: string;\n    answer: string;\n    value: number;\n    difficulty: number;\n    category: string;\n  } {\n    const dollarValue = this.getDollarValue(question.difficulty);\n    \n    return {\n      text: this.decodeHTML(question.question),\n      answer: this.decodeHTML(question.correct_answer),\n      value: dollarValue,\n      difficulty: Math.ceil(dollarValue / 200),\n      category: this.decodeHTML(question.category)\n    };\n  }\n}\n\nexport const openTDBClient = new OpenTDBClient();\n","size_bytes":6328},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","size_bytes":80},"client/src/components/confetti.tsx":{"content":"import { useEffect, useState } from \"react\";\nimport { createPortal } from \"react-dom\";\n\ninterface ConfettiParticle {\n  id: number;\n  x: number;\n  y: number;\n  vx: number;\n  vy: number;\n  color: string;\n  size: number;\n  rotation: number;\n  rotationSpeed: number;\n  shape: \"square\" | \"circle\" | \"triangle\";\n}\n\ninterface ConfettiProps {\n  isActive: boolean;\n  duration?: number;\n  particleCount?: number;\n  colors?: string[];\n  onComplete?: () => void;\n}\n\nexport default function Confetti({ \n  isActive, \n  duration = 3000, \n  particleCount = 100, \n  colors = [\"#FFD700\", \"#FF6B6B\", \"#4ECDC4\", \"#45B7D1\", \"#96CEB4\", \"#FECA57\", \"#FF9FF3\", \"#54A0FF\"],\n  onComplete \n}: ConfettiProps) {\n  const [particles, setParticles] = useState<ConfettiParticle[]>([]);\n  const [isAnimating, setIsAnimating] = useState(false);\n\n  const createParticle = (index: number): ConfettiParticle => {\n    const shapes: (\"square\" | \"circle\" | \"triangle\")[] = [\"square\", \"circle\", \"triangle\"];\n    \n    return {\n      id: index,\n      x: Math.random() * window.innerWidth,\n      y: -20,\n      vx: (Math.random() - 0.5) * 6, // Horizontal velocity\n      vy: Math.random() * 3 + 2, // Vertical velocity\n      color: colors[Math.floor(Math.random() * colors.length)],\n      size: Math.random() * 8 + 4,\n      rotation: Math.random() * 360,\n      rotationSpeed: (Math.random() - 0.5) * 10,\n      shape: shapes[Math.floor(Math.random() * shapes.length)]\n    };\n  };\n\n  useEffect(() => {\n    if (!isActive) {\n      setParticles([]);\n      setIsAnimating(false);\n      return;\n    }\n\n    setIsAnimating(true);\n    \n    // Create initial particles\n    const initialParticles = Array.from({ length: particleCount }, (_, i) => createParticle(i));\n    setParticles(initialParticles);\n\n    // Animation loop\n    let animationId: number;\n    let startTime = Date.now();\n\n    const animate = () => {\n      const currentTime = Date.now();\n      const elapsed = currentTime - startTime;\n\n      if (elapsed > duration) {\n        setParticles([]);\n        setIsAnimating(false);\n        onComplete?.();\n        return;\n      }\n\n      setParticles(prevParticles => \n        prevParticles\n          .map(particle => ({\n            ...particle,\n            x: particle.x + particle.vx,\n            y: particle.y + particle.vy,\n            vy: particle.vy + 0.2, // Gravity\n            rotation: particle.rotation + particle.rotationSpeed\n          }))\n          .filter(particle => particle.y < window.innerHeight + 50) // Remove particles that fall off screen\n      );\n\n      animationId = requestAnimationFrame(animate);\n    };\n\n    animationId = requestAnimationFrame(animate);\n\n    return () => {\n      if (animationId) {\n        cancelAnimationFrame(animationId);\n      }\n    };\n  }, [isActive, duration, particleCount, colors, onComplete]);\n\n  if (!isAnimating || particles.length === 0) return null;\n\n  const ParticleShape = ({ particle }: { particle: ConfettiParticle }) => {\n    const baseStyle = {\n      position: \"absolute\" as const,\n      left: `${particle.x}px`,\n      top: `${particle.y}px`,\n      width: `${particle.size}px`,\n      height: `${particle.size}px`,\n      backgroundColor: particle.color,\n      transform: `rotate(${particle.rotation}deg)`,\n      pointerEvents: \"none\" as const,\n    };\n\n    switch (particle.shape) {\n      case \"circle\":\n        return (\n          <div\n            style={{\n              ...baseStyle,\n              borderRadius: \"50%\",\n            }}\n          />\n        );\n      case \"triangle\":\n        return (\n          <div\n            style={{\n              ...baseStyle,\n              width: 0,\n              height: 0,\n              backgroundColor: \"transparent\",\n              borderLeft: `${particle.size / 2}px solid transparent`,\n              borderRight: `${particle.size / 2}px solid transparent`,\n              borderBottom: `${particle.size}px solid ${particle.color}`,\n            }}\n          />\n        );\n      default: // square\n        return <div style={baseStyle} />;\n    }\n  };\n\n  return createPortal(\n    <div \n      className=\"fixed inset-0 pointer-events-none z-[9999]\"\n      style={{ overflow: \"hidden\" }}\n    >\n      {particles.map(particle => (\n        <ParticleShape key={particle.id} particle={particle} />\n      ))}\n    </div>,\n    document.body\n  );\n}\n\n// Different celebration styles for different achievement tiers\nexport function BronzeConfetti(props: Omit<ConfettiProps, \"colors\">) {\n  return (\n    <Confetti\n      {...props}\n      colors={[\"#CD7F32\", \"#D2691E\", \"#B87333\", \"#A0522D\"]}\n      particleCount={50}\n    />\n  );\n}\n\nexport function SilverConfetti(props: Omit<ConfettiProps, \"colors\">) {\n  return (\n    <Confetti\n      {...props}\n      colors={[\"#C0C0C0\", \"#A8A8A8\", \"#D3D3D3\", \"#E5E5E5\"]}\n      particleCount={75}\n    />\n  );\n}\n\nexport function GoldConfetti(props: Omit<ConfettiProps, \"colors\">) {\n  return (\n    <Confetti\n      {...props}\n      colors={[\"#FFD700\", \"#FFA500\", \"#FFFF00\", \"#DAA520\"]}\n      particleCount={100}\n    />\n  );\n}\n\nexport function PlatinumConfetti(props: Omit<ConfettiProps, \"colors\">) {\n  return (\n    <Confetti\n      {...props}\n      colors={[\"#E5E4E2\", \"#FFFFFF\", \"#C0C0C0\", \"#BCC6CC\", \"#98FB98\"]}\n      particleCount={150}\n      duration={5000}\n    />\n  );\n}","size_bytes":5235},"replit.md":{"content":"# The Daily Double Down\n\n## Project Overview\nA comprehensive trivia training application featuring optional Google login authentication via Replit Auth, spaced repetition learning, dynamic question data, sophisticated gamification, and comprehensive performance tracking. Users can access the game board immediately without login, with optional authentication for progress tracking and advanced features.\n\n## Core Features\n- Dynamic trivia questions from Open Trivia Database API\n- Spaced repetition learning algorithm based on scientific principles\n- Category performance tracking and improvement analytics\n- Jeopardy-style dollar value system (200-1000)\n- Mobile-first responsive design\n\n## User Preferences\n- Focus on accuracy and authenticity of questions/answers\n- Importance of appropriate difficulty matching dollar values\n- Scientific approach to spaced repetition learning\n- Performance improvement tracking emphasis\n\n## Technical Architecture\n- Frontend: React with Vite, TypeScript, Tailwind CSS, shadcn/ui\n- Backend: Express.js with TypeScript\n- Database: PostgreSQL (Neon) with Drizzle ORM\n- Storage: Dual implementation (MemStorage for dev, DbStorage for production)\n  - Feature flag: `USE_DB_STORAGE=true` or `NODE_ENV=production` enables database storage\n  - Questions stored globally in database, shared across all users\n  - User progress, achievements, and spaced repetition data scoped per user\n- Data Sources: Open Trivia Database API (opentdb.com)\n- Algorithms: Spaced repetition (SM-2 or similar)\n\n## Data Quality Measures\n- Questions sourced from Open Trivia Database\n- HTML entity decoding for clean display\n- **Global difficulty sorting** - All 50 questions sorted by difficulty, first 30 distributed across board\n- Dollar value assignment guarantees easy questions at $200, hard at $1000\n- Category diversity in question selection\n\n## Recent Changes\n- **‚úÖ CRITICAL: Fixed production deployment health checks** - Completely refactored server startup sequence to fix health check failures. Server now listens on port 5000 IMMEDIATELY before initialization, then runs storage/route setup in background. Root `/` endpoint ALWAYS returns 200 for deployment health checks (HEAD and GET requests). Added `/healthz` endpoint for detailed readiness status. Implemented smart routing that serves health checks during initialization and React app once ready. Error handling logs failures without crashing server. All tests passing - ready for production deployment. (2025-11-07)\n- **‚úÖ Anonymous user answered question tracking** - Created `useAnsweredQuestions` hook that tracks answered questions in sessionStorage for anonymous users and fetches from server for authenticated users. Anonymous users now see visual feedback (checkmarks, disabled state) when answering questions, with progress persisting during browser session. (2025-11-07)\n- **‚úÖ Anytime Test for anonymous users** - Modified `/api/anytime-test-questions` endpoint to serve 50 random questions for both anonymous and authenticated users. Anonymous users get generic question set, authenticated users get personalized set excluding previously answered questions. (2025-11-07)\n- **‚úÖ CRITICAL: Fixed OAuth authentication for production** - Replaced static domain-based strategy registration with dynamic on-demand registration using `ensureStrategy()` helper. OAuth strategies now register automatically for any domain (dev/production/custom) at runtime, fixing \"invalid_grant\" errors. Enabled session table auto-creation (`createTableIfMissing: true`) to prevent session storage failures in production. Authentication now works seamlessly across all environments. (2025-10-29)\n- **‚úÖ CRITICAL: Fixed production deployment failures** - DbStorage was missing `getCategoryMasteryRecords` and `updateCategoryMastery` methods added for mastery-based readiness system, causing service unavailable errors in production. Implemented both methods with database queries and added fallback protection for timing edge cases. Production deployments now fully functional. (2025-10-29)\n- **‚úÖ Optional authentication system** - Removed login gate to allow anonymous users immediate access to game board. Created `optionalAuth` middleware and updated 20+ routes to work without authentication. Anonymous users can play questions but don't get progress tracking. Authenticated users get full features (stats, achievements, notifications, progress persistence). Header shows \"Sign In\" button for anonymous users, user profile dropdown for authenticated users. Testing confirmed both flows work correctly. (2025-10-29)\n- **‚úÖ Category diversity system** - Implemented topic grouping and diversity quotas to prevent 5 Entertainment + 1 other category boards. Categories now grouped into Entertainment (10 subcategories), Science (4 subcategories), and General (10 topics). Selection enforces max 2 Entertainment, max 1 Science, ensuring 3-4 categories from diverse General topics like History, Geography, Sports, Mythology, Art, Animals, etc. Testing confirmed reduction from 5/6 Entertainment to 2/6, with broad topic coverage. (2025-10-29)\n- **‚úÖ Enhanced Jeopardy-style question filtering** - Expanded isJeopardySuitable() to filter out ordering/listing questions that require multiple choice options: \"list the following\", \"order the following\", \"arrange/sort/rank the following\", \"put the following in order\", \"the following in chronological order\". Prevents questions like \"List the following Iranic empires in chronological order\" which are unanswerable as standalone clues. (2025-10-29)\n- **‚úÖ CRITICAL: Fixed ES module import bug** - Replaced CommonJS `require()` calls with ES6 `import` statements in server/storage.ts mastery calculation functions. Previous code caused \"ReferenceError: require is not defined\" preventing category mastery from being saved. Fix validated with full e2e testing (4 questions answered, category mastery tracking confirmed, readiness calculation working). (2025-10-29)\n- **‚úÖ CRITICAL: Mastery-based readiness system** - Complete overhaul of readiness calculation from old formula (60% Anytime Test + 25% Game Mode + 15% Spaced Repetition) to new category mastery system (60% Category Mastery + 20% Breadth + 20% Anytime Test). Requires ~50 time-weighted correct answers per category for mastery. (2025-10-29)\n- **‚úÖ CategoryMastery data model** - Added database table tracking per-category statistics: totalCorrect, totalAnswered, weightedCorrectScore (time-decayed 0-100 scale), masteryLevel (novice/intermediate/advanced/expert/master), lastAnswered. Updates after each answer to maintain accurate category performance metrics. (2025-10-29)\n- **‚úÖ Time decay algorithm** - Implemented normalized exponential decay function reaching exactly 0% at 6 months (180 days). Formula: (e^(-k*days) - e^(-k*180)) / (1 - e^(-k*180)) where k=3/180. Ensures old answers don't contribute to mastery while providing smooth exponential curve. (2025-10-29)\n- **‚úÖ Random category selection** - Game board now randomly selects 6 categories from all 24 Open Trivia DB categories each time board regenerates. Uses Fisher-Yates shuffle with retry logic (max 18 attempts) to ensure 6 successful categories with ‚â•5 questions each. Provides better variety and long-term engagement. (2025-10-29)\n- **‚úÖ CRITICAL: Fixed category-question mismatch bug** - Questions now sorted and selected WITHIN each category (not globally). Each category gets: 2 easy ($200/$400), 1 medium ($600), 2 hard ($800/$1000) questions from its own pool. Geography column now contains only geography questions, History only history, etc. (2025-10-29)\n- **‚úÖ CRITICAL: Fixed initialization race condition** - Added promise-based locking mechanism to prevent concurrent `fetchFreshGameBoard()` calls in both MemStorage and DbStorage. Previously, simultaneous requests to `/api/categories` and `/api/questions` on app load triggered 3+ concurrent API fetches, causing HTTP 429 rate limits and 35+ second load times. Now only one initialization occurs, reducing load time to ~5-8 seconds. (2025-10-28)\n- **‚úÖ PostgreSQL storage migration complete** - Implemented database-backed storage (DbStorage) to fix autoscale 404 errors. Feature flag automatically enables database storage in production (NODE_ENV=production) while keeping in-memory for development. Questions now persist across server instances. (2025-10-14)\n- **‚úÖ Jeopardy-suitable question filtering** - Filters out true/false and \"which of the following\" style questions. Only uses questions that work as standalone Jeopardy clues without requiring multiple choice options. (2025-10-08)\n- **‚úÖ Diverse category implementation** - Now fetches from 6 predefined categories (General Knowledge, History, Geography, Science & Nature, Sports, Art) instead of random questions. Guarantees category variety while maintaining difficulty progression. (2025-10-03)\n- **‚úÖ Fixed difficulty-value correlation** - Refactored to sort ALL questions globally by difficulty before distributing across board. First 30 questions (easiest) assigned sequentially ensures $200 rows get easy questions, $1000 rows get hard questions. Guarantees proper progression. (2025-10-03)\n- **‚ö†Ô∏è CRITICAL: Migrated from jService to Open Trivia DB** - jService.io API permanently shut down (HTTP 410) in October 2025. Replaced with Open Trivia Database for continued functionality. Note: Questions are now general trivia, NOT authentic Jeopardy data. Air dates removed as Open Trivia DB doesn't provide them. (2025-10-03)\n- **Anytime Test isolation fix** - Fixed game board showing Anytime Test questions as completed by filtering answered questions by mode (2025-10-02)\n- **Anytime Test 50-question fix** - Added 20 more questions to seed data (now 50 total), fixed logic to complete all 50 questions (2025-10-02)\n- **Anytime Test isolation** - Test uses different questions from game board, doesn't affect spaced repetition, only Correct/Incorrect options (2025-10-02)\n- **Complete authentication system** - Integrated Replit Auth with Google OAuth, session management, user profiles, logout (2025-09-30)\n- **Rebranded to \"The Daily Double Down\"** - Updated all UI components, page titles, meta tags (2025-09-30)\n- **Ocean-themed color palette** - Applied #04364A, #176B87, #64CCC5, #DAFFFB throughout light/dark modes (2025-09-30)\n- **Anytime Test start screen** - Test now requires explicit user action to begin, no auto-start (2025-09-30)\n- **API cost optimization** - Reduced polling from 5s to event-driven invalidation (80%+ API call reduction)\n- **PostgreSQL database** - Migrated from in-memory storage with user-scoped data\n- Project initialized with classic Jeopardy board layout (2025-08-28)\n- Implemented self-assessment system for main board and rapid-fire mode\n- Added visual indicators for completed questions on game board (color-coded: green ‚úì, red ‚úó, orange ?)\n- Created category selection for rapid-fire mode with customizable question counts\n- Enhanced mobile-responsive design with authentic Jeopardy styling\n- Added reset functionality for completed game boards and rapid-fire sessions\n- Fixed outdated questions and added air date display for time context\n\n## User Preferences\n- Prefers self-assessment over exact text matching for answers\n- Values visual feedback for question completion status\n- Wants category selection options for focused practice\n- Emphasizes knowledge retention over perfect spelling/formatting\n- Requires authentic, current Jeopardy data with proper time context\n- Requests air date information for questions that may become outdated\n- Expects seamless continuation after completing sessions (reset/restart functionality)\n- Prefers Anytime Test to require explicit start action, not auto-start on page load\n- Wants immediate access to game board without forced authentication - login should be optional for progress tracking\n\n## Next Steps\n1. Consider self-hosting jService for authentic Jeopardy data (optional)\n2. Enhance spaced repetition algorithm with performance tracking\n3. Add advanced analytics and progress visualization\n4. Consider implementing Open Trivia DB session tokens to avoid question repetition","size_bytes":12173},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","size_bytes":157},"client/src/components/celebration-system.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport AchievementToast from \"@/components/achievement-toast\";\nimport Confetti, { BronzeConfetti, SilverConfetti, GoldConfetti, PlatinumConfetti } from \"@/components/confetti\";\nimport type { AchievementWithProgress, GamificationStats } from \"@shared/schema\";\n\ninterface CelebrationState {\n  achievement: AchievementWithProgress | null;\n  isToastVisible: boolean;\n  isConfettiActive: boolean;\n}\n\nexport default function CelebrationSystem() {\n  const [celebrationQueue, setCelebrationQueue] = useState<AchievementWithProgress[]>([]);\n  const [currentCelebration, setCurrentCelebration] = useState<CelebrationState>({\n    achievement: null,\n    isToastVisible: false,\n    isConfettiActive: false\n  });\n  \n  const lastEarnedCountRef = useRef<number>(0);\n  const processedAchievementsRef = useRef<Set<string>>(new Set());\n\n  // Monitor achievements for new unlocks - COST OPTIMIZED: Only poll after user actions\n  const { data: achievements = [] } = useQuery<AchievementWithProgress[]>({\n    queryKey: [\"/api/achievements/progress\"],\n    refetchInterval: false, // Only refetch manually after progress\n    staleTime: 30000, // Consider fresh for 30 seconds\n  });\n\n  const { data: gamificationStats } = useQuery<GamificationStats>({\n    queryKey: [\"/api/gamification-stats\"],\n    refetchInterval: false, // Only refetch manually after progress\n    staleTime: 30000, // Consider fresh for 30 seconds\n  });\n\n  // Detect new achievements\n  useEffect(() => {\n    if (!achievements || !achievements.length || !gamificationStats) return;\n\n    const earnedAchievements = achievements.filter(a => a.isEarned);\n    const currentEarnedCount = earnedAchievements.length;\n\n    // Initialize on first load\n    if (lastEarnedCountRef.current === 0) {\n      lastEarnedCountRef.current = currentEarnedCount;\n      // Mark all existing achievements as processed\n      earnedAchievements.forEach(achievement => {\n        processedAchievementsRef.current.add(achievement.id);\n      });\n      return;\n    }\n\n    // Check for new achievements\n    if (currentEarnedCount > lastEarnedCountRef.current) {\n      const newAchievements = earnedAchievements.filter(achievement => \n        !processedAchievementsRef.current.has(achievement.id)\n      );\n\n      if (newAchievements.length > 0) {\n        // Add new achievements to celebration queue\n        setCelebrationQueue(prev => [...prev, ...newAchievements]);\n        \n        // Mark as processed\n        newAchievements.forEach(achievement => {\n          processedAchievementsRef.current.add(achievement.id);\n        });\n      }\n\n      lastEarnedCountRef.current = currentEarnedCount;\n    }\n  }, [achievements, gamificationStats]);\n\n  // Process celebration queue\n  useEffect(() => {\n    if (!currentCelebration.achievement && celebrationQueue.length > 0) {\n      const nextAchievement = celebrationQueue[0];\n      setCelebrationQueue(prev => prev.slice(1));\n      \n      // Start celebration\n      setCurrentCelebration({\n        achievement: nextAchievement,\n        isToastVisible: true,\n        isConfettiActive: true\n      });\n    }\n  }, [currentCelebration.achievement, celebrationQueue]);\n\n  // Handle toast close\n  const handleToastClose = () => {\n    setCurrentCelebration(prev => ({\n      ...prev,\n      isToastVisible: false\n    }));\n  };\n\n  // Handle confetti complete\n  const handleConfettiComplete = () => {\n    setCurrentCelebration(prev => ({\n      ...prev,\n      isConfettiActive: false\n    }));\n    \n    // Clear current celebration after a short delay\n    setTimeout(() => {\n      setCurrentCelebration({\n        achievement: null,\n        isToastVisible: false,\n        isConfettiActive: false\n      });\n    }, 500);\n  };\n\n  // Handle navigation to achievements\n  const handleViewAllAchievements = () => {\n    const event = new CustomEvent('navigate-to-achievements');\n    window.dispatchEvent(event);\n  };\n\n  // Global celebration trigger (for manual testing or other integrations)\n  useEffect(() => {\n    const triggerCelebration = (achievement: AchievementWithProgress) => {\n      setCelebrationQueue(prev => [...prev, achievement]);\n    };\n\n    (window as any).triggerAchievementCelebration = triggerCelebration;\n\n    return () => {\n      delete (window as any).triggerAchievementCelebration;\n    };\n  }, []);\n\n  // Render tier-appropriate confetti\n  const renderConfetti = () => {\n    if (!currentCelebration.isConfettiActive || !currentCelebration.achievement) return null;\n\n    const tier = currentCelebration.achievement.tier.toLowerCase();\n    const confettiProps = {\n      isActive: true,\n      onComplete: handleConfettiComplete\n    };\n\n    switch (tier) {\n      case \"platinum\":\n        return <PlatinumConfetti {...confettiProps} />;\n      case \"gold\":\n        return <GoldConfetti {...confettiProps} />;\n      case \"silver\":\n        return <SilverConfetti {...confettiProps} />;\n      case \"bronze\":\n        return <BronzeConfetti {...confettiProps} />;\n      default:\n        return <Confetti {...confettiProps} />;\n    }\n  };\n\n  return (\n    <>\n      {/* Achievement Toast */}\n      <AchievementToast\n        achievement={currentCelebration.achievement}\n        isVisible={currentCelebration.isToastVisible}\n        onClose={handleToastClose}\n        onViewAll={handleViewAllAchievements}\n      />\n\n      {/* Tier-appropriate Confetti */}\n      {renderConfetti()}\n    </>\n  );\n}\n\n// Achievement celebration provider for the app\ninterface CelebrationProviderProps {\n  children: React.ReactNode;\n}\n\nexport function CelebrationProvider({ children }: CelebrationProviderProps) {\n  const [shouldShowCelebrations, setShouldShowCelebrations] = useState(true);\n\n  // Listen for navigation events\n  useEffect(() => {\n    const handleNavigateToAchievements = () => {\n      // This would trigger navigation to achievements gallery\n      // In a real app, you'd use your router here\n      const achievementsButton = document.querySelector('[data-testid=\"nav-achievements\"]') as HTMLElement;\n      if (achievementsButton) {\n        achievementsButton.click();\n      }\n    };\n\n    window.addEventListener('navigate-to-achievements', handleNavigateToAchievements);\n\n    return () => {\n      window.removeEventListener('navigate-to-achievements', handleNavigateToAchievements);\n    };\n  }, []);\n\n  return (\n    <>\n      {children}\n      {shouldShowCelebrations && <CelebrationSystem />}\n    </>\n  );\n}\n\n// Testing utilities for development\nexport const celebrationTestUtils = {\n  triggerTestCelebration: (tier: \"bronze\" | \"silver\" | \"gold\" | \"platinum\" = \"gold\") => {\n    const testAchievement: AchievementWithProgress = {\n      id: `test-${Date.now()}`,\n      key: \"test_achievement\",\n      name: \"Test Achievement!\",\n      description: \"This is a test achievement to showcase the celebration system\",\n      icon: \"üéâ\",\n      category: \"milestone\",\n      tier,\n      points: tier === \"platinum\" ? 100 : tier === \"gold\" ? 50 : tier === \"silver\" ? 25 : 10,\n      requirements: \"Test achievement\",\n      isHidden: false,\n      isEarned: true,\n      earnedAt: new Date(),\n      progress: 100,\n      maxProgress: 100,\n      progressPercent: 100\n    };\n\n    if ((window as any).triggerAchievementCelebration) {\n      (window as any).triggerAchievementCelebration(testAchievement);\n    }\n  }\n};","size_bytes":7335},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","size_bytes":1584},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","size_bytes":5128},"client/src/components/streak-indicator.tsx":{"content":"import { useState } from \"react\";\nimport { Flame, TrendingUp, Calendar, Target } from \"lucide-react\";\nimport { Card } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { cn } from \"@/lib/utils\";\n\ninterface StreakIndicatorProps {\n  streakValue: number;\n  streakType?: \"daily\" | \"weekly\" | \"monthly\";\n  goalProgress?: number; // 0-100 percentage\n  maxValue?: number; // for progress ring calculation\n  size?: \"small\" | \"medium\" | \"large\";\n  showProgress?: boolean;\n  showLabel?: boolean;\n  animated?: boolean;\n  className?: string;\n  onClick?: () => void;\n}\n\nexport default function StreakIndicator({\n  streakValue,\n  streakType = \"daily\",\n  goalProgress = 0,\n  maxValue,\n  size = \"medium\",\n  showProgress = true,\n  showLabel = true,\n  animated = true,\n  className,\n  onClick\n}: StreakIndicatorProps) {\n  const [isHovered, setIsHovered] = useState(false);\n\n  const getSizeClasses = () => {\n    switch (size) {\n      case \"small\":\n        return {\n          container: \"w-16 h-16\",\n          flame: \"text-2xl\",\n          text: \"text-xs font-bold\",\n          subtext: \"text-xs\",\n          progress: \"stroke-[3]\"\n        };\n      case \"large\":\n        return {\n          container: \"w-24 h-24\",\n          flame: \"text-5xl\",\n          text: \"text-xl font-bold\",\n          subtext: \"text-sm\",\n          progress: \"stroke-[4]\"\n        };\n      default: // medium\n        return {\n          container: \"w-20 h-20\",\n          flame: \"text-3xl\",\n          text: \"text-lg font-bold\",\n          subtext: \"text-sm\",\n          progress: \"stroke-[3]\"\n        };\n    }\n  };\n\n  const getStreakColor = () => {\n    if (streakValue === 0) return \"text-gray-400\";\n    if (streakValue < 3) return \"text-orange-500\";\n    if (streakValue < 7) return \"text-red-500\";\n    if (streakValue < 15) return \"text-red-600\";\n    return \"text-red-700\";\n  };\n\n  const getFlameEmoji = () => {\n    if (streakValue === 0) return \"üå´Ô∏è\";\n    if (streakValue < 3) return \"üî•\";\n    if (streakValue < 7) return \"üî•üî•\";\n    if (streakValue < 15) return \"üî•üî•üî•\";\n    return \"üî•üî•üî•üî•\";\n  };\n\n  const getProgressRingColor = () => {\n    if (streakValue === 0) return \"#9CA3AF\";\n    if (streakValue < 3) return \"#F97316\";\n    if (streakValue < 7) return \"#EF4444\";\n    if (streakValue < 15) return \"#DC2626\";\n    return \"#B91C1C\";\n  };\n\n  const sizeClasses = getSizeClasses();\n  \n  // Calculate progress ring percentage\n  const progressPercent = maxValue \n    ? Math.min((streakValue / maxValue) * 100, 100)\n    : goalProgress;\n\n  const circumference = 2 * Math.PI * 30; // radius of 30\n  const strokeDasharray = circumference;\n  const strokeDashoffset = circumference - (progressPercent / 100) * circumference;\n\n  return (\n    <div\n      className={cn(\n        \"relative flex flex-col items-center justify-center cursor-pointer transition-all duration-300\",\n        animated && isHovered && \"scale-110\",\n        className\n      )}\n      onClick={onClick}\n      onMouseEnter={() => setIsHovered(true)}\n      onMouseLeave={() => setIsHovered(false)}\n      data-testid={`streak-indicator-${streakType}`}\n    >\n      {/* Progress Ring */}\n      {showProgress && (\n        <div className={cn(\"relative\", sizeClasses.container)}>\n          <svg\n            className=\"transform -rotate-90 w-full h-full\"\n            viewBox=\"0 0 70 70\"\n          >\n            {/* Background ring */}\n            <circle\n              cx=\"35\"\n              cy=\"35\"\n              r=\"30\"\n              stroke=\"currentColor\"\n              strokeWidth=\"3\"\n              fill=\"none\"\n              className=\"text-gray-200 dark:text-gray-700\"\n            />\n            {/* Progress ring */}\n            <circle\n              cx=\"35\"\n              cy=\"35\"\n              r=\"30\"\n              stroke={getProgressRingColor()}\n              strokeWidth=\"3\"\n              fill=\"none\"\n              strokeDasharray={strokeDasharray}\n              strokeDashoffset={strokeDashoffset}\n              strokeLinecap=\"round\"\n              className={cn(\n                \"transition-all duration-500 ease-out\",\n                animated && \"animate-pulse\"\n              )}\n            />\n          </svg>\n          \n          {/* Center content */}\n          <div className=\"absolute inset-0 flex flex-col items-center justify-center\">\n            {/* Flame emoji */}\n            <div className={cn(sizeClasses.flame, \"leading-none mb-1\")}>\n              {getFlameEmoji()}\n            </div>\n            \n            {/* Streak number */}\n            <div className={cn(sizeClasses.text, getStreakColor(), \"leading-none\")}>\n              {streakValue}\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Without progress ring (simple version) */}\n      {!showProgress && (\n        <div className={cn(\"flex items-center gap-2\", sizeClasses.container)}>\n          <span className={cn(sizeClasses.flame, \"leading-none\")}>\n            {getFlameEmoji()}\n          </span>\n          <span className={cn(sizeClasses.text, getStreakColor())}>\n            {streakValue}\n          </span>\n        </div>\n      )}\n\n      {/* Label */}\n      {showLabel && (\n        <div className=\"text-center mt-2\">\n          <div className={cn(sizeClasses.subtext, \"text-gray-600 dark:text-gray-400 capitalize font-medium\")}>\n            {streakType} Streak\n          </div>\n          {goalProgress > 0 && (\n            <div className=\"text-xs text-gray-500 mt-1\">\n              {Math.round(goalProgress)}% to goal\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Hover effects */}\n      {isHovered && animated && streakValue > 0 && (\n        <div className=\"absolute inset-0 pointer-events-none\">\n          <div className=\"animate-ping absolute inset-0 rounded-full bg-red-400 opacity-20\" />\n          <div className=\"animate-pulse absolute inset-0 rounded-full bg-orange-400 opacity-30\" />\n        </div>\n      )}\n    </div>\n  );\n}\n\n// Enhanced Streak Card Component\ninterface StreakCardProps {\n  dailyStreak: number;\n  weeklyStreak: number;\n  monthlyStreak: number;\n  longestStreak: number;\n  goalProgress: number;\n  questionsToday: number;\n  todayComplete: boolean;\n}\n\nexport function StreakCard({\n  dailyStreak,\n  weeklyStreak,\n  monthlyStreak,\n  longestStreak,\n  goalProgress,\n  questionsToday,\n  todayComplete\n}: StreakCardProps) {\n  return (\n    <Card className=\"p-6 bg-gradient-to-br from-red-50 to-orange-50 dark:from-red-900/20 dark:to-orange-900/20 border-red-200 dark:border-red-800\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <div className=\"flex items-center gap-2\">\n          <Flame className=\"w-6 h-6 text-red-500\" />\n          <h3 className=\"text-lg font-semibold text-gray-900 dark:text-white\">\n            Streak Overview\n          </h3>\n        </div>\n        {todayComplete && (\n          <Badge className=\"bg-green-500 text-white\">\n            Goal Complete! üéâ\n          </Badge>\n        )}\n      </div>\n\n      {/* Main streak indicators */}\n      <div className=\"grid grid-cols-3 gap-4 mb-6\">\n        <StreakIndicator\n          streakValue={dailyStreak}\n          streakType=\"daily\"\n          goalProgress={goalProgress}\n          size=\"medium\"\n          animated={true}\n        />\n        <StreakIndicator\n          streakValue={weeklyStreak}\n          streakType=\"weekly\"\n          size=\"medium\"\n          animated={true}\n        />\n        <StreakIndicator\n          streakValue={monthlyStreak}\n          streakType=\"monthly\"\n          size=\"medium\"\n          animated={true}\n        />\n      </div>\n\n      {/* Stats row */}\n      <div className=\"grid grid-cols-2 gap-4 text-center\">\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg p-3\">\n          <div className=\"text-2xl font-bold text-red-600 dark:text-red-400\">\n            {longestStreak}\n          </div>\n          <div className=\"text-sm text-gray-600 dark:text-gray-400\">\n            Longest Streak\n          </div>\n        </div>\n        <div className=\"bg-white dark:bg-gray-800 rounded-lg p-3\">\n          <div className=\"text-2xl font-bold text-orange-600 dark:text-orange-400\">\n            {questionsToday}\n          </div>\n          <div className=\"text-sm text-gray-600 dark:text-gray-400\">\n            Questions Today\n          </div>\n        </div>\n      </div>\n\n      {/* Progress to daily goal */}\n      {!todayComplete && (\n        <div className=\"mt-4\">\n          <div className=\"flex items-center justify-between mb-2\">\n            <span className=\"text-sm font-medium text-gray-700 dark:text-gray-300\">\n              Daily Goal Progress\n            </span>\n            <span className=\"text-sm text-gray-500\">\n              {Math.round(goalProgress)}%\n            </span>\n          </div>\n          <Progress value={goalProgress} className=\"h-2 bg-gray-200 dark:bg-gray-700\" />\n        </div>\n      )}\n    </Card>\n  );\n}","size_bytes":8894},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","size_bytes":8605},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","size_bytes":1139},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","size_bytes":3021},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","size_bytes":1642},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport { createServer } from \"http\";\nimport { registerRoutes } from \"./routes\";\nimport { setupVite, serveStatic, log } from \"./vite\";\n\nconst app = express();\napp.use(express.json());\napp.use(express.urlencoded({ extended: false }));\n\n// Readiness flag - gates API routes until initialization completes\nlet isReady = false;\nlet initializationError: Error | null = null;\n\n// Health check endpoint - ALWAYS returns 200 for deployment health checks\n// This is checked by the deployment platform to verify the server is running\napp.head(\"/\", (_req, res) => {\n  res.status(200).end();\n});\n\napp.get(\"/\", (_req, res, next) => {\n  // During initialization, return a simple 200 for health checks\n  // but if it's a browser request (accepts HTML), pass through to static serving\n  const acceptsHtml = _req.accepts('html');\n  \n  if (!isReady && !acceptsHtml) {\n    // Non-browser request during initialization - return simple 200 for health check\n    return res.status(200).json({ status: \"initializing\" });\n  }\n  \n  // Once ready, or if browser request, pass through to static file serving\n  next();\n});\n\n// Alternative health check endpoint\napp.get(\"/healthz\", (_req, res) => {\n  if (isReady) {\n    res.status(200).json({ status: \"ready\" });\n  } else if (initializationError) {\n    res.status(503).json({ \n      status: \"error\", \n      message: initializationError.message \n    });\n  } else {\n    res.status(503).json({ status: \"initializing\" });\n  }\n});\n\n// Global readiness middleware - gates API requests during initialization\napp.use((req, res, next) => {\n  // Skip readiness check for health check endpoints\n  if (req.path === \"/healthz\" || req.path === \"/\") {\n    return next();\n  }\n\n  // Block API requests until initialization completes\n  if (!isReady && req.path.startsWith(\"/api\")) {\n    console.log(`‚è∏Ô∏è  Request blocked during initialization: ${req.method} ${req.path}`);\n    if (initializationError) {\n      return res.status(503).json({ \n        message: \"Service unavailable - initialization failed\",\n        error: initializationError.message \n      });\n    }\n    return res.status(503).json({ \n      message: \"Service initializing - please wait\" \n    });\n  }\n\n  next();\n});\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      if (logLine.length > 80) {\n        logLine = logLine.slice(0, 79) + \"‚Ä¶\";\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n// Create HTTP server immediately\nconst server = createServer(app);\n\n// ALWAYS serve the app on the port specified in the environment variable PORT\n// Other ports are firewalled. Default to 5000 if not specified.\nconst port = parseInt(process.env.PORT || '5000', 10);\n\n// Start listening immediately - BEFORE initialization\nserver.listen({\n  port,\n  host: \"0.0.0.0\",\n  reusePort: true,\n}, () => {\n  log(`serving on port ${port}`);\n  console.log(\"‚úÖ Server listening on port\", port);\n  console.log(\"üöÄ Starting background initialization...\");\n});\n\n// Initialize in background - don't block server startup\n(async () => {\n  try {\n    await registerRoutes(app, server);\n    console.log(\"‚úÖ Routes registered successfully\");\n\n    app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n      const status = err.status || err.statusCode || 500;\n      const message = err.message || \"Internal Server Error\";\n\n      console.error(\"‚ùå Request error:\", { status, message, error: err });\n      res.status(status).json({ message });\n    });\n\n    // importantly only setup vite in development and after\n    // setting up all the other routes so the catch-all route\n    // doesn't interfere with the other routes\n    if (app.get(\"env\") === \"development\") {\n      await setupVite(app, server);\n      console.log(\"‚úÖ Vite development server configured\");\n    } else {\n      serveStatic(app);\n      console.log(\"‚úÖ Static file serving configured\");\n    }\n\n    // Mark as ready\n    isReady = true;\n    console.log(\"‚úÖ Server initialization complete - ready to serve requests\");\n  } catch (error) {\n    console.error(\"üí• Initialization failed:\", error);\n    console.error(\"Error details:\", {\n      message: error instanceof Error ? error.message : \"Unknown error\",\n      stack: error instanceof Error ? error.stack : undefined,\n      error\n    });\n    initializationError = error instanceof Error ? error : new Error(String(error));\n    // Don't exit - keep server running to report unhealthy status\n  }\n})();\n","size_bytes":5048},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","size_bytes":3895},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","size_bytes":7609},"client/src/App.tsx":{"content":"import { Switch, Route } from \"wouter\";\nimport { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { CelebrationProvider } from \"@/components/celebration-system\";\nimport { useAuth } from \"@/hooks/useAuth\";\nimport NotFound from \"@/pages/not-found\";\nimport Home from \"@/pages/home\";\nimport Study from \"@/pages/study\";\nimport Landing from \"@/pages/landing\";\nimport Progress from \"@/pages/progress\";\n\nfunction Router() {\n  return (\n    <Switch>\n      <Route path=\"/\" component={Home} />\n      <Route path=\"/study\" component={Study} />\n      <Route path=\"/progress\" component={Progress} />\n      <Route path=\"/welcome\" component={Landing} />\n      <Route component={NotFound} />\n    </Switch>\n  );\n}\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <CelebrationProvider>\n          <Toaster />\n          <Router />\n        </CelebrationProvider>\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","size_bytes":1147},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","size_bytes":1467},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","size_bytes":1209},"server/db-storage.ts":{"content":"import { eq, and, desc, asc, gte, lte, inArray, sql, not } from 'drizzle-orm';\nimport { db } from './db';\nimport * as schema from '@shared/schema';\nimport type {\n  Category,\n  Question,\n  UserProgress,\n  SpacedRepetition,\n  LearningMaterial,\n  StudyMaterial,\n  TestAttempt,\n  Achievement,\n  UserAchievement,\n  Notification,\n  UserGoals,\n  CategoryMastery,\n  InsertCategory,\n  InsertQuestion,\n  InsertUserProgress,\n  InsertSpacedRepetition,\n  InsertLearningMaterial,\n  InsertStudyMaterial,\n  InsertTestAttempt,\n  InsertAchievement,\n  InsertUserAchievement,\n  InsertNotification,\n  InsertUserGoals,\n  QuestionWithCategory,\n  QuestionWithLearning,\n  StudyReview,\n  CategoryStats,\n  DailyStats,\n  ReadinessScore,\n  StreakInfo,\n  AchievementWithProgress,\n  GamificationStats,\n  NotificationWithAction,\n  UpsertUser,\n  User\n} from '@shared/schema';\nimport type { IStorage } from './storage';\nimport { openTDBClient } from './opentdb';\nimport { calculateWeightedCorrectScore, determineMasteryLevel } from './utils/mastery-calculations';\n\nexport class DbStorage implements IStorage {\n  private initialized = false;\n  private initializationPromise: Promise<void> | null = null;\n\n  constructor() {\n    // Store the initialization promise but don't await it in constructor\n    this.initializationPromise = this.initializeData();\n  }\n\n  async waitForInitialization(): Promise<void> {\n    if (this.initializationPromise) {\n      await this.initializationPromise;\n    }\n  }\n\n  private async initializeData() {\n    try {\n      // Initialize achievements catalog on startup\n      await this.initializeAchievements();\n      \n      // Check if we have questions in the database\n      const existingQuestions = await db.select().from(schema.questions).limit(1);\n      \n      if (existingQuestions.length === 0) {\n        console.log('üîÑ No questions found in database, initializing game board...');\n        await this.fetchFreshGameBoard();\n      } else {\n        console.log('‚úÖ Questions already exist in database');\n        this.initialized = true;\n      }\n    } catch (error) {\n      console.error('üí• Failed to initialize database storage:', error);\n      throw error;\n    }\n  }\n\n  // ==================== USER OPERATIONS ====================\n  \n  async getUser(id: string): Promise<User | undefined> {\n    const [user] = await db.select().from(schema.users).where(eq(schema.users.id, id)).limit(1);\n    return user;\n  }\n\n  async upsertUser(user: UpsertUser): Promise<User> {\n    const [upserted] = await db\n      .insert(schema.users)\n      .values(user)\n      .onConflictDoUpdate({\n        target: schema.users.email,\n        set: {\n          firstName: user.firstName,\n          lastName: user.lastName,\n          profileImageUrl: user.profileImageUrl,\n          updatedAt: new Date(),\n        },\n      })\n      .returning();\n    return upserted;\n  }\n\n  // ==================== CATEGORIES ====================\n  \n  async getCategories(): Promise<Category[]> {\n    return await db.select().from(schema.categories);\n  }\n\n  async createCategory(category: InsertCategory): Promise<Category> {\n    const [created] = await db.insert(schema.categories).values(category).returning();\n    return created;\n  }\n\n  // ==================== QUESTIONS ====================\n  \n  async getQuestions(): Promise<Question[]> {\n    return await db.select().from(schema.questions);\n  }\n\n  async getQuestionsByCategory(categoryId: string): Promise<Question[]> {\n    return await db.select().from(schema.questions).where(eq(schema.questions.categoryId, categoryId));\n  }\n\n  async getRandomQuestionsByCategory(categoryId: string, value: number): Promise<Question[]> {\n    return await db\n      .select()\n      .from(schema.questions)\n      .where(and(eq(schema.questions.categoryId, categoryId), eq(schema.questions.value, value)));\n  }\n\n  async getQuestion(id: string): Promise<QuestionWithCategory | undefined> {\n    const result = await db\n      .select({\n        id: schema.questions.id,\n        categoryId: schema.questions.categoryId,\n        text: schema.questions.text,\n        answer: schema.questions.answer,\n        value: schema.questions.value,\n        difficulty: schema.questions.difficulty,\n        airDate: schema.questions.airDate,\n        jServiceId: schema.questions.jServiceId,\n        category: schema.categories,\n      })\n      .from(schema.questions)\n      .innerJoin(schema.categories, eq(schema.questions.categoryId, schema.categories.id))\n      .where(eq(schema.questions.id, id))\n      .limit(1);\n\n    if (result.length === 0) return undefined;\n    \n    const { category, ...question } = result[0];\n    return { ...question, category };\n  }\n\n  async createQuestion(question: InsertQuestion): Promise<Question> {\n    const [created] = await db.insert(schema.questions).values(question).returning();\n    return created;\n  }\n\n  async getQuestionByValue(categoryId: string, value: number): Promise<QuestionWithCategory | undefined> {\n    const result = await db\n      .select({\n        id: schema.questions.id,\n        categoryId: schema.questions.categoryId,\n        text: schema.questions.text,\n        answer: schema.questions.answer,\n        value: schema.questions.value,\n        difficulty: schema.questions.difficulty,\n        airDate: schema.questions.airDate,\n        jServiceId: schema.questions.jServiceId,\n        category: schema.categories,\n      })\n      .from(schema.questions)\n      .innerJoin(schema.categories, eq(schema.questions.categoryId, schema.categories.id))\n      .where(and(eq(schema.questions.categoryId, categoryId), eq(schema.questions.value, value)))\n      .limit(1);\n\n    if (result.length === 0) return undefined;\n    \n    const { category, ...question } = result[0];\n    return { ...question, category };\n  }\n\n  async getRapidFireQuestions(limit: number = 10, categoryIds?: string[]): Promise<QuestionWithCategory[]> {\n    let query = db\n      .select({\n        id: schema.questions.id,\n        categoryId: schema.questions.categoryId,\n        text: schema.questions.text,\n        answer: schema.questions.answer,\n        value: schema.questions.value,\n        difficulty: schema.questions.difficulty,\n        airDate: schema.questions.airDate,\n        jServiceId: schema.questions.jServiceId,\n        category: schema.categories,\n      })\n      .from(schema.questions)\n      .innerJoin(schema.categories, eq(schema.questions.categoryId, schema.categories.id))\n      .orderBy(sql`RANDOM()`)\n      .limit(limit);\n\n    if (categoryIds && categoryIds.length > 0) {\n      const results = await db\n        .select({\n          id: schema.questions.id,\n          categoryId: schema.questions.categoryId,\n          text: schema.questions.text,\n          answer: schema.questions.answer,\n          value: schema.questions.value,\n          difficulty: schema.questions.difficulty,\n          airDate: schema.questions.airDate,\n          jServiceId: schema.questions.jServiceId,\n          category: schema.categories,\n        })\n        .from(schema.questions)\n        .innerJoin(schema.categories, eq(schema.questions.categoryId, schema.categories.id))\n        .where(inArray(schema.questions.categoryId, categoryIds))\n        .orderBy(sql`RANDOM()`)\n        .limit(limit);\n\n      return results.map(({ category, ...question }) => ({ ...question, category }));\n    }\n\n    const results = await query;\n    return results.map(({ category, ...question }) => ({ ...question, category }));\n  }\n\n  async getAnsweredQuestions(userId?: string): Promise<{ questionId: string; assessment: \"correct\" | \"incorrect\" | \"unsure\" }[]> {\n    if (!userId) return [];\n    \n    const results = await db\n      .select({\n        questionId: schema.userProgress.questionId,\n        selfAssessment: schema.userProgress.selfAssessment,\n      })\n      .from(schema.userProgress)\n      .where(and(\n        eq(schema.userProgress.userId, userId),\n        eq(schema.userProgress.mode, 'game')\n      ));\n\n    return results.map(r => ({\n      questionId: r.questionId,\n      assessment: r.selfAssessment\n    }));\n  }\n\n  async clearProgress(userId?: string): Promise<void> {\n    if (!userId) return;\n    \n    await db.transaction(async (tx) => {\n      await tx.delete(schema.userProgress).where(eq(schema.userProgress.userId, userId));\n      await tx.delete(schema.spacedRepetition).where(eq(schema.spacedRepetition.userId, userId));\n    });\n  }\n\n  async resetGameBoard(userId?: string): Promise<void> {\n    if (!userId) {\n      // Full reset - clear all data and reload from API\n      await db.transaction(async (tx) => {\n        await tx.delete(schema.userProgress);\n        await tx.delete(schema.spacedRepetition);\n        await tx.delete(schema.questions);\n        await tx.delete(schema.categories);\n      });\n      \n      await this.fetchFreshGameBoard();\n    } else {\n      // User-specific reset - just clear their progress\n      await db.transaction(async (tx) => {\n        await tx.delete(schema.userProgress)\n          .where(and(\n            eq(schema.userProgress.userId, userId),\n            eq(schema.userProgress.mode, 'game')\n          ));\n        await tx.delete(schema.spacedRepetition).where(eq(schema.spacedRepetition.userId, userId));\n      });\n    }\n  }\n\n  // ==================== USER PROGRESS ====================\n  \n  async getUserProgress(userId?: string): Promise<UserProgress[]> {\n    if (!userId) return [];\n    return await db.select().from(schema.userProgress).where(eq(schema.userProgress.userId, userId));\n  }\n\n  async createUserProgress(progress: InsertUserProgress): Promise<UserProgress> {\n    const [created] = await db.insert(schema.userProgress).values(progress).returning();\n    return created;\n  }\n\n  async getUserProgressByCategory(categoryId: string, userId?: string): Promise<UserProgress[]> {\n    if (!userId) return [];\n    \n    const results = await db\n      .select({\n        userProgress: schema.userProgress,\n        question: schema.questions,\n      })\n      .from(schema.userProgress)\n      .innerJoin(schema.questions, eq(schema.userProgress.questionId, schema.questions.id))\n      .where(and(\n        eq(schema.userProgress.userId, userId),\n        eq(schema.questions.categoryId, categoryId)\n      ));\n\n    return results.map(r => r.userProgress);\n  }\n\n  // ==================== SPACED REPETITION ====================\n  \n  async getSpacedRepetitionData(): Promise<SpacedRepetition[]> {\n    return await db.select().from(schema.spacedRepetition);\n  }\n\n  async getSpacedRepetitionForQuestion(questionId: string): Promise<SpacedRepetition | undefined> {\n    const [result] = await db\n      .select()\n      .from(schema.spacedRepetition)\n      .where(eq(schema.spacedRepetition.questionId, questionId))\n      .limit(1);\n    return result;\n  }\n\n  async createSpacedRepetition(data: InsertSpacedRepetition): Promise<SpacedRepetition> {\n    const [created] = await db.insert(schema.spacedRepetition).values(data).returning();\n    return created;\n  }\n\n  async updateSpacedRepetition(id: string, data: Partial<SpacedRepetition>): Promise<SpacedRepetition> {\n    const [updated] = await db\n      .update(schema.spacedRepetition)\n      .set(data)\n      .where(eq(schema.spacedRepetition.id, id))\n      .returning();\n    return updated;\n  }\n\n  async getQuestionsForReview(limit: number = 10): Promise<QuestionWithCategory[]> {\n    const now = new Date();\n    \n    const results = await db\n      .select({\n        id: schema.questions.id,\n        categoryId: schema.questions.categoryId,\n        text: schema.questions.text,\n        answer: schema.questions.answer,\n        value: schema.questions.value,\n        difficulty: schema.questions.difficulty,\n        airDate: schema.questions.airDate,\n        jServiceId: schema.questions.jServiceId,\n        category: schema.categories,\n      })\n      .from(schema.spacedRepetition)\n      .innerJoin(schema.questions, eq(schema.spacedRepetition.questionId, schema.questions.id))\n      .innerJoin(schema.categories, eq(schema.questions.categoryId, schema.categories.id))\n      .where(lte(schema.spacedRepetition.nextReview, now))\n      .orderBy(asc(schema.spacedRepetition.nextReview))\n      .limit(limit);\n\n    return results.map(({ category, ...question }) => ({ ...question, category }));\n  }\n\n  // ==================== GAME BOARD INITIALIZATION ====================\n  \n  async fetchFreshGameBoard(): Promise<void> {\n    // If already initialized, return immediately\n    if (this.initialized) {\n      return;\n    }\n\n    // If initialization is in progress, wait for it\n    if (this.initializationPromise) {\n      return this.initializationPromise;\n    }\n\n    // Start initialization and store the promise\n    this.initializationPromise = this._doFetchFreshGameBoard();\n    \n    try {\n      await this.initializationPromise;\n    } finally {\n      // Clear the promise after completion (success or failure)\n      this.initializationPromise = null;\n    }\n  }\n\n  private async _doFetchFreshGameBoard(): Promise<void> {\n    try {\n      console.log('üéØ Fetching fresh game board from Open Trivia DB...');\n      \n      // Define all 24 Open Trivia DB categories\n      const allCategories = [\n        { id: 9, name: 'General Knowledge' },\n        { id: 10, name: 'Entertainment: Books' },\n        { id: 11, name: 'Entertainment: Film' },\n        { id: 12, name: 'Entertainment: Music' },\n        { id: 13, name: 'Entertainment: Musicals & Theatres' },\n        { id: 14, name: 'Entertainment: Television' },\n        { id: 15, name: 'Entertainment: Video Games' },\n        { id: 16, name: 'Entertainment: Board Games' },\n        { id: 17, name: 'Science & Nature' },\n        { id: 18, name: 'Science: Computers' },\n        { id: 19, name: 'Science: Mathematics' },\n        { id: 20, name: 'Mythology' },\n        { id: 21, name: 'Sports' },\n        { id: 22, name: 'Geography' },\n        { id: 23, name: 'History' },\n        { id: 24, name: 'Politics' },\n        { id: 25, name: 'Art' },\n        { id: 26, name: 'Celebrities' },\n        { id: 27, name: 'Animals' },\n        { id: 28, name: 'Vehicles' },\n        { id: 29, name: 'Entertainment: Comics' },\n        { id: 30, name: 'Science: Gadgets' },\n        { id: 31, name: 'Entertainment: Japanese Anime & Manga' },\n        { id: 32, name: 'Entertainment: Cartoon & Animations' }\n      ];\n      \n      // Fisher-Yates shuffle for unbiased randomization\n      const shuffled = [...allCategories];\n      for (let i = shuffled.length - 1; i > 0; i--) {\n        const j = Math.floor(Math.random() * (i + 1));\n        [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];\n      }\n      \n      // Fetch and select questions for each category with retry logic\n      const selectedByCategory: Array<{ categoryName: string; questions: any[] }> = [];\n      const difficultyOrder = { easy: 1, medium: 2, hard: 3 };\n      const maxAttempts = 18; // Try up to 18 categories to get 6 successful ones\n      let attemptedCount = 0;\n      \n      for (const cat of shuffled) {\n        if (selectedByCategory.length >= 6) break; // Got enough categories\n        if (attemptedCount >= maxAttempts) break; // Prevent infinite loop\n        attemptedCount++;\n        \n        try {\n          // Fetch 12 questions from this category\n          const questions = await openTDBClient.getQuestionsByCategory(cat.id, 12);\n          console.log(`   üìö Fetched ${questions.length} Jeopardy-suitable questions from ${cat.name}`);\n          \n          if (questions.length < 5) {\n            console.warn(`   ‚ö†Ô∏è  Not enough questions for ${cat.name}, trying next category...`);\n            continue;\n          }\n          \n          // Sort WITHIN this category by difficulty: easy ‚Üí medium ‚Üí hard\n          const sortedQuestions = [...questions].sort((a, b) => {\n            const orderA = difficultyOrder[a.difficulty as keyof typeof difficultyOrder] || 2;\n            const orderB = difficultyOrder[b.difficulty as keyof typeof difficultyOrder] || 2;\n            return orderA - orderB;\n          });\n          \n          // Select 5 questions spanning difficulty range:\n          // - Positions 0-1: Easy questions ‚Üí $200, $400\n          // - Position 2: Medium question ‚Üí $600\n          // - Positions 3-4: Harder questions ‚Üí $800, $1000\n          const selected = [\n            sortedQuestions[0],  // Easiest ‚Üí $200\n            sortedQuestions[1],  // Easy ‚Üí $400\n            sortedQuestions[Math.floor(sortedQuestions.length / 2)],  // Middle ‚Üí $600\n            sortedQuestions[sortedQuestions.length - 2] || sortedQuestions[sortedQuestions.length - 1],  // Hard ‚Üí $800\n            sortedQuestions[sortedQuestions.length - 1]  // Hardest ‚Üí $1000\n          ];\n          \n          selectedByCategory.push({ categoryName: cat.name, questions: selected });\n          console.log(`   ‚úÖ Selected 5 questions for ${cat.name}: ${selected.filter(q => q.difficulty === 'easy').length} easy, ${selected.filter(q => q.difficulty === 'medium').length} medium, ${selected.filter(q => q.difficulty === 'hard').length} hard`);\n          \n        } catch (error) {\n          console.warn(`   ‚ö†Ô∏è  Failed to fetch ${cat.name}, trying next category...`);\n        }\n      }\n      \n      // Ensure we have enough categories\n      if (selectedByCategory.length < 6) {\n        throw new Error(`Insufficient categories: got ${selectedByCategory.length}, need 6. Tried ${attemptedCount} categories.`);\n      }\n      \n      console.log(`üé≤ Final board categories: ${selectedByCategory.map(c => c.categoryName).join(', ')}`);\n      \n      console.log(`üìù Successfully prepared ${selectedByCategory.length} categories with proper difficulty distribution`);\n      \n      const values = [200, 400, 600, 800, 1000];\n      \n      // Use transaction to ensure atomic operation\n      await db.transaction(async (tx) => {\n        // Clear existing data\n        await tx.delete(schema.spacedRepetition);\n        await tx.delete(schema.questions);\n        await tx.delete(schema.categories);\n        \n        // Assign questions to categories and values\n        for (const catData of selectedByCategory) {\n          // Create category\n          const [category] = await tx.insert(schema.categories).values({\n            name: catData.categoryName,\n            weight: 1.0\n          }).returning();\n          \n          console.log(`   ‚úÖ Created category: ${catData.categoryName}`);\n          \n          // Assign the 5 selected questions to this category\n          // They're already sorted: 2 easy, 1 medium, 2 hard\n          for (let i = 0; i < 5 && i < catData.questions.length; i++) {\n            const tq = catData.questions[i];\n            const converted = openTDBClient.convertQuestion(tq);\n            const assignedValue = values[i];  // $200, $400, $600, $800, $1000\n            \n            const [question] = await tx.insert(schema.questions).values({\n              categoryId: category.id,\n              text: converted.text,\n              answer: converted.answer,\n              value: assignedValue,\n              difficulty: Math.ceil(assignedValue / 200),\n              airDate: null,\n              jServiceId: null\n            }).returning();\n            \n            // Initialize spaced repetition data for system\n            await tx.insert(schema.spacedRepetition).values({\n              userId: \"system\",\n              questionId: question.id,\n              easeFactor: 2.5,\n              interval: 1,\n              repetitions: 0,\n              nextReview: new Date(),\n              lastReviewed: null,\n            });\n          }\n        }\n      });\n      \n      const totalQuestions = await db.select().from(schema.questions);\n      const totalCategories = await db.select().from(schema.categories);\n      console.log(`‚ú® Game board initialized with ${totalQuestions.length} questions from ${totalCategories.length} categories`);\n      \n      this.initialized = true;\n    } catch (error) {\n      console.error('‚ùå Failed to fetch fresh game board:', error);\n      \n      // If not initialized yet and we have no fallback, keep error thrown\n      if (!this.initialized) {\n        throw error;\n      }\n      \n      // If already initialized, keep existing data and log error\n      console.warn('‚ö†Ô∏è  Keeping existing game board due to API error');\n    }\n  }\n\n  // ==================== STUB METHODS (To be implemented) ====================\n  \n  async getLearningMaterial(questionId: string): Promise<LearningMaterial | undefined> {\n    const [result] = await db.select().from(schema.learningMaterials).where(eq(schema.learningMaterials.questionId, questionId)).limit(1);\n    return result;\n  }\n\n  async createLearningMaterial(material: InsertLearningMaterial): Promise<LearningMaterial> {\n    const [created] = await db.insert(schema.learningMaterials).values(material).returning();\n    return created;\n  }\n\n  async getStudyReview(): Promise<StudyReview> {\n    // Stub implementation\n    return {\n      correct: [],\n      incorrect: [],\n      unsure: []\n    };\n  }\n\n  async getStudyMaterials(): Promise<StudyMaterial[]> {\n    return await db.select().from(schema.studyMaterials);\n  }\n\n  async getStudyMaterialsByCategory(category: string): Promise<StudyMaterial[]> {\n    return await db.select().from(schema.studyMaterials).where(eq(schema.studyMaterials.category, category));\n  }\n\n  async createStudyMaterial(material: InsertStudyMaterial): Promise<StudyMaterial> {\n    const [created] = await db.insert(schema.studyMaterials).values(material).returning();\n    return created;\n  }\n\n  async createTestAttempt(attempt: InsertTestAttempt): Promise<TestAttempt> {\n    const [created] = await db.insert(schema.testAttempts).values(attempt).returning();\n    return created;\n  }\n\n  async getTestAttempts(mode?: \"anytime_test\"): Promise<TestAttempt[]> {\n    if (mode) {\n      return await db.select().from(schema.testAttempts).where(eq(schema.testAttempts.mode, mode));\n    }\n    return await db.select().from(schema.testAttempts);\n  }\n\n  async getAnytimeTestSet(userId?: string): Promise<QuestionWithCategory[]> {\n    // Return 50 random questions not answered in \"anytime_test\" mode\n    const answeredInTest = userId ? await db\n      .select({ questionId: schema.userProgress.questionId })\n      .from(schema.userProgress)\n      .where(and(\n        eq(schema.userProgress.userId, userId),\n        eq(schema.userProgress.mode, 'anytime_test')\n      )) : [];\n\n    const answeredIds = answeredInTest.map(a => a.questionId);\n\n    let query = db\n      .select({\n        id: schema.questions.id,\n        categoryId: schema.questions.categoryId,\n        text: schema.questions.text,\n        answer: schema.questions.answer,\n        value: schema.questions.value,\n        difficulty: schema.questions.difficulty,\n        airDate: schema.questions.airDate,\n        jServiceId: schema.questions.jServiceId,\n        category: schema.categories,\n      })\n      .from(schema.questions)\n      .innerJoin(schema.categories, eq(schema.questions.categoryId, schema.categories.id))\n      .orderBy(sql`RANDOM()`)\n      .limit(50);\n\n    if (answeredIds.length > 0) {\n      const results = await db\n        .select({\n          id: schema.questions.id,\n          categoryId: schema.questions.categoryId,\n          text: schema.questions.text,\n          answer: schema.questions.answer,\n          value: schema.questions.value,\n          difficulty: schema.questions.difficulty,\n          airDate: schema.questions.airDate,\n          jServiceId: schema.questions.jServiceId,\n          category: schema.categories,\n        })\n        .from(schema.questions)\n        .innerJoin(schema.categories, eq(schema.questions.categoryId, schema.categories.id))\n        .where(not(inArray(schema.questions.id, answeredIds)))\n        .orderBy(sql`RANDOM()`)\n        .limit(50);\n\n      return results.map(({ category, ...question }) => ({ ...question, category }));\n    }\n\n    const results = await query;\n    return results.map(({ category, ...question }) => ({ ...question, category }));\n  }\n\n  async getReadinessScore(): Promise<ReadinessScore> {\n    // Stub implementation\n    return {\n      overallScore: 0,\n      letterGrade: 'F',\n      components: [],\n      categoryBreadth: {\n        coveredCategories: 0,\n        totalCategories: 0,\n        requiredCategories: 0,\n        breadthFactor: 0\n      },\n      categoryCoverage: [],\n      weakCategories: [],\n      testReady: false,\n      lastUpdated: new Date()\n    };\n  }\n\n  async getCategoryStats(userId?: string): Promise<CategoryStats[]> {\n    if (!userId) return [];\n    \n    const stats = await db\n      .select({\n        categoryId: schema.questions.categoryId,\n        categoryName: schema.categories.name,\n        totalQuestions: sql<number>`count(distinct ${schema.userProgress.questionId})`,\n        correctCount: sql<number>`sum(case when ${schema.userProgress.selfAssessment} = 'correct' then 1 else 0 end)`,\n      })\n      .from(schema.userProgress)\n      .innerJoin(schema.questions, eq(schema.userProgress.questionId, schema.questions.id))\n      .innerJoin(schema.categories, eq(schema.questions.categoryId, schema.categories.id))\n      .where(eq(schema.userProgress.userId, userId))\n      .groupBy(schema.questions.categoryId, schema.categories.name);\n\n    return stats.map(s => ({\n      categoryId: s.categoryId,\n      categoryName: s.categoryName,\n      totalQuestions: Number(s.totalQuestions),\n      correctAnswers: Number(s.correctCount),\n      accuracy: s.totalQuestions > 0 ? (Number(s.correctCount) / Number(s.totalQuestions)) * 100 : 0,\n      averageTime: 0\n    }));\n  }\n\n  async getDailyStats(days: number, userId?: string): Promise<DailyStats[]> {\n    if (!userId) return [];\n    \n    const startDate = new Date();\n    startDate.setDate(startDate.getDate() - days);\n\n    const stats = await db\n      .select({\n        date: sql<string>`date(${schema.userProgress.answeredAt})`,\n        totalQuestions: sql<number>`count(*)`,\n        correctCount: sql<number>`sum(case when ${schema.userProgress.selfAssessment} = 'correct' then 1 else 0 end)`,\n      })\n      .from(schema.userProgress)\n      .where(and(\n        eq(schema.userProgress.userId, userId),\n        gte(schema.userProgress.answeredAt, startDate)\n      ))\n      .groupBy(sql`date(${schema.userProgress.answeredAt})`);\n\n    return stats.map(s => ({\n      date: s.date,\n      questionsAnswered: Number(s.totalQuestions),\n      correctAnswers: Number(s.correctCount),\n      accuracy: s.totalQuestions > 0 ? (Number(s.correctCount) / Number(s.totalQuestions)) * 100 : 0,\n      studyTime: 0\n    }));\n  }\n\n  async getOverallStats(userId?: string): Promise<{\n    totalQuestions: number;\n    overallAccuracy: number;\n    currentStreak: number;\n    totalStudyTime: number;\n  }> {\n    if (!userId) {\n      return {\n        totalQuestions: 0,\n        overallAccuracy: 0,\n        currentStreak: 0,\n        totalStudyTime: 0\n      };\n    }\n\n    const [stats] = await db\n      .select({\n        totalQuestions: sql<number>`count(*)`,\n        correctCount: sql<number>`sum(case when ${schema.userProgress.selfAssessment} = 'correct' then 1 else 0 end)`,\n      })\n      .from(schema.userProgress)\n      .where(eq(schema.userProgress.userId, userId));\n\n    const totalQuestions = Number(stats?.totalQuestions || 0);\n    const correctCount = Number(stats?.correctCount || 0);\n\n    return {\n      totalQuestions,\n      overallAccuracy: totalQuestions > 0 ? (correctCount / totalQuestions) * 100 : 0,\n      currentStreak: 0,\n      totalStudyTime: 0\n    };\n  }\n\n  // ==================== ACHIEVEMENTS (Stub implementations) ====================\n  \n  private async initializeAchievements() {\n    const achievementData: InsertAchievement[] = [\n      {\n        key: \"first_clue\",\n        name: \"First Clue! üéØ\",\n        description: \"Answer your very first Jeopardy question\",\n        icon: \"üéØ\",\n        category: \"milestone\",\n        tier: \"bronze\",\n        points: 10,\n        requirements: JSON.stringify({ totalQuestions: 1 })\n      },\n      {\n        key: \"getting_started\", \n        name: \"Getting Started üìö\",\n        description: \"Answer 5 questions correctly\",\n        icon: \"üìö\",\n        category: \"milestone\", \n        tier: \"bronze\",\n        points: 25,\n        requirements: JSON.stringify({ correctAnswers: 5 })\n      },\n      {\n        key: \"quiz_enthusiast\",\n        name: \"Quiz Enthusiast üß†\", \n        description: \"Answer 25 questions total\",\n        icon: \"üß†\",\n        category: \"milestone\",\n        tier: \"silver\", \n        points: 50,\n        requirements: JSON.stringify({ totalQuestions: 25 })\n      },\n    ];\n\n    for (const achievement of achievementData) {\n      await db\n        .insert(schema.achievements)\n        .values(achievement)\n        .onConflictDoUpdate({\n          target: schema.achievements.key,\n          set: achievement\n        });\n    }\n  }\n\n  async getAchievements(): Promise<Achievement[]> {\n    return await db.select().from(schema.achievements);\n  }\n\n  async createAchievement(achievement: InsertAchievement): Promise<Achievement> {\n    const [created] = await db.insert(schema.achievements).values(achievement).returning();\n    return created;\n  }\n\n  async getUserAchievements(userId?: string): Promise<UserAchievement[]> {\n    if (!userId) return [];\n    return await db.select().from(schema.userAchievements).where(eq(schema.userAchievements.userId, userId));\n  }\n\n  async getUserAchievementByKey(key: string, userId?: string): Promise<UserAchievement | undefined> {\n    if (!userId) return undefined;\n    const [result] = await db\n      .select()\n      .from(schema.userAchievements)\n      .where(and(\n        eq(schema.userAchievements.userId, userId),\n        eq(schema.userAchievements.achievementKey, key)\n      ))\n      .limit(1);\n    return result;\n  }\n\n  async createUserAchievement(userAchievement: InsertUserAchievement): Promise<UserAchievement> {\n    const [created] = await db.insert(schema.userAchievements).values(userAchievement).returning();\n    return created;\n  }\n\n  async updateUserAchievement(id: string, data: Partial<UserAchievement>): Promise<UserAchievement> {\n    const [updated] = await db\n      .update(schema.userAchievements)\n      .set(data)\n      .where(eq(schema.userAchievements.id, id))\n      .returning();\n    return updated;\n  }\n\n  async getAchievementsWithProgress(userId?: string): Promise<AchievementWithProgress[]> {\n    // Stub implementation\n    const achievements = await this.getAchievements();\n    return achievements.map(a => ({\n      ...a,\n      progress: 0,\n      maxProgress: 1,\n      isEarned: false,\n      earnedAt: undefined,\n      progressPercent: 0\n    }));\n  }\n\n  async awardAchievement(achievementKey: string, progress?: number, userId?: string): Promise<{ achievement: Achievement; notification: Notification } | null> {\n    // Stub implementation\n    return null;\n  }\n\n  async getNotifications(unreadOnly?: boolean, userId?: string): Promise<NotificationWithAction[]> {\n    if (!userId) return [];\n    \n    let query = db\n      .select()\n      .from(schema.notifications)\n      .where(eq(schema.notifications.userId, userId))\n      .orderBy(desc(schema.notifications.createdAt));\n\n    if (unreadOnly) {\n      const results = await db\n        .select()\n        .from(schema.notifications)\n        .where(and(\n          eq(schema.notifications.userId, userId),\n          eq(schema.notifications.isRead, false)\n        ))\n        .orderBy(desc(schema.notifications.createdAt));\n\n      return results.map(n => ({ \n        ...n, \n        timeAgo: this.formatTimeAgo(n.createdAt),\n        canDismiss: true\n      }));\n    }\n\n    const results = await query;\n    return results.map(n => ({ \n      ...n, \n      timeAgo: this.formatTimeAgo(n.createdAt),\n      canDismiss: true\n    }));\n  }\n\n  async createNotification(notification: InsertNotification): Promise<Notification> {\n    const [created] = await db.insert(schema.notifications).values(notification).returning();\n    return created;\n  }\n\n  async markNotificationRead(id: string, userId?: string): Promise<void> {\n    if (!userId) return;\n    \n    await db\n      .update(schema.notifications)\n      .set({ isRead: true })\n      .where(and(\n        eq(schema.notifications.id, id),\n        eq(schema.notifications.userId, userId)\n      ));\n  }\n\n  async getUnreadNotificationCount(userId?: string): Promise<number> {\n    if (!userId) return 0;\n    \n    const [result] = await db\n      .select({ count: sql<number>`count(*)` })\n      .from(schema.notifications)\n      .where(and(\n        eq(schema.notifications.userId, userId),\n        eq(schema.notifications.isRead, false)\n      ));\n\n    return Number(result?.count || 0);\n  }\n\n  async getUserGoals(userId?: string): Promise<UserGoals> {\n    if (!userId) {\n      return {\n        id: '',\n        userId: '',\n        dailyQuestionGoal: 10,\n        weeklyStreakGoal: 7,\n        remindersEnabled: false,\n        reminderHour: 19,\n        quietHoursStart: 22,\n        quietHoursEnd: 8,\n        updatedAt: new Date()\n      };\n    }\n\n    const [result] = await db\n      .select()\n      .from(schema.userGoals)\n      .where(eq(schema.userGoals.userId, userId))\n      .limit(1);\n\n    if (!result) {\n      // Create default goals\n      const [created] = await db\n        .insert(schema.userGoals)\n        .values({\n          userId,\n          dailyQuestionGoal: 10,\n          weeklyStreakGoal: 7,\n          remindersEnabled: false,\n          reminderHour: 19,\n          quietHoursStart: 22,\n          quietHoursEnd: 8\n        })\n        .returning();\n      return created;\n    }\n\n    return result;\n  }\n\n  async updateUserGoals(goals: Partial<InsertUserGoals>, userId?: string): Promise<UserGoals> {\n    if (!userId) {\n      throw new Error('User ID required');\n    }\n\n    const [updated] = await db\n      .update(schema.userGoals)\n      .set({ ...goals, updatedAt: new Date() })\n      .where(eq(schema.userGoals.userId, userId))\n      .returning();\n\n    return updated;\n  }\n\n  async getStreakInfo(userId?: string): Promise<StreakInfo> {\n    // Stub implementation\n    return {\n      dailyStreak: 0,\n      weeklyStreak: 0,\n      monthlyStreak: 0,\n      longestDailyStreak: 0,\n      lastActiveDate: new Date().toISOString(),\n      todayComplete: false,\n      questionsToday: 0,\n      goalProgress: 0\n    };\n  }\n\n  async getGamificationStats(userId?: string): Promise<GamificationStats> {\n    // Stub implementation\n    const streakInfo = await this.getStreakInfo(userId);\n    return {\n      totalPoints: 0,\n      achievementsEarned: 0,\n      totalAchievements: 0,\n      currentTier: 'bronze',\n      nextTierProgress: 0,\n      streakInfo,\n      recentAchievements: [],\n      unreadNotifications: 0\n    };\n  }\n\n  async checkAndAwardAchievements(progressData: UserProgress): Promise<Notification[]> {\n    // Stub implementation\n    return [];\n  }\n\n  async evaluateAchievements(): Promise<void> {\n    // Stub implementation\n  }\n\n  // ==================== CATEGORY MASTERY ====================\n  \n  async getCategoryMasteryRecords(userId?: string): Promise<CategoryMastery[]> {\n    if (!userId) return [];\n    \n    return await db\n      .select()\n      .from(schema.categoryMastery)\n      .where(eq(schema.categoryMastery.userId, userId));\n  }\n\n  async updateCategoryMastery(\n    userId: string,\n    categoryName: string,\n    isCorrect: boolean,\n    answeredAt: Date\n  ): Promise<CategoryMastery> {\n    // Find existing record\n    const [existing] = await db\n      .select()\n      .from(schema.categoryMastery)\n      .where(and(\n        eq(schema.categoryMastery.userId, userId),\n        eq(schema.categoryMastery.categoryName, categoryName)\n      ))\n      .limit(1);\n    \n    if (!existing) {\n      // Create new record\n      const [created] = await db\n        .insert(schema.categoryMastery)\n        .values({\n          userId,\n          categoryName,\n          totalCorrect: isCorrect ? 1 : 0,\n          totalAnswered: 1,\n          weightedCorrectScore: 0,\n          lastAnswered: answeredAt,\n          masteryLevel: 'novice'\n        })\n        .returning();\n      \n      // Recalculate weighted score\n      return await this.recalculateCategoryMastery(created.id, userId, categoryName);\n    }\n    \n    // Update existing record\n    const [updated] = await db\n      .update(schema.categoryMastery)\n      .set({\n        totalAnswered: existing.totalAnswered + 1,\n        totalCorrect: existing.totalCorrect + (isCorrect ? 1 : 0),\n        lastAnswered: answeredAt,\n        updatedAt: new Date()\n      })\n      .where(eq(schema.categoryMastery.id, existing.id))\n      .returning();\n    \n    // Recalculate weighted score\n    return await this.recalculateCategoryMastery(updated.id, userId, categoryName);\n  }\n\n  private async recalculateCategoryMastery(\n    recordId: string,\n    userId: string,\n    categoryName: string\n  ): Promise<CategoryMastery> {\n    // Get the current mastery record to access counts\n    const [currentRecord] = await db\n      .select()\n      .from(schema.categoryMastery)\n      .where(eq(schema.categoryMastery.id, recordId))\n      .limit(1);\n    \n    if (!currentRecord) {\n      throw new Error('Category mastery record not found');\n    }\n    \n    // Get all answers for this category\n    const categoryAnswers = await db\n      .select({\n        correct: schema.userProgress.correct,\n        answeredAt: schema.userProgress.answeredAt\n      })\n      .from(schema.userProgress)\n      .innerJoin(schema.questions, eq(schema.userProgress.questionId, schema.questions.id))\n      .innerJoin(schema.categories, eq(schema.questions.categoryId, schema.categories.id))\n      .where(and(\n        eq(schema.userProgress.userId, userId),\n        eq(schema.categories.name, categoryName)\n      ));\n    \n    // Calculate weighted score using time decay\n    // Use the authoritative 'correct' field, not selfAssessment\n    let weightedScore = 0;\n    if (categoryAnswers.length > 0) {\n      weightedScore = calculateWeightedCorrectScore(\n        categoryAnswers.map(a => ({\n          correct: a.correct,\n          answeredAt: a.answeredAt\n        }))\n      );\n    } else if (currentRecord.totalAnswered > 0) {\n      // Fallback: If query returned no answers but we have counts,\n      // calculate a simple score based on accuracy\n      const accuracy = currentRecord.totalCorrect / currentRecord.totalAnswered;\n      weightedScore = accuracy * 100;\n      console.warn(`‚ö†Ô∏è  Category mastery recalculation found no answers for ${categoryName}, using fallback score: ${weightedScore}`);\n    }\n    \n    // Determine mastery level\n    const masteryLevel = determineMasteryLevel(weightedScore);\n    \n    // Update the record\n    const [updated] = await db\n      .update(schema.categoryMastery)\n      .set({\n        weightedCorrectScore: weightedScore,\n        masteryLevel: masteryLevel,\n        updatedAt: new Date()\n      })\n      .where(eq(schema.categoryMastery.id, recordId))\n      .returning();\n    \n    return updated;\n  }\n\n  private formatTimeAgo(date: Date): string {\n    const now = new Date();\n    const diffMs = now.getTime() - date.getTime();\n    const diffMins = Math.floor(diffMs / (1000 * 60));\n    const diffHours = Math.floor(diffMins / 60);\n    const diffDays = Math.floor(diffHours / 24);\n\n    if (diffMins < 1) return \"Just now\";\n    if (diffMins < 60) return `${diffMins}m ago`;\n    if (diffHours < 24) return `${diffHours}h ago`;\n    if (diffDays < 7) return `${diffDays}d ago`;\n    return date.toLocaleDateString();\n  }\n}\n","size_bytes":39266},"design_guidelines.md":{"content":"# Design Guidelines: The Daily Double Down\n\n## Design Approach\n\n**Selected Approach:** Reference-Based Hybrid (Duolingo's gamification + Linear's data clarity + Kahoot's trivia energy)\n\n**Key Principles:**\n- Playful professionalism: Gaming aesthetics without sacrificing data credibility\n- Clear information hierarchy for both gameplay and analytics\n- Consistent ocean theme integration through shapes and patterns\n- Component-based modular design for scalability\n\n---\n\n## Typography System\n\n**Primary Font:** Inter (Google Fonts) - Clean, readable for data and UI\n**Accent Font:** Poppins (Google Fonts) - Bold, energetic for game elements\n\n**Hierarchy:**\n- Page Titles: Poppins Bold, 2.5rem (40px)\n- Section Headers: Poppins SemiBold, 1.75rem (28px)\n- Game Board Categories: Poppins Bold, 1.125rem (18px), uppercase, letter-spacing: 0.05em\n- Dollar Values: Poppins Bold, 2rem (32px)\n- Body Text: Inter Regular, 1rem (16px)\n- Data Labels: Inter Medium, 0.875rem (14px)\n- Small Stats: Inter SemiBold, 0.75rem (12px)\n\n---\n\n## Layout System\n\n**Spacing Units:** Tailwind units of 2, 4, 6, 8, 12, 16, 24 (e.g., p-4, gap-8, mb-12)\n\n**Grid Structure:**\n- Dashboard: 12-column grid with sidebar (3 cols) + main content (9 cols)\n- Game Board: 6-column responsive grid for categories\n- Analytics: Mixed 2-3 column layouts for stat cards\n\n**Container Widths:**\n- Full app: max-w-screen-2xl, centered\n- Content sections: max-w-6xl\n- Stat cards: Flexible within grid\n\n---\n\n## Component Library\n\n### Navigation\n**Top Bar:** Fixed header with app logo/title (left), user streak counter (center), profile avatar with points badge (right). Height: h-16, padding: px-8\n\n**Sidebar Navigation:** Categories list, recent achievements, quick stats. Width: w-64 on desktop, collapsible to icon-only on tablet. Spacing: py-6, px-4\n\n### Game Board\n**Category Headers:** Full-width cells with wave-pattern border-bottom (use CSS wave SVG as background-image). Height: h-20, centered text\n\n**Dollar Value Tiles:** Square aspect ratio cards (aspect-square), large centered dollar amounts. Grid gap: gap-2. Hover lift effect (transform: translateY(-4px))\n\n**Tile States:**\n- Unplayed: Full opacity with dollar value visible\n- Completed: Semi-transparent with checkmark icon overlay\n- Locked: Grayed with lock icon\n\n### Performance Tracking\n\n**Mastery Level Indicators:** Circular progress rings (use conic-gradient for CSS-based approach) showing percentage completion. Size: w-24 h-24, with category icon in center\n\n**Category Cards:** Each displays category name, mastery ring, question count, accuracy percentage, last played date. Layout: 3-column grid on desktop, 1-column on mobile. Padding: p-6, gap: gap-6\n\n**Stats Grid:** 2x2 grid showing: Total Questions Answered, Overall Accuracy, Current Streak, Best Category. Each stat in rounded card with large number (text-4xl) above small label. Padding: p-8\n\n### Analytics Dashboard\n\n**Performance Graph:** Line chart showing accuracy over time. Use Chart.js or similar via CDN. Container height: h-80. Include toggle buttons for time ranges (7d, 30d, 90d, All)\n\n**Recent Activity Feed:** Scrollable list (max-h-96, overflow-y-auto) showing recent questions with result icons (‚úì/‚úó), category badges, and timestamp. Item padding: py-3, border-b between items\n\n### Achievement System\n\n**Badge Grid:** Masonry-style grid (3-4 columns) displaying earned and locked achievements. Badge size: w-20 h-20 icon with title below\n\n**Badge Cards:** Includes icon, title, description, progress bar (if partially complete), unlock date. Locked badges shown at 40% opacity. Padding: p-6\n\n**Achievement Notification Toast:** Slides in from top-right, displays new badge with celebration confetti background effect. Width: w-96, padding: p-4\n\n### Forms & Inputs\n\n**Answer Input:** Large text input for Jeopardy-style \"What is...\" responses. Height: h-14, rounded-lg, px-4\n\n**Multiple Choice:** Radio buttons styled as full-width option cards. Each option: h-16, rounded-lg, px-6, with hover border highlight\n\n**Submit Button:** Primary CTA button, full-width or auto-width context-dependent. Height: h-12, rounded-lg, font-semibold, includes loading spinner state\n\n### Data Visualization\n\n**Progress Bars:** Horizontal bars showing completion percentage. Height: h-3, rounded-full, with animated fill\n\n**Comparison Bars:** Side-by-side bars for category comparisons. Include percentage labels at end of bars\n\n**Stat Rings:** Donut charts for at-a-glance metrics. Size: w-32 h-32, stroke-width: 8\n\n---\n\n## Page Layouts\n\n### Landing/Home Page\n**Hero Section:** Full-width (h-[600px]) with ocean wave illustration background image (abstract wave patterns, no literal ocean photos). Centered content: App title (Poppins Bold, 3.5rem), tagline (Inter Regular, 1.25rem), dual CTAs (Start Training, View Stats). Buttons on backdrop-blur-md background for readability.\n\n**Feature Showcase:** 3-column grid highlighting: Interactive Game Board, Smart Tracking, Achievement System. Each column: icon (w-16 h-16), heading, 2-3 line description. Spacing: py-24, gap-12\n\n**Stats Highlight:** 4-column counter display (if user has stats): Questions Mastered, Accuracy Rate, Days Streak, Badges Earned. Animated count-up on scroll into view\n\n### Game Board Page\n**Header:** Category selection breadcrumb, current session stats (questions attempted/remaining), timer (if timed mode). Height: h-20\n\n**Main Board:** 6x5 grid (6 categories √ó 5 dollar values). Full viewport utilization with proper spacing (gap-4, p-8)\n\n**Question Modal:** Overlay modal (fixed inset-0, bg-overlay) displaying question text (large, centered), answer input, timer, and submit button. Modal width: max-w-2xl, padding: p-12\n\n### Dashboard Page\n**Quick Stats Row:** 4 stat cards showing key metrics. Height: auto, equal-width columns\n\n**Category Performance Section:** Grid of category mastery cards (described above). Section padding: py-12\n\n**Analytics Charts:** Performance graph, accuracy breakdown pie chart, time-based activity heatmap. Stack vertically with spacing: space-y-8\n\n**Recent Activity Sidebar:** Right column (w-80) showing last 10 questions attempted with quick-glance results\n\n### Achievements Page\n**Header:** Total badges earned counter, completion percentage ring\n\n**Badge Categories:** Tabs for filtering (All, Earned, Locked, Recent). Tab bar: h-12, border-b\n\n**Badge Display:** Responsive grid (grid-cols-2 md:grid-cols-3 lg:grid-cols-4) with consistent gap-6\n\n---\n\n## Icons\n**Library:** Heroicons (via CDN) for all UI icons\n**Game-Specific Icons:** Use Heroicons for: trophy (achievements), chart-bar (analytics), academic-cap (mastery), check-circle (correct), x-circle (incorrect), lock-closed (locked content)\n\n---\n\n## Images\n\n**Hero Background Image:** Abstract geometric ocean wave pattern illustration (not photographic). Positioning: background-size: cover, background-position: center. Style: Modern, minimalist waves with gradient overlay from darker at top to lighter at bottom to ensure text readability.\n\n**Achievement Badge Graphics:** Icon-based graphics using Heroicons as base, no custom illustrations needed. Style badges with background circles and solid icon fills.\n\nNo additional photographic images required - maintain clean, icon-driven interface aesthetic.\n\n---\n\n## Animations\n**Minimal Animation Strategy:**\n- Tile reveal on game board: 50ms stagger per tile on page load\n- Number count-ups for stats: 1s duration\n- Achievement unlock: Scale-in animation (scale 0.8 to 1.0, 300ms)\n- Page transitions: Simple fade (200ms)","size_bytes":7544},"server/utils/mastery-calculations.ts":{"content":"/**\n * Mastery and readiness calculation utilities\n */\n\n/**\n * Calculate time decay weight for an answer given when it was answered.\n * Uses normalized exponential decay that reaches exactly 0% at 6 months (180 days):\n * Formula: (e^(-k*days) - e^(-k*180)) / (1 - e^(-k*180))\n * - Day 0: 100% weight\n * - Day 60 (2 months): ~33.5% weight  \n * - Day 120 (4 months): ~8.9% weight\n * - Day 180 (6 months): 0% weight\n * - Day 180+: 0% weight (answers older than 6 months contribute nothing)\n * \n * The exponential curve encourages recent practice while ensuring answers\n * older than 6 months have zero contribution.\n * \n * @param answeredAt - When the answer was given\n * @param now - Current time (defaults to now, can be overridden for testing)\n * @returns Weight from 0.0 to 1.0\n */\nexport function calculateTimeDecayWeight(answeredAt: Date, now: Date = new Date()): number {\n  const daysSince = (now.getTime() - answeredAt.getTime()) / (1000 * 60 * 60 * 24);\n  const maxDays = 180; // 6 months\n  const k = 3 / 180; // Decay rate chosen so e^(-k*180) ‚âà 0.05 (negligible)\n  \n  // Normalized exponential: shifts and scales to reach exactly 0 at maxDays\n  const rawWeight = Math.exp(-k * daysSince);\n  const minWeight = Math.exp(-k * maxDays);\n  const normalizedWeight = (rawWeight - minWeight) / (1 - minWeight);\n  \n  // Clamp to [0, 1] to handle edge cases (future dates, very old answers)\n  return Math.max(0, Math.min(1, normalizedWeight));\n}\n\n/**\n * Calculate weighted correct score for a category based on all answers.\n * Each correct answer contributes its time-decayed weight.\n * Score is normalized to 0-100 scale based on a target of 50 correct answers.\n * \n * @param answers - Array of answer records with { correct: boolean, answeredAt: Date }\n * @param targetAnswers - Number of correct answers needed for mastery (default: 50)\n * @returns Score from 0 to 100\n */\nexport function calculateWeightedCorrectScore(\n  answers: Array<{ correct: boolean; answeredAt: Date }>,\n  targetAnswers: number = 50\n): number {\n  const now = new Date();\n  let weightedCorrectSum = 0;\n  \n  for (const answer of answers) {\n    if (answer.correct) {\n      const weight = calculateTimeDecayWeight(answer.answeredAt, now);\n      weightedCorrectSum += weight;\n    }\n  }\n  \n  // Normalize to 0-100 scale\n  const score = (weightedCorrectSum / targetAnswers) * 100;\n  return Math.min(100, Math.max(0, score));\n}\n\n/**\n * Determine mastery level based on weighted correct score.\n * - Novice: 0-20 points\n * - Intermediate: 20-40 points\n * - Advanced: 40-60 points\n * - Expert: 60-80 points\n * - Master: 80-100 points\n * \n * @param weightedCorrectScore - Score from 0 to 100\n * @returns Mastery level\n */\nexport function determineMasteryLevel(\n  weightedCorrectScore: number\n): \"novice\" | \"intermediate\" | \"advanced\" | \"expert\" | \"master\" {\n  if (weightedCorrectScore >= 80) return \"master\";\n  if (weightedCorrectScore >= 60) return \"expert\";\n  if (weightedCorrectScore >= 40) return \"advanced\";\n  if (weightedCorrectScore >= 20) return \"intermediate\";\n  return \"novice\";\n}\n\n/**\n * Calculate category mastery contribution to overall readiness.\n * Based on user requirements: requires ~50 correct answers per category with 80%+ accuracy.\n * \n * @param categoryMasteryRecords - Array of user's category mastery records\n * @returns Score from 0 to 100\n */\nexport function calculateCategoryMasteryScore(\n  categoryMasteryRecords: Array<{ weightedCorrectScore: number }>\n): number {\n  if (categoryMasteryRecords.length === 0) return 0;\n  \n  // Average the weighted scores across all categories\n  const avgScore = categoryMasteryRecords.reduce(\n    (sum, record) => sum + record.weightedCorrectScore,\n    0\n  ) / categoryMasteryRecords.length;\n  \n  return avgScore;\n}\n\n/**\n * Calculate category breadth score (how many categories the user has practiced).\n * Rewards practicing diverse categories.\n * \n * @param totalCategories - Total available categories (24)\n * @param practiceCategories - Number of categories user has practiced\n * @returns Score from 0 to 100\n */\nexport function calculateBreadthScore(\n  totalCategories: number,\n  practicedCategories: number\n): number {\n  return (practicedCategories / totalCategories) * 100;\n}\n\n/**\n * Calculate overall readiness score.\n * Formula: 60% category mastery + 20% breadth + 20% Anytime Test performance\n * \n * @param categoryMasteryScore - Category mastery score (0-100)\n * @param breadthScore - Category breadth score (0-100)\n * @param anytimeTestScore - Anytime Test performance score (0-100)\n * @returns Overall readiness score from 0 to 100\n */\nexport function calculateOverallReadiness(\n  categoryMasteryScore: number,\n  breadthScore: number,\n  anytimeTestScore: number\n): number {\n  const score = (\n    categoryMasteryScore * 0.60 +\n    breadthScore * 0.20 +\n    anytimeTestScore * 0.20\n  );\n  return Math.min(100, Math.max(0, score));\n}\n","size_bytes":4872},"client/src/pages/progress.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Trophy, Target, TrendingUp, Calendar } from \"lucide-react\";\nimport { format } from \"date-fns\";\n\ninterface CategoryMastery {\n  id: string;\n  userId: string;\n  categoryName: string;\n  totalCorrect: number;\n  totalAnswered: number;\n  weightedCorrectScore: number;\n  masteryLevel: 'novice' | 'intermediate' | 'proficient' | 'expert' | 'master';\n  lastAnswered: string | null;\n  updatedAt: string;\n}\n\nconst masteryLevelConfig = {\n  novice: { color: \"bg-gray-400 dark:bg-gray-600\", label: \"Novice\", emoji: \"üå±\" },\n  intermediate: { color: \"bg-blue-400 dark:bg-blue-600\", label: \"Intermediate\", emoji: \"üìö\" },\n  proficient: { color: \"bg-purple-400 dark:bg-purple-600\", label: \"Proficient\", emoji: \"üéØ\" },\n  expert: { color: \"bg-orange-400 dark:bg-orange-600\", label: \"Expert\", emoji: \"‚≠ê\" },\n  master: { color: \"bg-amber-400 dark:bg-amber-600\", label: \"Master\", emoji: \"üèÜ\" },\n};\n\nexport default function ProgressPage() {\n  const { data: masteryRecords, isLoading, isError, error, refetch } = useQuery<CategoryMastery[]>({\n    queryKey: ['/api/category-mastery'],\n  });\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-b from-[#04364A] to-[#176B87] p-8\">\n        <div className=\"max-w-6xl mx-auto\">\n          <div className=\"text-white text-center py-12\" data-testid=\"loading-progress\">\n            Loading your progress...\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (isError) {\n    return (\n      <div className=\"min-h-screen bg-gradient-to-b from-[#04364A] to-[#176B87] p-8\">\n        <div className=\"max-w-6xl mx-auto\">\n          <Card className=\"bg-white/95 dark:bg-[#04364A]/95 border-red-500\" data-testid=\"error-progress\">\n            <CardHeader>\n              <CardTitle className=\"text-red-600 dark:text-red-400 text-2xl\">\n                Failed to Load Progress\n              </CardTitle>\n              <CardDescription>\n                We couldn't retrieve your category mastery data\n              </CardDescription>\n            </CardHeader>\n            <CardContent className=\"space-y-4\">\n              <p className=\"text-muted-foreground\">\n                {error instanceof Error ? error.message : \"An unexpected error occurred\"}\n              </p>\n              <button\n                onClick={() => refetch()}\n                className=\"px-4 py-2 bg-[#176B87] hover:bg-[#04364A] text-white rounded-lg transition-colors\"\n                data-testid=\"button-retry-progress\"\n              >\n                Try Again\n              </button>\n            </CardContent>\n          </Card>\n        </div>\n      </div>\n    );\n  }\n\n  const sortedRecords = [...(masteryRecords || [])].sort((a, b) => \n    b.weightedCorrectScore - a.weightedCorrectScore\n  );\n\n  const totalCategories = 24; // All Open Trivia DB categories\n  const practicedCategories = sortedRecords.length;\n  const averageMastery = sortedRecords.length > 0\n    ? sortedRecords.reduce((sum, r) => sum + r.weightedCorrectScore, 0) / sortedRecords.length\n    : 0;\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-b from-[#04364A] to-[#176B87] dark:from-[#02242E] dark:to-[#0D4456] p-4 sm:p-8\">\n      <div className=\"max-w-6xl mx-auto space-y-8\">\n        {/* Header */}\n        <div className=\"text-center space-y-4\">\n          <h1 className=\"text-4xl sm:text-5xl font-bold text-white dark:text-[#DAFFFB]\">\n            Category Mastery\n          </h1>\n          <p className=\"text-lg text-[#64CCC5] dark:text-[#64CCC5]\">\n            Track your progress across all trivia categories\n          </p>\n        </div>\n\n        {/* Stats Overview */}\n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n          <Card data-testid=\"card-categories-practiced\" className=\"bg-white/95 dark:bg-[#04364A]/95 border-[#176B87]\">\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\n                <Target className=\"w-4 h-4\" />\n                Categories Practiced\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-3xl font-bold text-[#04364A] dark:text-[#DAFFFB]\">\n                {practicedCategories} / {totalCategories}\n              </div>\n              <Progress \n                value={(practicedCategories / totalCategories) * 100} \n                className=\"mt-2 h-2\"\n                data-testid=\"progress-categories-breadth\"\n              />\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-average-mastery\" className=\"bg-white/95 dark:bg-[#04364A]/95 border-[#176B87]\">\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\n                <TrendingUp className=\"w-4 h-4\" />\n                Average Mastery\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-3xl font-bold text-[#04364A] dark:text-[#DAFFFB]\">\n                {averageMastery.toFixed(1)}%\n              </div>\n              <Progress \n                value={averageMastery} \n                className=\"mt-2 h-2\"\n                data-testid=\"progress-average-mastery\"\n              />\n            </CardContent>\n          </Card>\n\n          <Card data-testid=\"card-total-answers\" className=\"bg-white/95 dark:bg-[#04364A]/95 border-[#176B87]\">\n            <CardHeader className=\"pb-3\">\n              <CardTitle className=\"text-sm font-medium text-muted-foreground flex items-center gap-2\">\n                <Trophy className=\"w-4 h-4\" />\n                Total Answers\n              </CardTitle>\n            </CardHeader>\n            <CardContent>\n              <div className=\"text-3xl font-bold text-[#04364A] dark:text-[#DAFFFB]\">\n                {sortedRecords.reduce((sum, r) => sum + r.totalAnswered, 0)}\n              </div>\n              <div className=\"text-sm text-muted-foreground mt-1\">\n                {sortedRecords.reduce((sum, r) => sum + r.totalCorrect, 0)} correct\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        {/* Category Breakdown */}\n        <Card className=\"bg-white/95 dark:bg-[#04364A]/95 border-[#176B87]\">\n          <CardHeader>\n            <CardTitle className=\"text-2xl text-[#04364A] dark:text-[#DAFFFB]\">\n              Your Categories\n            </CardTitle>\n            <CardDescription className=\"dark:text-[#64CCC5]\">\n              Detailed breakdown of your performance in each category\n            </CardDescription>\n          </CardHeader>\n          <CardContent>\n            {sortedRecords.length === 0 ? (\n              <div className=\"text-center py-12 text-muted-foreground\">\n                <p className=\"text-lg mb-2\">No practice data yet!</p>\n                <p className=\"text-sm\">Start answering questions to track your category mastery.</p>\n              </div>\n            ) : (\n              <div className=\"space-y-4\">\n                {sortedRecords.map((record) => {\n                  const config = masteryLevelConfig[record.masteryLevel];\n                  const accuracy = record.totalAnswered > 0 \n                    ? (record.totalCorrect / record.totalAnswered) * 100 \n                    : 0;\n\n                  return (\n                    <div \n                      key={record.id}\n                      data-testid={`category-${record.categoryName.toLowerCase().replace(/\\s+/g, '-')}`}\n                      className=\"p-4 rounded-lg bg-gradient-to-r from-[#64CCC5]/10 to-[#DAFFFB]/10 dark:from-[#176B87]/20 dark:to-[#04364A]/20 hover:shadow-lg transition-shadow\"\n                    >\n                      <div className=\"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4\">\n                        {/* Category Info */}\n                        <div className=\"flex-1 min-w-0\">\n                          <div className=\"flex items-center gap-3 mb-2\">\n                            <span className=\"text-2xl\" aria-label={config.label}>\n                              {config.emoji}\n                            </span>\n                            <div>\n                              <h3 className=\"text-lg font-semibold text-[#04364A] dark:text-[#DAFFFB] truncate\">\n                                {record.categoryName}\n                              </h3>\n                              <div className=\"flex items-center gap-2 mt-1\">\n                                <Badge \n                                  className={`${config.color} text-white text-xs`}\n                                  data-testid={`badge-mastery-${record.masteryLevel}`}\n                                >\n                                  {config.label}\n                                </Badge>\n                                {record.lastAnswered && (\n                                  <span className=\"text-xs text-muted-foreground flex items-center gap-1\">\n                                    <Calendar className=\"w-3 h-3\" />\n                                    {format(new Date(record.lastAnswered), 'MMM d, yyyy')}\n                                  </span>\n                                )}\n                              </div>\n                            </div>\n                          </div>\n\n                          {/* Progress Bar */}\n                          <div className=\"space-y-1\">\n                            <div className=\"flex justify-between text-sm text-muted-foreground\">\n                              <span>Time-Weighted Mastery</span>\n                              <span className=\"font-semibold text-[#176B87] dark:text-[#64CCC5]\">\n                                {record.weightedCorrectScore.toFixed(1)}%\n                              </span>\n                            </div>\n                            <Progress \n                              value={record.weightedCorrectScore} \n                              className=\"h-2\"\n                              data-testid=\"progress-weighted-mastery\"\n                            />\n                          </div>\n                        </div>\n\n                        {/* Stats */}\n                        <div className=\"flex gap-6 text-center sm:text-left\">\n                          <div>\n                            <div className=\"text-2xl font-bold text-[#04364A] dark:text-[#DAFFFB]\">\n                              {record.totalAnswered}\n                            </div>\n                            <div className=\"text-xs text-muted-foreground\">\n                              Answered\n                            </div>\n                          </div>\n                          <div>\n                            <div className=\"text-2xl font-bold text-[#176B87] dark:text-[#64CCC5]\">\n                              {accuracy.toFixed(0)}%\n                            </div>\n                            <div className=\"text-xs text-muted-foreground\">\n                              Accuracy\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    </div>\n                  );\n                })}\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        {/* Unpracticed Categories */}\n        {practicedCategories < totalCategories && (\n          <Card className=\"bg-white/95 dark:bg-[#04364A]/95 border-[#176B87]\">\n            <CardHeader>\n              <CardTitle className=\"text-xl text-[#04364A] dark:text-[#DAFFFB]\">\n                Expand Your Knowledge\n              </CardTitle>\n              <CardDescription className=\"dark:text-[#64CCC5]\">\n                {totalCategories - practicedCategories} categories waiting to be explored\n              </CardDescription>\n            </CardHeader>\n            <CardContent>\n              <p className=\"text-muted-foreground\">\n                Continue playing to discover new categories and increase your breadth score!\n              </p>\n            </CardContent>\n          </Card>\n        )}\n      </div>\n    </div>\n  );\n}\n","size_bytes":12288},"client/src/hooks/useAnsweredQuestions.ts":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { useState, useEffect } from \"react\";\nimport { useAuth } from \"@/hooks/useAuth\";\n\ntype AnsweredQuestion = {\n  questionId: string;\n  assessment: \"correct\" | \"incorrect\" | \"unsure\";\n};\n\nconst STORAGE_KEY = \"anonymous_answered_questions\";\n\nexport function useAnsweredQuestions() {\n  const { user } = useAuth();\n  const isAnonymous = !user;\n\n  // For anonymous users, track answered questions in sessionStorage\n  const [localAnswered, setLocalAnswered] = useState<AnsweredQuestion[]>(() => {\n    if (typeof window === \"undefined\" || !isAnonymous) return [];\n    const stored = sessionStorage.getItem(STORAGE_KEY);\n    return stored ? JSON.parse(stored) : [];\n  });\n\n  // For authenticated users, fetch from server\n  const { data: serverAnswered = [] } = useQuery<AnsweredQuestion[]>({\n    queryKey: [\"/api/answered-questions\"],\n    enabled: !isAnonymous,\n  });\n\n  // Sync local storage when localAnswered changes\n  useEffect(() => {\n    if (isAnonymous && typeof window !== \"undefined\") {\n      sessionStorage.setItem(STORAGE_KEY, JSON.stringify(localAnswered));\n    }\n  }, [localAnswered, isAnonymous]);\n\n  const answeredQuestions = isAnonymous ? localAnswered : serverAnswered;\n\n  const addAnsweredQuestion = (questionId: string, assessment: \"correct\" | \"incorrect\" | \"unsure\") => {\n    if (isAnonymous) {\n      setLocalAnswered(prev => {\n        const exists = prev.find(q => q.questionId === questionId);\n        if (exists) {\n          return prev.map(q => \n            q.questionId === questionId ? { questionId, assessment } : q\n          );\n        }\n        return [...prev, { questionId, assessment }];\n      });\n    }\n  };\n\n  const clearAnsweredQuestions = () => {\n    if (isAnonymous) {\n      setLocalAnswered([]);\n      if (typeof window !== \"undefined\") {\n        sessionStorage.removeItem(STORAGE_KEY);\n      }\n    }\n  };\n\n  return {\n    answeredQuestions,\n    addAnsweredQuestion,\n    clearAnsweredQuestions,\n    isAnonymous,\n  };\n}\n","size_bytes":2002}},"version":2}